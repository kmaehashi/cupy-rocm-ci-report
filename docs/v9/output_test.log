v9: aa82a99 Merge pull request #5817 from kmaehashi/bump-docker-v9.5.0
============================= test session starts ==============================
platform linux -- Python 3.8.7, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
rootdir: /global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy, configfile: setup.cfg
plugins: html-3.1.1, metadata-1.11.0
collected 72008 items / 85 deselected / 12 skipped / 71911 selected

tests/cupy_tests/test_cublas.py ........................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  3%]
........................................................................ [  3%]
........................................................................ [  3%]
.................................................x.x....x.x............. [  3%]
....................                                                     [  3%]
tests/cupy_tests/test_cudnn.py sssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss             [  5%]
tests/cupy_tests/test_cusolver.py ssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssss                                       [  6%]
tests/cupy_tests/test_cutensor.py ssssssssssssssssssssssssssssssssssssss [  6%]
sssssssssssssssssssssssssssssssssssss                                    [  6%]
tests/cupy_tests/test_init.py ..s........                                [  6%]
tests/cupy_tests/test_ndim.py ............                               [  6%]
tests/cupy_tests/test_numpy_interop.py ..x....                           [  6%]
tests/cupy_tests/test_type_routines.py ................................. [  7%]
.                                                                        [  7%]
tests/cupy_tests/binary_tests/test_elementwise.py ......                 [  7%]
tests/cupy_tests/binary_tests/test_packing.py ...                        [  7%]
tests/cupy_tests/core_tests/test_array_function.py .....                 [  7%]
tests/cupy_tests/core_tests/test_carray.py .....                         [  7%]
tests/cupy_tests/core_tests/test_core.py ......                          [  7%]
tests/cupy_tests/core_tests/test_cub_reduction.py ...................... [  7%]
...                                                                      [  7%]
tests/cupy_tests/core_tests/test_dlpack.py ....                          [  7%]
tests/cupy_tests/core_tests/test_elementwise.py ...............          [  7%]
tests/cupy_tests/core_tests/test_flags.py .............................  [  7%]
tests/cupy_tests/core_tests/test_function.py ..                          [  7%]
tests/cupy_tests/core_tests/test_internal.py ........................... [  7%]
...............................................................          [  7%]
tests/cupy_tests/core_tests/test_iter.py ............                    [  7%]
tests/cupy_tests/core_tests/test_ndarray.py ..........................ss [  7%]
ssss.................................................................... [  7%]
............................sss...............                           [  7%]
tests/cupy_tests/core_tests/test_ndarray_adv_indexing.py ............... [  7%]
........................................................................ [  7%]
........................................................................ [  7%]
........................................................................ [  7%]
.............................................                            [  7%]
tests/cupy_tests/core_tests/test_ndarray_complex_ops.py ................ [  7%]
.....                                                                    [  7%]
tests/cupy_tests/core_tests/test_ndarray_contiguity.py .                 [  7%]
tests/cupy_tests/core_tests/test_ndarray_conversion.py .......xx..       [  7%]
tests/cupy_tests/core_tests/test_ndarray_copy_and_view.py .............. [  7%]
.......................F..sssssss                                        [  8%]
tests/cupy_tests/core_tests/test_ndarray_cuda_array_interface.py sssssss [  8%]
sssssssssssssssssssssssssssssssssssssssssssssssss                        [  8%]
tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py .F........... [  8%]
........................................F............................... [  8%]
...................................................................      [  8%]
tests/cupy_tests/core_tests/test_ndarray_get.py ............             [  8%]
tests/cupy_tests/core_tests/test_ndarray_indexing.py xxxx..........x...x [  8%]
........x..........x.............................                        [  8%]
tests/cupy_tests/core_tests/test_ndarray_math.py ......................s [  8%]
sssssssssss                                                              [  8%]
tests/cupy_tests/core_tests/test_ndarray_owndata.py ...                  [  8%]
tests/cupy_tests/core_tests/test_ndarray_reduction.py .FFFF.F.FFFFF...FF [  8%]
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.FFFF............................... [  8%]
..............................................F.F.F.F.F.......F.F.F.F.F. [  8%]
................................                                         [  8%]
tests/cupy_tests/core_tests/test_ndarray_scatter.py FFFFFFFFFFFFFFFFFFFF [  8%]
FFFFFF...............FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF...............F. [  8%]
...............................................................          [  8%]
tests/cupy_tests/core_tests/test_ndarray_ufunc.py .........              [  8%]
tests/cupy_tests/core_tests/test_ndarray_unary_op.py ..................s [  8%]
...                                                                      [  8%]
tests/cupy_tests/core_tests/test_raw.py .ss.........sss..s.s.s........ss [  9%]
.........sss..s.s.s........ss.........sss..s.s.s......ssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s [  9%]
s.......sssss....s.s......sssssssssssssssssssssssssssss                  [  9%]
tests/cupy_tests/core_tests/test_reduction.py .......................    [  9%]
tests/cupy_tests/core_tests/test_scan.py ....                            [  9%]
tests/cupy_tests/core_tests/test_syncdetect.py ....                      [  9%]
tests/cupy_tests/core_tests/test_userkernel.py ....sss.............      [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_array.py ................. [  9%]
........................................................................ [  9%]
....................................................                     [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_indexing.py .............. [  9%]
.................s                                                       [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_kernel_cache.py ....       [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_misc.py .......s.......... [  9%]
........                                                                 [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_optimization.py .......... [  9%]
....                                                                     [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_reduction.py ............. [  9%]
........................................................................ [  9%]
.........................................................s.s.s.s.s.s.s.s [  9%]
.s.ssssssssssssssssss.sss                                                [  9%]
tests/cupy_tests/core_tests/fusion_tests/test_routines.py .............. [  9%]
........................................................................ [ 10%]
..............                                                           [ 10%]
tests/cupy_tests/core_tests/fusion_tests/test_ufunc.py ................. [ 10%]
......................................................                   [ 10%]
tests/cupy_tests/creation_tests/test_basic.py .......................... [ 10%]
...........................................................s............ [ 10%]
....s.                                                                   [ 10%]
tests/cupy_tests/creation_tests/test_from_data.py ssssssssssssssssssssss [ 10%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssss............. [ 10%]
...................................................................      [ 10%]
tests/cupy_tests/creation_tests/test_matrix.py ......................... [ 10%]
.................................                                        [ 10%]
tests/cupy_tests/creation_tests/test_ranges.py ......................... [ 10%]
..............................................................           [ 10%]
tests/cupy_tests/cuda_tests/test_compiler.py sssssss........             [ 10%]
tests/cupy_tests/cuda_tests/test_cublas.py .                             [ 10%]
tests/cupy_tests/cuda_tests/test_cudnn.py s                              [ 10%]
tests/cupy_tests/cuda_tests/test_cufft.py ssssssssssssssss.              [ 10%]
tests/cupy_tests/cuda_tests/test_curand.py .....                         [ 10%]
tests/cupy_tests/cuda_tests/test_cusolver.py .                           [ 10%]
tests/cupy_tests/cuda_tests/test_cusparse.py .                           [ 10%]
tests/cupy_tests/cuda_tests/test_cutensor.py s                           [ 10%]
tests/cupy_tests/cuda_tests/test_device.py .............x..              [ 10%]
tests/cupy_tests/cuda_tests/test_driver.py ss.                           [ 10%]
tests/cupy_tests/cuda_tests/test_memory.py ....ssssssss................. [ 10%]
.ssssssssss.........................................s..........sssssssss [ 10%]
                                                                         [ 10%]
tests/cupy_tests/cuda_tests/test_memory_hook.py .                        [ 10%]
tests/cupy_tests/cuda_tests/test_nccl.py ........                        [ 10%]
tests/cupy_tests/cuda_tests/test_nvrtc.py .                              [ 10%]
tests/cupy_tests/cuda_tests/test_nvtx.py ....                            [ 10%]
tests/cupy_tests/cuda_tests/test_pinned_memory.py ............           [ 10%]
tests/cupy_tests/cuda_tests/test_profile.py ..                           [ 11%]
tests/cupy_tests/cuda_tests/test_runtime.py .                            [ 11%]
tests/cupy_tests/cuda_tests/test_stream.py ..s..s..ssssssss.s            [ 11%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_debug_print.py .     [ 11%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_line_profile.py ..   [ 11%]
tests/cupy_tests/fft_tests/test_cache.py ..sss.....s..                   [ 11%]
tests/cupy_tests/fft_tests/test_callback.py ssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssssssssssss                     [ 11%]
tests/cupy_tests/fft_tests/test_fft.py ....ssss....ssss........ssss....s [ 11%]
sss........ssss....ssss........ssss....ssss........ssss....ssss........s [ 12%]
sss....ssss........ssss....ssss........ssss....ssss........ssss....ssss. [ 12%]
.......ssss....ssss....................................................s [ 12%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 12%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss. [ 12%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 12%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 12%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.. [ 12%]
s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s. [ 12%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 12%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 13%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 13%]
.s.s.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 13%]
.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.sss [ 13%]
ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 13%]
.sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s. [ 13%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 13%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s...ss..ss....ss..ss....ss..ss....ss [ 13%]
..ss....ss..ss....ss..ss....ss..ss....ss..ss...s.s.s.s.s.s.s.s.s.s.s.s.s [ 13%]
.s.s.s.s.s.s.s.s.s.s.s.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 13%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 14%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s......s.s..s.s..s.s..s.s..s.s..s.s. [ 14%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 14%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 14%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s.sssss.s.s..s.s.sssssssssssssssssssss [ 14%]
ssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s..s.s..s.s..s.s..s. [ 14%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 14%]
.s.s..s.s..s.s..s.s..s.s..s.s.......ss..ss....ss..ss....ss..ss....ss..ss [ 14%]
....ss..ss....ss..ss....ss..ss....ss..ss........................         [ 14%]
tests/cupy_tests/functional_tests/test_piecewise.py .............        [ 14%]
tests/cupy_tests/functional_tests/test_vectorize.py .................... [ 14%]
................................                                         [ 14%]
tests/cupy_tests/indexing_tests/test_generate.py ....................... [ 14%]
...............                                                          [ 14%]
tests/cupy_tests/indexing_tests/test_indexing.py ....................... [ 14%]
.........................                                                [ 15%]
tests/cupy_tests/indexing_tests/test_insert.py ......................... [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
.........................................................                [ 15%]
tests/cupy_tests/indexing_tests/test_iterate.py ........................ [ 15%]
...............................................                          [ 15%]
tests/cupy_tests/io_tests/test_base_n.py ............................    [ 15%]
tests/cupy_tests/io_tests/test_formatting.py ..                          [ 15%]
tests/cupy_tests/io_tests/test_npz.py .......                            [ 15%]
tests/cupy_tests/lib_tests/test_polynomial.py ..............ssss....x... [ 15%]
..........sssssssssssssss........ssssssssssssssssssssssssssssssssssssxxx [ 15%]
xxxxxxxxxxxxxxxxx...ssssssssssssssssssssssssssssssssssssssssssssssss.... [ 15%]
ssssssssssssssssssssssssssssssssssssssssssssssss......xxxxxxxxxxxx...... [ 15%]
..........................................xxxxxxxxxxxx.................. [ 15%]
..............................xxxxxxxx........xxxxxxxx.................. [ 16%]
..............................................xxxxx...x................. [ 16%]
..                                                                       [ 16%]
tests/cupy_tests/lib_tests/test_shape_base.py ......................     [ 16%]
tests/cupy_tests/lib_tests/test_strided_tricks.py ..                     [ 16%]
tests/cupy_tests/linalg_tests/test_decomposition.py .................... [ 16%]
.......................                                                  [ 16%]
tests/cupy_tests/linalg_tests/test_eigenvalue.py ssssssssssssssssss      [ 16%]
tests/cupy_tests/linalg_tests/test_einsum.py ........................... [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
..........                                                               [ 17%]
tests/cupy_tests/linalg_tests/test_norms.py ............................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
.................................................................        [ 17%]
tests/cupy_tests/linalg_tests/test_product.py .......................... [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
................................................                         [ 17%]
tests/cupy_tests/linalg_tests/test_solve.py ............................ [ 17%]
....................................                                     [ 18%]
tests/cupy_tests/logic_tests/test_comparison.py ........................ [ 18%]
.....                                                                    [ 18%]
tests/cupy_tests/logic_tests/test_content.py ...                         [ 18%]
tests/cupy_tests/logic_tests/test_ops.py ....                            [ 18%]
tests/cupy_tests/logic_tests/test_truth.py ............................. [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
...........................................                              [ 19%]
tests/cupy_tests/logic_tests/test_type_test.py ......................... [ 19%]
.......                                                                  [ 19%]
tests/cupy_tests/manipulation_tests/test_add_remove.py ................. [ 19%]
............................                                             [ 19%]
tests/cupy_tests/manipulation_tests/test_basic.py ...................... [ 19%]
.......................................................................  [ 19%]
tests/cupy_tests/manipulation_tests/test_dims.py .....x.x............... [ 19%]
................................................                         [ 19%]
tests/cupy_tests/manipulation_tests/test_join.py ....................... [ 19%]
...........................                                              [ 19%]
tests/cupy_tests/manipulation_tests/test_kind.py ...........             [ 19%]
tests/cupy_tests/manipulation_tests/test_rearrange.py .................. [ 19%]
.......................................................                  [ 19%]
tests/cupy_tests/manipulation_tests/test_shape.py ...................... [ 19%]
........................................                                 [ 19%]
tests/cupy_tests/manipulation_tests/test_split.py ..................     [ 19%]
tests/cupy_tests/manipulation_tests/test_tiling.py ..................... [ 19%]
...........                                                              [ 19%]
tests/cupy_tests/manipulation_tests/test_transpose.py .................. [ 19%]
..........                                                               [ 19%]
tests/cupy_tests/math_tests/test_arithmetic.py ......................... [ 19%]
........................................................................ [ 19%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 31%]
....................ss...xxsssssxxxxxxxxxxx........                      [ 31%]
tests/cupy_tests/math_tests/test_explog.py .........                     [ 31%]
tests/cupy_tests/math_tests/test_floating.py .......                     [ 31%]
tests/cupy_tests/math_tests/test_hyperbolic.py ......                    [ 31%]
tests/cupy_tests/math_tests/test_matmul.py ............................. [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
................................................                         [ 31%]
tests/cupy_tests/math_tests/test_misc.py ............................... [ 31%]
............................................F..F..F..................... [ 31%]
............................                                             [ 31%]
tests/cupy_tests/math_tests/test_rational.py ....                        [ 31%]
tests/cupy_tests/math_tests/test_rounding.py ........................... [ 31%]
..........................................                               [ 31%]
tests/cupy_tests/math_tests/test_special.py ...                          [ 31%]
tests/cupy_tests/math_tests/test_sumprod.py ............................ [ 31%]
........................................................................ [ 31%]
.......ssssssssssssssss................................................. [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
..............................................................           [ 32%]
tests/cupy_tests/math_tests/test_trigonometric.py ...............        [ 32%]
tests/cupy_tests/math_tests/test_window.py ............................. [ 32%]
.....                                                                    [ 32%]
tests/cupy_tests/misc_tests/test_memory_ranges.py ................       [ 32%]
tests/cupy_tests/misc_tests/test_who.py ......                           [ 32%]
tests/cupy_tests/padding_tests/test_pad.py ............................. [ 32%]
..............................................                           [ 33%]
tests/cupy_tests/polynomial_tests/test_polynomial.py ................... [ 33%]
                                                                         [ 33%]
tests/cupy_tests/polynomial_tests/test_polyutils.py .................... [ 33%]
................                                                         [ 33%]
tests/cupy_tests/prof_tests/test_range.py ........                       [ 33%]
tests/cupy_tests/random_tests/test_bit_generator.py ssssssssssss         [ 33%]
tests/cupy_tests/random_tests/test_distributions.py .................... [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
.............xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....................... [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
.....xxxxxxx..................................xxxxxxx................... [ 34%]
........................................................................ [ 34%]
.............................................                            [ 34%]
tests/cupy_tests/random_tests/test_generator.py ........................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 35%]
............................s.s......................................... [ 35%]
..................................x...............................       [ 35%]
tests/cupy_tests/random_tests/test_generator_api.py ssssssssssssssssssss [ 35%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 35%]
ss                                                                       [ 35%]
tests/cupy_tests/random_tests/test_init.py .                             [ 35%]
tests/cupy_tests/random_tests/test_permutations.py ...x...x............. [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
.............                                                            [ 35%]
tests/cupy_tests/random_tests/test_random.py .                           [ 35%]
tests/cupy_tests/random_tests/test_sample.py ...............x........x.. [ 35%]
............                                                             [ 35%]
tests/cupy_tests/sorting_tests/test_count.py ....                        [ 35%]
tests/cupy_tests/sorting_tests/test_search.py ssssssss........ssssssss.. [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
....................................................................     [ 36%]
tests/cupy_tests/sorting_tests/test_sort.py ............................ [ 36%]
........................................................................ [ 36%]
..........................................................x...........   [ 36%]
tests/cupy_tests/statistics_tests/test_correlation.py .................. [ 36%]
..............................F..F.xF...................                 [ 36%]
tests/cupy_tests/statistics_tests/test_histogram.py .................... [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................                 [ 36%]
tests/cupy_tests/statistics_tests/test_meanvar.py ...................... [ 36%]
........................................................................ [ 37%]
........................................................................ [ 37%]
......                                                                   [ 37%]
tests/cupy_tests/statistics_tests/test_order.py sssss................... [ 37%]
.........................                                                [ 37%]
tests/cupy_tests/testing_tests/test_array.py ........................... [ 37%]
...............................................                          [ 37%]
tests/cupy_tests/testing_tests/test_condition.py ................        [ 37%]
tests/cupy_tests/testing_tests/test_helper.py .......................... [ 37%]
........................................................................ [ 37%]
.....sssss..sssssss..ssxxxxxxxx................x..x.................     [ 37%]
tests/cupy_tests/testing_tests/test_parameterized.py ............s.s.s.s [ 37%]
....ssss......                                                           [ 37%]
tests/cupyx_tests/test_cupyx.py ..                                       [ 37%]
tests/cupyx_tests/test_lapack.py .s.s.s.s.....s.s.s.s.....s.s.s.s.....s. [ 37%]
s.s.s.............sssssssssssss                                          [ 37%]
tests/cupyx_tests/test_optimize.py sssssssss                             [ 37%]
tests/cupyx_tests/test_pinned_array.py ................................. [ 37%]
.......................................                                  [ 37%]
tests/cupyx_tests/test_rsqrt.py .                                        [ 37%]
tests/cupyx_tests/test_runtime.py s.                                     [ 37%]
tests/cupyx_tests/test_scatter.py ...                                    [ 37%]
tests/cupyx_tests/test_time.py .........                                 [ 37%]
tests/cupyx_tests/fallback_mode_tests/test_fallback.py ................. [ 37%]
........................................................................ [ 37%]
.........                                                                [ 37%]
tests/cupyx_tests/fallback_mode_tests/test_notifications.py .........    [ 37%]
tests/cupyx_tests/jit_tests/test_raw.py F..........                      [ 37%]
tests/cupyx_tests/linalg_tests/test_solve.py xxxxxxxxxxxxxxxx....ssss    [ 38%]
tests/cupyx_tests/scipy_tests/test_get_array_module.py ..                [ 38%]
tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py .................... [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 41%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 42%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 43%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 47%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 49%]
......................................................................ss [ 49%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 49%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 49%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss........ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
..............................................ssssssssssssssssssssssssss [ 50%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 50%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 50%]
ssssssssssssssssssssssssssssssssssssssss................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
......................................                                   [ 51%]
tests/cupyx_tests/scipy_tests/fft_tests/test_helper.py .                 [ 51%]
tests/cupyx_tests/scipy_tests/fftpack_tests/test_fftpack.py ............ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
.........................                                                [ 52%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_decomp_lu.py ........... [ 52%]
...................................................                      [ 52%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_solve_triangular.py .... [ 52%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
....................................................................     [ 53%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_special_matrices.py .... [ 53%]
........................................................................ [ 53%]
.................................................                        [ 53%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_filters.py ...sss...... [ 53%]
sss......sss......sss......sss......sss.........sss......sss......sss... [ 53%]
...sss......sss......sss................................................ [ 53%]
...........................................................sss......sss. [ 53%]
.....sss......sss......sss......sss.........sss......sss......sss......s [ 53%]
ss......sss......sss.................................................... [ 54%]
.......................................................sss......sss..... [ 54%]
.sss......sss......sss......sss.........sss......sss......sss......sss.. [ 54%]
....sss......sss........................................................ [ 54%]
...................................................sss......sss......sss [ 54%]
......sss......sss......sss.........sss......sss......sss......sss...... [ 54%]
sss......sss............................................................ [ 54%]
...............................................sss......sss......sss.... [ 54%]
..sss......sss......sss.........sss......sss......sss......sss......sss. [ 54%]
.....sss................................................................ [ 54%]
...........................................sss......sss......sss......ss [ 55%]
s......sss......sss.........sss......sss......sss......sss......sss..... [ 55%]
.sss.................................................................... [ 55%]
.......................................sss......sss......sss......sss... [ 55%]
...sss......sss.........sss......sss......sss......sss......sss......sss [ 55%]
........................................................................ [ 55%]
...................................sss......sss......sss......sss......s [ 55%]
ss......sss.........sss......sss......sss......sss......sss......sss.... [ 55%]
........................................................................ [ 55%]
...............................sss......sss......sss......sss......sss.. [ 55%]
....sss.........sss......sss......sss......sss......sss......sss........ [ 56%]
........................................................................ [ 56%]
...........................sss......sss......sss......sss......sss...... [ 56%]
sss.........sss......sss......sss......sss......sss......sss............ [ 56%]
........................................................................ [ 56%]
.......................sss......sss......sss......sss......sss......sss. [ 56%]
........sss......sss......sss......sss......sss......sss................ [ 56%]
........................................................................ [ 56%]
...................sss......sss......sss......sss......sss......sss..... [ 56%]
....sss......sss......sss......sss......sss......sss.................... [ 56%]
........................................................................ [ 57%]
...............sss......sss......sss......sss......sss......sss......... [ 57%]
sss......sss......sss......sss......sss......sss........................ [ 57%]
........................................................................ [ 57%]
...........sss......sss......sss......sss......sss......sss.........sss. [ 57%]
.....sss......sss......sss......sss......sss............................ [ 57%]
........................................................................ [ 57%]
xxx....sss......sss......sss......sss......sss......sss....x..x.sss.x..x [ 57%]
.sss.x..x.sss......sss......sss......sss................................ [ 57%]
.....................................................x..x.............x. [ 57%]
......................................x.....x....x.....x......x.....x... [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 60%]
........................................................................ [ 60%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 60%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 61%]
.............................................................s.s.s.s.s.s [ 61%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 61%]
........................................................................ [ 61%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 61%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 61%]
.............................................................s.s.s.s.s.s [ 61%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 61%]
........................................................................ [ 61%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 61%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 62%]
.............................................................s.s.s.s.s.s [ 62%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 62%]
........................................................................ [ 62%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 62%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 62%]
.............................................................s.s.s.s.s.s [ 62%]
.s.s.s.s.s.s.s.s.s.s.s.ssss..sss..sss............sss..sss..sss.......... [ 62%]
..sss..sss..sss............sss..sss..sss............sss..sss..sss....... [ 62%]
.....sss..sss..sss............sss..sss..sss............sss..sss..sss.... [ 62%]
........sss..sss..sss............sss..sss..sss............sss..sss..sss. [ 63%]
...........sss..sss..sss................................................ [ 63%]
........................................................................ [ 63%]
....................................                                     [ 63%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_fourier.py ............ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 64%]
........................................                                 [ 64%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py ...... [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
................FF...................................................... [ 65%]
........................................................................ [ 65%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 69%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 70%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 71%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 72%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
...............................x...x.x...x.x...x.x...x.............x...x [ 75%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 75%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 75%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 75%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 75%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 76%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 77%]
.x...x.x...x.x...x...................................................... [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 77%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
.....................s.................................................. [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 79%]
.........................x.....x.....x.....x.....x.....x.....x.....x.... [ 79%]
.x.....x.....x.....x.......x........x..x..x........s.................... [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
.......x.....x....................x.....x....................x.....x.... [ 80%]
................x.....x....................x.....x....................x. [ 80%]
....x....................x.....x....................x.....x............. [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................s............................... [ 80%]
........................................................................ [ 81%]
........................................................................ [ 81%]
........................................................................ [ 81%]
.............FF..........FF.FFFFFFFFFFFFFFFFFFFFF......FF....FF......... [ 81%]
.FF....FF..............FFFFF...FFss..................................... [ 81%]
........................................................................ [ 81%]
........................................................................ [ 81%]
........................................................................ [ 81%]
........................................................................ [ 81%]
........................................................................ [ 81%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
...........ssssssssssssssssssssssssssssssssssssssssssssssss              [ 82%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py ....... [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 82%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 83%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 84%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 86%]
.....................................................................FFF [ 86%]
FFFFFFFFFFFFFFFF.FFF.FFFFFF..FFF...FFF...FFF............................ [ 86%]
...............F.F.xx......FFFFxx......FFFFxx......F.F.xx......FFFFxx... [ 86%]
...FFFFFF......F.F.xxFFFFFFFFFFFFFFFFFFFFFFFF......F.F.xxFFFFFFFFFFFFFFF [ 86%]
FFFFFFFFF......F.F.xx......FFFFxx......FFFFxx......F.F.xx......FFFFxx... [ 86%]
...FFFFFF......F.F.xxFFFFFFFFFFFFFFFFFFFFFFFF......F.F.xxFFFFFFFFFFFFFFF [ 86%]
FFFFFFFFFFFFFFF..FFFF..FFFF..FFFF............FFFF....FFFF....FFFF....... [ 86%]
.....FFFF....FFFF....FFFF............FFFF....FFFF....FFFF............FFF [ 86%]
F....FFFF....FFFF                                                        [ 86%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py ......... [ 86%]
.FFF..................s....s....s..s....s....s.......................... [ 86%]
..........s....s....s..s....s....s....................................s. [ 87%]
...s....s..s....s....s....................................s....s....s..s [ 87%]
....s....s....................................s....s....s..s....s....s.. [ 87%]
..................................s....s....s..s....s....s.............. [ 87%]
....FFFFFFFFFFFFFFFFFFsFFFFsFFFFsFFsFFFFsFFFFsFFFFFFFFFFFFFFFFFFFFFFFFFF [ 87%]
FFFFFFFFFFsFFFFsFFFFsFFsFFFFsFFFFsFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFsF [ 87%]
FFFsFFFFsFFsFFFFsFFFFsFFFFFF..............................s....s....s..s [ 87%]
....s....s....................................s....s....s..s....s....s.. [ 87%]
..................................s....s....s..s....s....s.............. [ 87%]
......................s....s....s..s....s....s.......................... [ 87%]
..........s....s....s..s....s....s....................................s. [ 88%]
...s....s..s....s....s....................................s....s....s..s [ 88%]
....s....s....................................s....s....s..s....s....s.. [ 88%]
..................................s....s....s..s....s....s.............. [ 88%]
......................s....s....s..s....s....s.......................... [ 88%]
..........s....s....s..s....s....s....................................s. [ 88%]
...s....s..s....s....s....................................s....s....s..s [ 88%]
....s....s....................................s....s....s..s....s....s.. [ 88%]
..................................s....s....s..s....s....s.............. [ 88%]
........................................................................ [ 88%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
.......................................................................s [ 89%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 89%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 89%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 89%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 90%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 91%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 92%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 93%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 93%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............. [ 93%]
........................................................................ [ 93%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 93%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 93%]
..........................................s....s....s....s....s....s.... [ 93%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 93%]
s....s....s....s........................................................ [ 93%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 93%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 94%]
..........................................s....s....s....s....s....s.... [ 94%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 94%]
s....s....s....s........................................................ [ 94%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 94%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 94%]
..........................................s....s....s....s....s....s.... [ 94%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 94%]
s....s....s....s........................................................ [ 94%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 94%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 95%]
..........................................s....s....s....s....s....s.... [ 95%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 95%]
s....s....s....s........................................................ [ 95%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 95%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 95%]
..........................................s....s....s....s....s....s.... [ 95%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 95%]
s....s....s....s........................................................ [ 95%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 95%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 96%]
..........................................s....s....s....s....s....s.... [ 96%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 96%]
s....s....s....s........................................................ [ 96%]
........................................................................ [ 96%]
........................................................................ [ 96%]
........................................................................ [ 96%]
........................................................ssssssss........ [ 96%]
........................................................ssssssss........ [ 96%]
........................................................ssssssss........ [ 96%]
........................................................ssssssss........ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 97%]
........................................................................ [ 98%]
........................................................................ [ 98%]
........................................................................ [ 98%]
........................................................................ [ 98%]
........................................................................ [ 98%]
                                                                         [ 98%]
tests/cupyx_tests/scipy_tests/signal_tests/test_bsplines.py ............ [ 98%]
                                                                         [ 98%]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py ......... [ 98%]
........................................................................ [ 98%]
............................xxx............xxxx...............x......... [ 98%]
...Fxxx............xxxx............F..x.............xxx............xxxx. [ 98%]
..............x....................................x.x..x.x..x.x..x.x..x [ 98%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x................................... [ 98%]
........................................................................ [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
......................................................................   [ 99%]
tests/cupyx_tests/scipy_tests/sparse_tests/csgraph_tests/test_traversal.py s [ 99%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 99%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_bessel.py ............  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_convex_analysis.py .... [ 99%]
.                                                                        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_digamma.py .....        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_erf.py ............     [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gamma.py ....           [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gammaln.py ....         [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_polygamma.py ....       [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_statistics.py ..        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_zeta.py ....            [ 99%]
tests/cupyx_tests/scipy_tests/stats_tests/test_distributions.py ........ [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
                                                                         [ 99%]
tests/cupyx_tests/tools_tests/test_install_library.py ......             [ 99%]
tests/example_tests/test_finance.py ...                                  [ 99%]
tests/example_tests/test_gemm.py .                                       [ 99%]
tests/example_tests/test_gmm.py ss                                       [ 99%]
tests/example_tests/test_kmeans.py sss                                   [ 99%]
tests/install_tests/test_build.py sx.                                    [ 99%]
tests/install_tests/test_utils.py ..                                     [100%]

=================================== FAILURES ===================================
________________ TestArrayCopyAndView.test_astype_boolean_view _________________

args = (<cupy_tests.core_tests.test_ndarray_copy_and_view.TestArrayCopyAndView object at 0x7f0d39fab3a0>,)
kw = {}, cupy_result = (array([0, 1, 2], dtype=int8),), cupy_error = None
numpy_result = (array([0, 1, 1], dtype=int8),), numpy_error = None
cupy_numpy_result_ndarrays = [(array([0, 1, 2], dtype=int8), array([0, 1, 1], dtype=int8))]
cupy_r = array([0, 1, 2], dtype=int8), numpy_r = array([0, 1, 1], dtype=int8)
masks = [None]

            @_wraps_partial_xp(impl, name, sp_name, scipy_name)
            def test_func(*args, **kw):
                # Run cupy and numpy
                (
                    cupy_result, cupy_error,
                    numpy_result, numpy_error) = (
                        _call_func_numpy_cupy(
                            impl, args, kw, name, sp_name, scipy_name))
                assert cupy_result is not None or cupy_error is not None
                assert numpy_result is not None or numpy_error is not None
    
                # Check errors raised
                if cupy_error or numpy_error:
                    _check_cupy_numpy_error(cupy_error,
                                            numpy_error,
                                            accept_error=accept_error)
                    return
    
                # Check returned arrays
    
                if not isinstance(cupy_result, (tuple, list)):
                    cupy_result = cupy_result,
                if not isinstance(numpy_result, (tuple, list)):
                    numpy_result = numpy_result,
    
                assert len(cupy_result) == len(numpy_result)
    
                # Check types
                cupy_numpy_result_ndarrays = [
                    _convert_output_to_ndarray(
                        cupy_r, numpy_r, sp_name, check_sparse_format)
                    for cupy_r, numpy_r in zip(cupy_result, numpy_result)]
    
                # Check dtypes
                if type_check:
                    for cupy_r, numpy_r in cupy_numpy_result_ndarrays:
                        if cupy_r.dtype != numpy_r.dtype:
                            raise AssertionError(
                                '''ndarrays of different dtypes are returned.
    cupy: {}
    numpy: {}'''.format(cupy_r.dtype, numpy_r.dtype))
    
                # Check contiguities
                if contiguous_check:
                    for cupy_r, numpy_r in zip(cupy_result, numpy_result):
                        if isinstance(numpy_r, numpy.ndarray):
                            if (numpy_r.flags.c_contiguous
                                    and not cupy_r.flags.c_contiguous):
                                raise AssertionError(
                                    'The state of c_contiguous flag is false. '
                                    '(cupy_result:{} numpy_result:{})'.format(
                                        cupy_r.flags.c_contiguous,
                                        numpy_r.flags.c_contiguous))
                            if (numpy_r.flags.f_contiguous
                                    and not cupy_r.flags.f_contiguous):
                                raise AssertionError(
                                    'The state of f_contiguous flag is false. '
                                    '(cupy_result:{} numpy_result:{})'.format(
                                        cupy_r.flags.f_contiguous,
                                        numpy_r.flags.f_contiguous))
    
                # Check shapes
                for cupy_r, numpy_r in cupy_numpy_result_ndarrays:
                    assert cupy_r.shape == numpy_r.shape
    
                masks = [None] * len(cupy_result)
                if _contains_signed_and_unsigned(kw):
                    needs_mask = [
                        cupy_r.dtype in _unsigned_dtypes
                        for cupy_r in cupy_result]
                    if any(needs_mask):
                        masks = _make_positive_masks(
                            impl, args, kw, name, sp_name, scipy_name)
                        for i, flag in enumerate(needs_mask):
                            if not flag:
                                masks[i] = None
    
                # Check item values
                for (cupy_r, numpy_r), mask in zip(
                        cupy_numpy_result_ndarrays, masks):
                    # Behavior of assigning a negative value to an unsigned integer
                    # variable is undefined.
                    # nVidia GPUs and Intel CPUs behave differently.
                    # To avoid this difference, we need to ignore dimensions whose
                    # values are negative.
    
                    skip = False
                    if mask is not None:
                        if cupy_r.shape == ():
                            skip = (mask == 0).all()
                        else:
                            cupy_r = cupy_r[mask].get()
                            numpy_r = numpy_r[mask]
    
                    if not skip:
>                       check_func(cupy_r, numpy_r)

cupy/testing/_helper.py:355: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:660: in check_func
    _array.assert_array_equal(x, y, err_msg, verbose, strides_check)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([0, 1, 2], dtype=int8), y = array([0, 1, 1], dtype=int8), err_msg = ''
verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 1 / 3 (33.3%)
E       Max absolute difference: 1
E       Max relative difference: 1.
E        x: array([0, 1, 2], dtype=int8)
E        y: array([0, 1, 1], dtype=int8)

cupy/testing/_array.py:91: AssertionError
_______________ TestArrayElementwiseOp.test_add_array_boolarray ________________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_add_array_boolarray>

    def test_add_array_boolarray(self):
>       self.check_array_boolarray_op(operator.add)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:478: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
_______________ TestArrayElementwiseOp.test_iadd_array_boolarray _______________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_iadd_array_boolarray>

    def test_iadd_array_boolarray(self):
>       self.check_array_boolarray_op(operator.iadd)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:481: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
___________ TestArrayReduction_param_0_{order='C'}.test_argmax_axis0 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[ 1,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]], dtype=int64)
desired = array([[1, 1, 0, 0],
       [0, 1, 1, 0],
       [1, 1, 0, 1]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 10 / 12 (83.3%)
E       Max absolute difference: 10
E       Max relative difference: 10.
E        x: array([[ 1,  1,  2,  3],
E              [ 4,  5,  6,  7],
E              [ 8,  9, 10, 11]], dtype=int64)
E        y: array([[1, 1, 0, 0],
E              [0, 1, 1, 0],
E              [1, 1, 0, 1]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_argmax_axis1 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4651100371747315405, 4687876703532670032, 4691114327187448416,
        4644731905909873877],
       [4682998269218361805, 4659324637120737189,         60129542157,
                68719476751]], dtype=int64)
desired = array([[2, 0, 2, 1],
       [2, 0, 1, 1]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 4691114327187448414
E       Max relative difference: 4.64473191e+18
E        x: array([[4651100371747315405, 4687876703532670032, 4691114327187448416,
E               4644731905909873877],
E              [4682998269218361805, 4659324637120737189,         60129542157,
E                       68719476751]], dtype=int64)
E        y: array([[2, 0, 2, 1],
E              [2, 0, 1, 1]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_argmax_axis2 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[1, 2, 3],
       [4, 5, 6]], dtype=int64)
desired = array([[1, 3, 0],
       [1, 3, 0]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 6
E       Max relative difference: 3.
E        x: array([[1, 2, 3],
E              [4, 5, 6]], dtype=int64)
E        y: array([[1, 3, 0],
E              [1, 3, 0]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_0_{order='C'}.test_argmax_axis_large _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([         4294967296,          4294967298,          8589934592,
                         3,                   2,...  1891,
                      1892,                1893,                1894,
                      1895], dtype=int64)
desired = array([2, 0, 0, 1, 2, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0,
       1, 1, 2, 1, 1, 0, 1, 0, 2, 2, 1, 1, 2,...1, 0, 2,
       1, 0, 1, 2, 0, 0, 0, 1, 0, 2, 1, 2, 1, 0, 0, 1, 0, 2, 0, 0, 2, 1,
       1, 1, 2, 2, 0, 2, 1, 0, 2, 2])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 950 / 1000 (95%)
E       Max absolute difference: 4613937818241073151
E       Max relative difference: 4.61393782e+18
E        x: array([         4294967296,          4294967298,          8589934592,
E                                3,                   2,                   0,
E              4607182418800017408,                   0,                   0,...
E        y: array([2, 0, 0, 1, 2, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0,
E              1, 1, 2, 1, 1, 0, 1, 0, 2, 2, 1, 1, 2, 2, 2, 0, 2, 0, 2, 0, 0, 1,
E              0, 2, 2, 1, 2, 1, 2, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 2, 2, 2,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_0_{order='C'}.test_argmax_nan_imag __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(4575657221408423936, dtype=int64), desired = 0, rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4575657221408423936
E       Max relative difference: inf
E        x: array(4575657221408423936, dtype=int64)
E        y: array(0)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex128'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_argmin_all ____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(0, dtype=int64), desired = 4, rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4
E       Max relative difference: 1.
E        x: array(0, dtype=int64)
E        y: array(4)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_argmin_axis0 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[                  4, 4634274385308418048, 4634344754052595712,
        4634344754052595712],
       [463441512...40],
       [4634555860285128704, 4634555860285128704, 4634626229029306368,
        4634626229029306368]], dtype=int64)
desired = array([[0, 0, 1, 1],
       [1, 0, 0, 1],
       [0, 0, 1, 0]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 4634626229029306368
E       Max relative difference: 4.63462623e+18
E        x: array([[                  4, 4634274385308418048, 4634344754052595712,
E               4634344754052595712],
E              [4634415122796773376, 4634415122796773376, 4634485491540951040,...
E        y: array([[0, 0, 1, 1],
E              [1, 0, 0, 1],
E              [0, 0, 1, 0]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_argmin_axis1 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4617865109156845394, 4619738334837123328, 4618472530717059998,
        4617820857677151090],
       [4616455947418478938, 4618958139644707378, 4616612812431349795,
        4621209853747284954]], dtype=int64)
desired = array([[1, 2, 1, 2],
       [1, 2, 0, 0]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 4621209853747284954
E       Max relative difference: 4.61847253e+18
E        x: array([[4617865109156845394, 4619738334837123328, 4618472530717059998,
E               4617820857677151090],
E              [4616455947418478938, 4618958139644707378, 4616612812431349795,
E               4621209853747284954]], dtype=int64)
E        y: array([[1, 2, 1, 2],
E              [1, 2, 0, 0]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_argmin_axis2 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4575657221408423936, 4575657222482165760, 4611686018427387904],
       [                  1,                   0,                   2]],
      dtype=int64)
desired = array([[3, 0, 1],
       [2, 0, 2]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 4 / 6 (66.7%)
E       Max absolute difference: 4611686018427387903
E       Max relative difference: 4.61168602e+18
E        x: array([[4575657221408423936, 4575657222482165760, 4611686018427387904],
E              [                  1,                   0,                   2]],
E             dtype=int64)
E        y: array([[3, 0, 1],
E              [2, 0, 2]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_0_{order='C'}.test_argmin_axis_large _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([                  0,                   0,                   1,
                         0,                   1,...  2915,
                      2916,                2917,                2918,
                      2919], dtype=int64)
desired = array([0, 1, 1, 2, 1, 2, 0, 1, 2, 0, 2, 1, 2, 2, 1, 0, 0, 1, 2, 1, 2, 2,
       2, 2, 0, 2, 0, 2, 0, 1, 0, 1, 2, 2, 0,...2, 2, 1,
       0, 1, 2, 1, 2, 1, 1, 0, 1, 0, 0, 1, 2, 2, 1, 0, 2, 1, 1, 2, 0, 2,
       0, 0, 1, 0, 2, 0, 0, 2, 0, 1])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 943 / 1000 (94.3%)
E       Max absolute difference: 4613937818241073150
E       Max relative difference: 4.61281192e+18
E        x: array([                  0,                   0,                   1,
E                                0,                   1,                   2,
E              4607182418800017408,                   0,                   0,...
E        y: array([0, 1, 1, 2, 1, 2, 0, 1, 2, 0, 2, 1, 2, 2, 1, 0, 0, 1, 2, 1, 2, 2,
E              2, 2, 0, 2, 0, 2, 0, 1, 0, 1, 2, 2, 0, 1, 1, 1, 1, 2, 1, 2, 2, 0,
E              1, 1, 0, 0, 0, 2, 1, 1, 1, 0, 0, 2, 2, 0, 0, 2, 0, 0, 1, 1, 0, 1,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_max_all ______________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(0.), desired = 7.151893663724195, rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 7.15189366
E       Max relative difference: 1.
E        x: array(0.)
E        y: array(7.151894)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_0_{order='C'}.test_max_all_keepdims _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[nan]]), y = array([[7.15189366]]), func = <ufunc 'isnan'>
hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array([[nan]])
E            y: array([[7.151894]])

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_max_axis0 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[0.00000000e+000, 5.26354425e-315, 5.30498948e-315,
        5.26354425e-315],
       [0.00000000e+000, 5.304989...0e+000,
        0.00000000e+000],
       [2.00000000e+000, 0.00000000e+000, 1.00000000e+000,
        0.00000000e+000]])
desired = array([[5.68044561, 9.25596638, 6.02763376, 5.44883183],
       [4.23654799, 8.32619846, 7.78156751, 8.91773001],
       [9.78618342, 7.99158564, 7.91725038, 7.80529176]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 9.25596638
E       Max relative difference: 1.
E        x: array([[0.000000e+000, 5.263544e-315, 5.304989e-315, 5.263544e-315],
E              [0.000000e+000, 5.304989e-315, 3.000000e+000, 0.000000e+000],
E              [2.000000e+000, 0.000000e+000, 1.000000e+000, 0.000000e+000]])
E        y: array([[5.680446, 9.255966, 6.027634, 5.448832],
E              [4.236548, 8.326198, 7.781568, 8.91773 ],
E              [9.786183, 7.991586, 7.91725 , 7.805292]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_max_axis1 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[1.0864702e-311, 4.9406565e-324, 9.8813129e-324, 4.9406565e-324],
       [0.0000000e+000, 9.8813129e-324, 1.0000000e+000, 0.0000000e+000]])
desired = array([[9.63662761, 7.15189366, 7.91725038, 8.91773001],
       [9.78618342, 9.25596638, 7.78156751, 8.70012148]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 9.78618342
E       Max relative difference: 1.
E        x: array([[1.08647e-311, 4.94066e-324, 9.88131e-324, 4.94066e-324],
E              [0.00000e+000, 9.88131e-324, 1.00000e+000, 0.00000e+000]])
E        y: array([[9.636628, 7.151894, 7.91725 , 8.91773 ],
E              [9.786183, 9.255966, 7.781568, 8.700121]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_max_axis2 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[5.48813504, 7.15189366, 6.02763376],
       [5.44883183, 4.23654799, 6.45894113]])
desired = array([[7.15189366, 8.91773001, 9.63662761],
       [9.25596638, 8.70012148, 9.78618342]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 6 / 6 (100%)
E       Max absolute difference: 4.46357349
E       Max relative difference: 0.51304726
E        x: array([[5.488135, 7.151894, 6.027634],
E              [5.448832, 4.236548, 6.458941]])
E        y: array([[7.151894, 8.91773 , 9.636628],
E              [9.255966, 8.700121, 9.786183]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
__________ TestArrayReduction_param_0_{order='C'}.test_max_axis_large __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([2.9723e-320, 2.9728e-320, 2.9733e-320, 2.9738e-320, 2.9743e-320,
       2.9748e-320, 2.9753e-320, 2.9758e-320, ...9e-320, 3.4624e-320, 3.4629e-320, 3.4634e-320,
       3.4639e-320, 3.4644e-320, 3.4649e-320, 3.4654e-320, 3.4659e-320])
desired = array([8.11518471, 7.15189366, 6.02763376, 7.08770391, 6.05043017,
       8.79521483, 5.77284015, 8.91773001, 9.636627...36, 8.7519961 , 2.87292882, 8.79681543, 7.36853162,
       9.41687071, 7.21198113, 9.38412022, 8.13545017, 6.97400378])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1000 / 1000 (100%)
E       Max absolute difference: 9.99964019
E       Max relative difference: 1.
E        x: array([2.9723e-320, 2.9728e-320, 2.9733e-320, 2.9738e-320, 2.9743e-320,
E              2.9748e-320, 2.9753e-320, 2.9758e-320, 2.9763e-320, 2.9767e-320,
E              2.9772e-320, 2.9777e-320, 2.9782e-320, 2.9787e-320, 2.9792e-320,...
E        y: array([8.115185, 7.151894, 6.027634, 7.087704, 6.05043 , 8.795215,
E              5.77284 , 8.91773 , 9.636628, 9.536757, 7.91725 , 5.288949,
E              5.680446, 9.255966, 0.710361, 4.116155, 4.894586, 8.326198,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_0_{order='C'}.test_max_multiple_axes _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([5.48813504, 7.15189366])
desired = array([9.63662761, 9.78618342]), rtol = 1e-07, atol = 0, err_msg = ''
verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 4.14849257
E       Max relative difference: 0.43049215
E        x: array([5.488135, 7.151894])
E        y: array([9.636628, 9.786183])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____ TestArrayReduction_param_0_{order='C'}.test_max_multiple_axes_keepdims ____
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[1.96582362]],

       [[3.68725171]]])
desired = array([[[9.63662761]],

       [[9.78618342]]]), rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 7.67080399
E       Max relative difference: 0.79600502
E        x: array([[[1.965824]],
E       
E              [[3.687252]]])
E        y: array([[[9.636628]],
E       
E              [[9.786183]]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_max_nan ______________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(6.60173537), y = array(nan), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(6.601735)
E            y: array(nan)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_max_nan_imag ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(3.1831848e-12+1.9827412j, dtype=complex64)
y = array(nan+nanj, dtype=complex64), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(3.183185e-12+1.982741j, dtype=complex64)
E            y: array(nan+nanj, dtype=complex64)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_max_nan_real ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(6.5211584e+27+2.3451202j, dtype=complex64)
y = array(nan+0.j, dtype=complex64), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(6.521158e+27+2.34512j, dtype=complex64)
E            y: array(nan+0.j, dtype=complex64)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_min_all ______________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(2.70327905), desired = 4.236547993389047, rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 1.53326894
E       Max relative difference: 0.36191469
E        x: array(2.703279)
E        y: array(4.236548)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_0_{order='C'}.test_min_all_keepdims _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[8.20767121]]), desired = array([[4.23654799]]), rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 3.97112321
E       Max relative difference: 0.93734881
E        x: array([[8.207671]])
E        y: array([[4.236548]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_min_axis0 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[9.68971705, 9.04948346, 2.96556265, 9.92011243],
       [2.49420041, 1.05906155, 9.50952611, 2.33420255],
       [6.89768265, 0.58356359, 7.30709099, 8.81720212]])
desired = array([[5.48813504, 7.15189366, 0.71036058, 0.871293  ],
       [0.20218397, 6.45894113, 4.37587211, 8.70012148],
       [9.63662761, 3.83441519, 4.61479362, 5.2889492 ]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 9.04881944
E       Max relative difference: 11.33629133
E        x: array([[9.689717, 9.049483, 2.965563, 9.920112],
E              [2.4942  , 1.059062, 9.509526, 2.334203],
E              [6.897683, 0.583564, 7.307091, 8.817202]])
E        y: array([[5.488135, 7.151894, 0.710361, 0.871293],
E              [0.202184, 6.458941, 4.375872, 8.700121],
E              [9.636628, 3.834415, 4.614794, 5.288949]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_min_axis1 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[7.40097526, 6.80514481, 6.22384429, 7.10528403],
       [2.04923687, 3.41698115, 6.76242482, 8.79234763]])
desired = array([[4.23654799, 3.83441519, 4.37587211, 5.2889492 ],
       [0.20218397, 7.99158564, 0.71036058, 0.871293  ]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 7.92105463
E       Max relative difference: 9.13550592
E        x: array([[7.400975, 6.805145, 6.223844, 7.105284],
E              [2.049237, 3.416981, 6.762425, 8.792348]])
E        y: array([[4.236548, 3.834415, 4.375872, 5.288949],
E              [0.202184, 7.991586, 0.710361, 0.871293]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_min_axis2 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[1.60467644, 8.86304666, 4.46394415],
       [9.07875594, 1.60230466, 6.61117512]])
desired = array([[5.44883183, 4.23654799, 3.83441519],
       [0.71036058, 0.20218397, 4.61479362]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 6 / 6 (100%)
E       Max absolute difference: 8.36839536
E       Max relative difference: 11.78048948
E        x: array([[1.604676, 8.863047, 4.463944],
E              [9.078756, 1.602305, 6.611175]])
E        y: array([[5.448832, 4.236548, 3.834415],
E              [0.710361, 0.202184, 4.614794]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
__________ TestArrayReduction_param_0_{order='C'}.test_min_axis_large __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([8.48150380e+00, 9.35832080e+00, 9.83426242e+00, 3.99801692e+00,
       3.80335184e+00, 1.47808677e+00, 6.849344...3.67343751e-03, 2.73732629e+00, 4.62097530e+00,
       6.38362895e+00, 1.01770267e+00, 6.73010134e+00, 8.01815867e+00])
desired = array([5.48813504e+00, 1.00636957e-01, 4.75826196e+00, 2.50520586e+00,
       4.39754320e-01, 3.02904809e+00, 4.375872...5.06862958e+00, 2.84927053e+00, 9.76763674e-01,
       5.14922202e+00, 3.23613710e+00, 2.28646551e+00, 5.01773131e+00])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1000 / 1000 (100%)
E       Max absolute difference: 9.83995215
E       Max relative difference: 4952.90346537
E        x: array([8.481504e+00, 9.358321e+00, 9.834262e+00, 3.998017e+00,
E              3.803352e+00, 1.478087e+00, 6.849344e+00, 6.567620e+00,
E              8.620626e+00, 9.725799e-01, 4.977769e+00, 5.810819e+00,...
E        y: array([5.488135e+00, 1.006370e-01, 4.758262e+00, 2.505206e+00,
E              4.397543e-01, 3.029048e+00, 4.375872e+00, 3.066105e-01,
E              1.594691e+00, 3.834415e+00, 4.268195e+00, 1.074726e+00,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_0_{order='C'}.test_min_multiple_axes _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([5.e-324, 5.e-324]), desired = array([3.83441519, 0.20218397])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 3.83441519
E       Max relative difference: 1.
E        x: array([5.e-324, 5.e-324])
E        y: array([3.834415, 0.202184])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____ TestArrayReduction_param_0_{order='C'}.test_min_multiple_axes_keepdims ____
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[1.5e-323]],

       [[3.5e-323]]])
desired = array([[[3.83441519]],

       [[0.20218397]]]), rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 3.83441519
E       Max relative difference: 1.
E        x: array([[[1.5e-323]],
E       
E              [[3.5e-323]]])
E        y: array([[[3.834415]],
E       
E              [[0.202184]]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_min_nan ______________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(5.48813504), y = array(nan), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(5.488135)
E            y: array(nan)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_min_nan_imag ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(-1.7539115e-12+2.3430083j, dtype=complex64)
y = array(nan+nanj, dtype=complex64), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(-1.753911e-12+2.343008j, dtype=complex64)
E            y: array(nan+nanj, dtype=complex64)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_min_nan_real ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array(2.5738757e+33+1.9957279j, dtype=complex64)
y = array(nan+0.j, dtype=complex64), func = <ufunc 'isnan'>, hasval = 'nan'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           x and y nan location mismatch:
E            x: array(2.573876e+33+1.995728j, dtype=complex64)
E            y: array(nan+0.j, dtype=complex64)

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_ptp_all ______________

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestArrayReduction_param_0_{order='C'} testMethod=test_ptp_all>  parameter: {'order': 'C'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(contiguous_check=False)
    def test_ptp_all(self, xp, dtype):
        a = testing.shaped_random((2, 3), xp, dtype, order=self.order)
>       return a.ptp()

tests/cupy_tests/core_tests/test_ndarray_reduction.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:910: in cupy._core.core.ndarray.ptp
    cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:918: in cupy._core.core.ndarray.ptp
    return _statistics._ndarray_ptp(self, axis, out, keepdims)
cupy/_core/_routines_statistics.pyx:84: in cupy._core._routines_statistics._ndarray_ptp
    result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
cupy/_core/core.pyx:1226: in cupy._core.core.ndarray.__isub__
    return _math._subtract(self, other, self)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4341f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 159, in test_ptp_all
E           return a.ptp()
E         File "cupy/_core/core.pyx", line 910, in cupy._core.core.ndarray.ptp
E           cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 918, in cupy._core.core.ndarray.ptp
E           return _statistics._ndarray_ptp(self, axis, out, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 84, in cupy._core._routines_statistics._ndarray_ptp
E           result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
E         File "cupy/_core/core.pyx", line 1226, in cupy._core.core.ndarray.__isub__
E           return _math._subtract(self, other, self)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_0_{order='C'}.test_ptp_all_keepdims _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[-3.65999464]]), desired = array([[2.91534567]]), rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 6.57534031
E       Max relative difference: 2.2554239
E        x: array([[-3.659995]])
E        y: array([[2.915346]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_ptp_axis0 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[ 2.81864565,  4.5299327 ,  9.06562058, -0.09451108],
       [-0.21289369, -3.55846625, -6.66851706,  2.33903871],
       [ 3.863977  ,  4.05225956,  1.00579144, -2.02135346]])
desired = array([[0.19231057, 2.10407272, 5.31727318, 4.57753883],
       [4.03436402, 1.86725732, 3.4056954 , 0.21760853],
       [0.14955582, 4.15717045, 3.30245676, 2.51634257]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 10.07421246
E       Max relative difference: 24.83635374
E        x: array([[ 2.818646,  4.529933,  9.065621, -0.094511],
E              [-0.212894, -3.558466, -6.668517,  2.339039],
E              [ 3.863977,  4.05226 ,  1.005791, -2.021353]])
E        y: array([[0.192311, 2.104073, 5.317273, 4.577539],
E              [4.034364, 1.867257, 3.405695, 0.217609],
E              [0.149556, 4.15717 , 3.302457, 2.516343]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_ptp_axis1 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[-5.50439215, -7.77360919, -7.60149498,  1.42184171],
       [-3.6678029 ,  0.57706308,  6.20568384,  2.71593194]])
desired = array([[5.40007961, 3.31747848, 3.54137827, 3.62878081],
       [9.58399945, 1.26438074, 7.07120693, 7.82882849]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 13.25180235
E       Max relative difference: 3.34322822
E        x: array([[-5.504392, -7.773609, -7.601495,  1.421842],
E              [-3.667803,  0.577063,  6.205684,  2.715932]])
E        y: array([[5.40008 , 3.317478, 3.541378, 3.628781],
E              [9.583999, 1.264381, 7.071207, 7.828828]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_0_{order='C'}.test_ptp_axis2 _____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[-1.48204584,  0.03895373,  5.18967554],
       [-8.3259678 ,  3.79478398,  2.92528104]])
desired = array([[1.70306183, 4.68118201, 5.80221242],
       [8.5456058 , 8.49793751, 5.1713898 ]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 6 / 6 (100%)
E       Max absolute difference: 16.8715736
E       Max relative difference: 1.97429814
E        x: array([[-1.482046,  0.038954,  5.189676],
E              [-8.325968,  3.794784,  2.925281]])
E        y: array([[1.703062, 4.681182, 5.802212],
E              [8.545606, 8.497938, 5.17139 ]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
__________ TestArrayReduction_param_0_{order='C'}.test_ptp_axis_large __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([-1.90569852e+00,  6.38975617e-01, -3.39125409e-01,  1.19949856e+00,
       -3.74257344e+00, -5.86500317e+00,  8...4014e+00,  9.28101772e+00,  6.52012860e+00,
        5.04386324e+00,  5.57650814e+00,  3.17872847e+00,  6.14175002e+00])
desired = array([2.62704967, 7.05125671, 1.2693718 , 4.58249805, 5.61067585,
       5.76616674, 1.39696803, 8.61111952, 8.041936...79, 5.52370072, 2.59639725, 3.72818584, 4.51926109,
       8.44010704, 2.06275911, 6.14798312, 5.84898466, 1.95627248])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1000 / 1000 (100%)
E       Max absolute difference: 17.36694001
E       Max relative difference: 350.08693251
E        x: array([-1.905699e+00,  6.389756e-01, -3.391254e-01,  1.199499e+00,
E              -3.742573e+00, -5.865003e+00,  8.452597e+00,  3.364448e+00,
E              -5.612765e-01, -2.318951e+00,  1.500681e+00,  7.419321e+00,...
E        y: array([2.62705 , 7.051257, 1.269372, 4.582498, 5.610676, 5.766167,
E              1.396968, 8.61112 , 8.041937, 5.702342, 3.649055, 4.214224,
E              4.364477, 8.863861, 0.50086 , 3.244862, 4.692402, 5.88942 ,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_0_{order='C'}.test_ptp_multiple_axes _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([3.52231142, 3.46464196])
desired = array([5.80221242, 9.58399945]), rtol = 1e-07, atol = 0, err_msg = ''
verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 6.11935749
E       Max relative difference: 0.63849727
E        x: array([3.522311, 3.464642])
E        y: array([5.802212, 9.583999])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____ TestArrayReduction_param_0_{order='C'}.test_ptp_multiple_axes_keepdims ____
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-4.63591176]],

       [[ 0.78647563]]])
desired = array([[[5.80221242]],

       [[9.58399945]]]), rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 10.43812417
E       Max relative difference: 1.79899035
E        x: array([[[-4.635912]],
E       
E              [[ 0.786476]]])
E        y: array([[[5.802212]],
E       
E              [[9.583999]]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_____________ TestArrayReduction_param_0_{order='C'}.test_ptp_nan ______________

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestArrayReduction_param_0_{order='C'} testMethod=test_ptp_nan>  parameter: {'order': 'C'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes()
    @testing.numpy_cupy_allclose(contiguous_check=False)
    def test_ptp_nan(self, xp, dtype):
        if _acc.ACCELERATOR_CUTENSOR in _acc.get_routine_accelerators():
            pytest.skip()
        a = xp.array([float('nan'), 1, -1], dtype, order=self.order)
>       return a.ptp()

tests/cupy_tests/core_tests/test_ndarray_reduction.py:212: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:910: in cupy._core.core.ndarray.ptp
    cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:918: in cupy._core.core.ndarray.ptp
    return _statistics._ndarray_ptp(self, axis, out, keepdims)
cupy/_core/_routines_statistics.pyx:84: in cupy._core._routines_statistics._ndarray_ptp
    result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
cupy/_core/core.pyx:1226: in cupy._core.core.ndarray.__isub__
    return _math._subtract(self, other, self)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce5280e20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 212, in test_ptp_nan
E           return a.ptp()
E         File "cupy/_core/core.pyx", line 910, in cupy._core.core.ndarray.ptp
E           cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 918, in cupy._core.core.ndarray.ptp
E           return _statistics._ndarray_ptp(self, axis, out, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 84, in cupy._core._routines_statistics._ndarray_ptp
E           result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
E         File "cupy/_core/core.pyx", line 1226, in cupy._core.core.ndarray.__isub__
E           return _math._subtract(self, other, self)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_ptp_nan_imag ___________

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestArrayReduction_param_0_{order='C'} testMethod=test_ptp_nan_imag>  parameter: {'order': 'C'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>

    @testing.for_complex_dtypes()
    @testing.numpy_cupy_allclose(contiguous_check=False)
    def test_ptp_nan_imag(self, xp, dtype):
        a = xp.array([float('nan')*1.j, 1.j, -1.j], dtype, order=self.order)
>       return a.ptp()

tests/cupy_tests/core_tests/test_ndarray_reduction.py:224: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:910: in cupy._core.core.ndarray.ptp
    cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:918: in cupy._core.core.ndarray.ptp
    return _statistics._ndarray_ptp(self, axis, out, keepdims)
cupy/_core/_routines_statistics.pyx:84: in cupy._core._routines_statistics._ndarray_ptp
    result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
cupy/_core/core.pyx:1226: in cupy._core.core.ndarray.__isub__
    return _math._subtract(self, other, self)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced44d0d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 224, in test_ptp_nan_imag
E           return a.ptp()
E         File "cupy/_core/core.pyx", line 910, in cupy._core.core.ndarray.ptp
E           cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 918, in cupy._core.core.ndarray.ptp
E           return _statistics._ndarray_ptp(self, axis, out, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 84, in cupy._core._routines_statistics._ndarray_ptp
E           result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
E         File "cupy/_core/core.pyx", line 1226, in cupy._core.core.ndarray.__isub__
E           return _math._subtract(self, other, self)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_0_{order='C'}.test_ptp_nan_real ___________

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestArrayReduction_param_0_{order='C'} testMethod=test_ptp_nan_real>  parameter: {'order': 'C'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>

    @testing.for_complex_dtypes()
    @testing.numpy_cupy_allclose(contiguous_check=False)
    def test_ptp_nan_real(self, xp, dtype):
        a = xp.array([float('nan'), 1, -1], dtype, order=self.order)
>       return a.ptp()

tests/cupy_tests/core_tests/test_ndarray_reduction.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:910: in cupy._core.core.ndarray.ptp
    cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:918: in cupy._core.core.ndarray.ptp
    return _statistics._ndarray_ptp(self, axis, out, keepdims)
cupy/_core/_routines_statistics.pyx:84: in cupy._core._routines_statistics._ndarray_ptp
    result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
cupy/_core/core.pyx:1226: in cupy._core.core.ndarray.__isub__
    return _math._subtract(self, other, self)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ceda60dc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 218, in test_ptp_nan_real
E           return a.ptp()
E         File "cupy/_core/core.pyx", line 910, in cupy._core.core.ndarray.ptp
E           cpdef ndarray ptp(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 918, in cupy._core.core.ndarray.ptp
E           return _statistics._ndarray_ptp(self, axis, out, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 84, in cupy._core._routines_statistics._ndarray_ptp
E           result -= _amin(self, axis=axis, out=None, keepdims=keepdims)
E         File "cupy/_core/core.pyx", line 1226, in cupy._core.core.ndarray.__isub__
E           return _math._subtract(self, other, self)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_1_{order='F'}.test_argmax_all ____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(4613269662066522018, dtype=int64), desired = 1, rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4613269662066522017
E       Max relative difference: 4.61326966e+18
E        x: array(4613269662066522018, dtype=int64)
E        y: array(1)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_1_{order='F'}.test_argmax_axis0 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4620810126178443896, 4621305953344235431, 4620780609012655763,
        4609858208354508767],
       [461876678...15],
       [4613007466136266513, 4620969278816585797, 4599671248066122500,
        4621588210840807254]], dtype=int64)
desired = array([[1, 1, 0, 0],
       [0, 1, 1, 0],
       [1, 1, 0, 1]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 4621588210840807253
E       Max relative difference: 4.62158821e+18
E        x: array([[4620810126178443896, 4621305953344235431, 4620780609012655763,
E               4609858208354508767],
E              [4618766785366918305, 4616154360693273496, 4603823900092549286,...
E        y: array([[1, 1, 0, 0],
E              [0, 1, 1, 0],
E              [1, 1, 0, 1]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_1_{order='F'}.test_argmax_axis1 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4621644443814865838, 4621284024344518647, 4613860272224201163,
        4621774144887494360],
       [4612798858819820246, 4607448408369285542, 4621543005335753491,
        4612438575677751630]], dtype=int64)
desired = array([[2, 0, 2, 1],
       [2, 0, 1, 1]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 8 / 8 (100%)
E       Max absolute difference: 4621774144887494359
E       Max relative difference: 4.62177414e+18
E        x: array([[4621644443814865838, 4621284024344518647, 4613860272224201163,
E               4621774144887494360],
E              [4612798858819820246, 4607448408369285542, 4621543005335753491,
E               4612438575677751630]], dtype=int64)
E        y: array([[2, 0, 2, 1],
E              [2, 0, 1, 1]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_1_{order='F'}.test_argmax_axis2 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4620018775778861956, 4619347930336625546, 4618693444128815550],
       [4619685857051729178, 4611796890001172913, 4614876776313907450]],
      dtype=int64)
desired = array([[1, 3, 0],
       [1, 3, 0]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 6 / 6 (100%)
E       Max absolute difference: 4620018775778861955
E       Max relative difference: 4.62001878e+18
E        x: array([[4620018775778861956, 4619347930336625546, 4618693444128815550],
E              [4619685857051729178, 4611796890001172913, 4614876776313907450]],
E             dtype=int64)
E        y: array([[1, 3, 0],
E              [1, 3, 0]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
________ TestArrayReduction_param_1_{order='F'}.test_argmax_axis_large _________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([4609905639384819127, 4621179069759663604, 4616711972735463962,
       4621300503290299538, 4609894957856774892,...450364,
       4614334852730605090, 4614589798952983688, 4596262682277158224,
       4601034980105435600], dtype=int64)
desired = array([2, 0, 0, 1, 2, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0,
       1, 1, 2, 1, 1, 0, 1, 0, 2, 2, 1, 1, 2,...1, 0, 2,
       1, 0, 1, 2, 0, 0, 0, 1, 0, 2, 1, 2, 1, 0, 0, 1, 0, 2, 0, 0, 2, 1,
       1, 1, 2, 2, 0, 2, 1, 0, 2, 2])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1000 / 1000 (100%)
E       Max absolute difference: 4621818039979570137
E       Max relative difference: 4.62181804e+18
E        x: array([4609905639384819127, 4621179069759663604, 4616711972735463962,
E              4621300503290299538, 4609894957856774892, 4619129539873577870,
E              4616642947610356993, 4605064535235347746, 4619527496324223618,...
E        y: array([2, 0, 0, 1, 2, 1, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 0, 0,
E              1, 1, 2, 1, 1, 0, 1, 0, 2, 2, 1, 1, 2, 2, 2, 0, 2, 0, 2, 0, 0, 1,
E              0, 2, 2, 1, 2, 1, 2, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 2, 2, 2,...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_1_{order='F'}.test_argmax_nan_imag __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(4610456386486806907, dtype=int64), desired = 0, rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4610456386486806907
E       Max relative difference: inf
E        x: array(4610456386486806907, dtype=int64)
E        y: array(0)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex128'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_________ TestArrayReduction_param_1_{order='F'}.test_argmax_nan_real __________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(4603491560853280066, dtype=int64), desired = 0, rtol = 1e-07
atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4603491560853280066
E       Max relative difference: inf
E        x: array(4603491560853280066, dtype=int64)
E        y: array(0)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex128'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
____________ TestArrayReduction_param_1_{order='F'}.test_argmin_all ____________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array(0, dtype=int64), desired = 4, rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 1 / 1 (100%)
E       Max absolute difference: 4
E       Max relative difference: 1.
E        x: array(0, dtype=int64)
E        y: array(4)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
___________ TestArrayReduction_param_1_{order='F'}.test_argmin_axis0 ___________
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[4617865109156845394, 4617820857677151090, 4619738334837123328,
        4616455947418478938],
       [461847253...65],
       [4618958139644707378, 4620876851087447117, 4615816754206528156,
        4620683743957428846]], dtype=int64)
desired = array([[0, 0, 1, 1],
       [1, 0, 0, 1],
       [0, 0, 1, 0]])
rtol = 1e-07, atol = 0, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 12 / 12 (100%)
E       Max absolute difference: 4621400263898896164
E       Max relative difference: 4.62140026e+18
E        x: array([[4617865109156845394, 4617820857677151090, 4619738334837123328,
E               4616455947418478938],
E              [4618472530717059998, 4618958139644707378, 4619738334837123328,...
E        y: array([[0, 0, 1, 1],
E              [1, 0, 0, 1],
E              [0, 0, 1, 0]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
----------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "cupy/_core/_reduction.pyx", line 609, in cupy._core._reduction._SimpleReductionKernel._get_function
    return _SimpleReductionKernel_get_cached_function(
  File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
  File "cupy/_core/_reduction.pyx", line 622, in cupy._core._reduction._SimpleReductionKernel_get_cached_function
    return _create_reduction_function(
  File "cupy/_core/_reduction.pyx", line 123, in cupy._core._reduction._create_reduction_function
    module = compile_with_cache(module_code, options)
  File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
    return _compile_with_cache_hip(
  File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
    temp_path = tf.name
  File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
    result = self.file.__exit__(exc, value, tb)
OSError: [Errno 28] No space left on device
_ TestCubReduction_param_9_{backend='block', order='C', shape=(10, 20)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_9_{backend='block', order='C', shape=(10, 20)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'C', 'shape': (10, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>, axis = (1,)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:550: in cupy._core._cub_reduction._launch_cub
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5bd730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 550, in cupy._core._cub_reduction._launch_cub
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
axis is (1,) , ndim is 2 , shape is (10, 20) , order is C
_ TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)}.test_cub_max _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)} testMethod=test_cub_max>  parameter: {'backend': 'block', 'order': 'C', 'shape': (10, 20, 30)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_max(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.max(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.max(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.max(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:421: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:852: in cupy._core.core.ndarray.max
    cpdef ndarray max(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:860: in cupy._core.core.ndarray.max
    return _statistics._ndarray_max(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:41: in cupy._core._routines_statistics._ndarray_max
    return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:536: in cupy._core._cub_reduction._launch_cub
    _cub_two_pass_launch(
cupy/_core/_cub_reduction.pyx:471: in cupy._core._cub_reduction._cub_two_pass_launch
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc1bf3d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 421, in test_cub_max
E           a.max(axis=axis)
E         File "cupy/_core/core.pyx", line 852, in cupy._core.core.ndarray.max
E           cpdef ndarray max(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 860, in cupy._core.core.ndarray.max
E           return _statistics._ndarray_max(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 41, in cupy._core._routines_statistics._ndarray_max
E           return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 536, in cupy._core._cub_reduction._launch_cub
E           _cub_two_pass_launch(
E         File "cupy/_core/_cub_reduction.pyx", line 471, in cupy._core._cub_reduction._cub_two_pass_launch
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2) , ndim is 3 , shape is (10, 20, 30) , order is C
_ TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'C', 'shape': (10, 20, 30)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:536: in cupy._core._cub_reduction._launch_cub
    _cub_two_pass_launch(
cupy/_core/_cub_reduction.pyx:471: in cupy._core._cub_reduction._cub_two_pass_launch
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced3f7d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 536, in cupy._core._cub_reduction._launch_cub
E           _cub_two_pass_launch(
E         File "cupy/_core/_cub_reduction.pyx", line 471, in cupy._core._cub_reduction._cub_two_pass_launch
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2) , ndim is 3 , shape is (10, 20, 30) , order is C
_ TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)}.test_cub_max _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)} testMethod=test_cub_max>  parameter: {'backend': 'block', 'order': 'C', 'shape': (10, 20, 30, 40)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2, 3)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_max(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.max(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.max(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.max(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:421: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:852: in cupy._core.core.ndarray.max
    cpdef ndarray max(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:860: in cupy._core.core.ndarray.max
    return _statistics._ndarray_max(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:41: in cupy._core._routines_statistics._ndarray_max
    return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:536: in cupy._core._cub_reduction._launch_cub
    _cub_two_pass_launch(
cupy/_core/_cub_reduction.pyx:471: in cupy._core._cub_reduction._cub_two_pass_launch
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce5350460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 421, in test_cub_max
E           a.max(axis=axis)
E         File "cupy/_core/core.pyx", line 852, in cupy._core.core.ndarray.max
E           cpdef ndarray max(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 860, in cupy._core.core.ndarray.max
E           return _statistics._ndarray_max(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 41, in cupy._core._routines_statistics._ndarray_max
E           return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 536, in cupy._core._cub_reduction._launch_cub
E           _cub_two_pass_launch(
E         File "cupy/_core/_cub_reduction.pyx", line 471, in cupy._core._cub_reduction._cub_two_pass_launch
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2, 3) , ndim is 4 , shape is (10, 20, 30, 40) , order is C
_ TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'C', 'shape': (10, 20, 30, 40)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2, 3)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:536: in cupy._core._cub_reduction._launch_cub
    _cub_two_pass_launch(
cupy/_core/_cub_reduction.pyx:471: in cupy._core._cub_reduction._cub_two_pass_launch
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc0a96d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 536, in cupy._core._cub_reduction._launch_cub
E           _cub_two_pass_launch(
E         File "cupy/_core/_cub_reduction.pyx", line 471, in cupy._core._cub_reduction._cub_two_pass_launch
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2, 3) , ndim is 4 , shape is (10, 20, 30, 40) , order is C
_ TestCubReduction_param_13_{backend='block', order='F', shape=(10, 20)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_13_{backend='block', order='F', shape=(10, 20)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'F', 'shape': (10, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>, axis = (0,)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:550: in cupy._core._cub_reduction._launch_cub
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce526dac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 550, in cupy._core._cub_reduction._launch_cub
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
axis is (0,) , ndim is 2 , shape is (10, 20) , order is F
_ TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)}.test_cub_max _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)} testMethod=test_cub_max>  parameter: {'backend': 'block', 'order': 'F', 'shape': (10, 20, 30)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_max(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.max(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.max(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.max(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:421: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:852: in cupy._core.core.ndarray.max
    cpdef ndarray max(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:860: in cupy._core.core.ndarray.max
    return _statistics._ndarray_max(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:41: in cupy._core._routines_statistics._ndarray_max
    return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:536: in cupy._core._cub_reduction._launch_cub
    _cub_two_pass_launch(
cupy/_core/_cub_reduction.pyx:471: in cupy._core._cub_reduction._cub_two_pass_launch
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced57caf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 421, in test_cub_max
E           a.max(axis=axis)
E         File "cupy/_core/core.pyx", line 852, in cupy._core.core.ndarray.max
E           cpdef ndarray max(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 860, in cupy._core.core.ndarray.max
E           return _statistics._ndarray_max(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 41, in cupy._core._routines_statistics._ndarray_max
E           return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 536, in cupy._core._cub_reduction._launch_cub
E           _cub_two_pass_launch(
E         File "cupy/_core/_cub_reduction.pyx", line 471, in cupy._core._cub_reduction._cub_two_pass_launch
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2) , ndim is 3 , shape is (10, 20, 30) , order is F
_ TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'F', 'shape': (10, 20, 30)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>, axis = (0,)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:550: in cupy._core._cub_reduction._launch_cub
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc02ee20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 550, in cupy._core._cub_reduction._launch_cub
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
axis is (0,) , ndim is 3 , shape is (10, 20, 30) , order is F
_ TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)}.test_cub_max _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)} testMethod=test_cub_max>  parameter: {'backend': 'block', 'order': 'F', 'shape': (10, 20, 30, 40)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>, axis = (0, 1, 2)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_max(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.max(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.max(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.max(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:421: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:852: in cupy._core.core.ndarray.max
    cpdef ndarray max(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:860: in cupy._core.core.ndarray.max
    return _statistics._ndarray_max(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:41: in cupy._core._routines_statistics._ndarray_max
    return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:550: in cupy._core._cub_reduction._launch_cub
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5be400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 421, in test_cub_max
E           a.max(axis=axis)
E         File "cupy/_core/core.pyx", line 852, in cupy._core.core.ndarray.max
E           cpdef ndarray max(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 860, in cupy._core.core.ndarray.max
E           return _statistics._ndarray_max(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 41, in cupy._core._routines_statistics._ndarray_max
E           return _amax(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 550, in cupy._core._cub_reduction._launch_cub
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
axis is (0, 1, 2) , ndim is 4 , shape is (10, 20, 30, 40) , order is F
_ TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)}.test_cub_min _

self = <<cupy_tests.core_tests.test_ndarray_reduction.TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)} testMethod=test_cub_min>  parameter: {'backend': 'block', 'order': 'F', 'shape': (10, 20, 30, 40)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.complex64'>, axis = (0,)

    @testing.for_contiguous_axes()
    @testing.for_all_dtypes(no_bool=True)
    @testing.numpy_cupy_allclose(rtol=1E-5)
    def test_cub_min(self, xp, dtype, axis):
        a = testing.shaped_random(self.shape, xp, dtype, order=self.order)
    
        if xp is numpy:
            return a.min(axis=axis)
    
        # xp is cupy, first ensure we really use CUB
        ret = cupy.empty(())  # Cython checks return type, need to fool it
        if self.backend == 'device':
            func_name = 'cupy._core._routines_statistics.cub.'
            if len(axis) == len(self.shape):
                func_name += 'device_reduce'
            else:
                func_name += 'device_segmented_reduce'
            with testing.AssertFunctionIsCalled(func_name, return_value=ret):
                a.min(axis=axis)
        elif self.backend == 'block':
            # this is the only function we can mock; the rest is cdef'd
            func_name = 'cupy._core._cub_reduction.'
            func_name += '_SimpleCubReductionKernel_get_cached_function'
            func = _cub_reduction._SimpleCubReductionKernel_get_cached_function
            if len(axis) == len(self.shape):
                times_called = 2  # two passes
            else:
                times_called = 1  # one pass
            with testing.AssertFunctionIsCalled(
                    func_name, wraps=func, times_called=times_called):
>               a.min(axis=axis)

tests/cupy_tests/core_tests/test_ndarray_reduction.py:381: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:881: in cupy._core.core.ndarray.min
    cpdef ndarray min(self, axis=None, out=None, keepdims=False):
cupy/_core/core.pyx:889: in cupy._core.core.ndarray.min
    return _statistics._ndarray_min(self, axis, out, None, keepdims)
cupy/_core/_routines_statistics.pyx:59: in cupy._core._routines_statistics._ndarray_min
    return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
cupy/_core/_reduction.pyx:560: in cupy._core._reduction._SimpleReductionKernel.__call__
    return self._call(
cupy/_core/_reduction.pyx:346: in cupy._core._reduction._AbstractReductionKernel._call
    cub_success = _cub_reduction._try_to_call_cub_reduction(
cupy/_core/_cub_reduction.pyx:700: in cupy._core._cub_reduction._try_to_call_cub_reduction
    _launch_cub(
cupy/_core/_cub_reduction.pyx:550: in cupy._core._cub_reduction._launch_cub
    func = _SimpleCubReductionKernel_get_cached_function(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1081: in __call__
    return self._mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1085: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py:1155: in _execute_mock_call
    return self._mock_wraps(*args, **kwargs)
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_cub_reduction.pyx:243: in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
    return _create_cub_reduction_function(
cupy/_core/_cub_reduction.pyx:228: in cupy._core._cub_reduction._create_cub_reduction_function
    module = compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5775e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_reduction.py", line 381, in test_cub_min
E           a.min(axis=axis)
E         File "cupy/_core/core.pyx", line 881, in cupy._core.core.ndarray.min
E           cpdef ndarray min(self, axis=None, out=None, keepdims=False):
E         File "cupy/_core/core.pyx", line 889, in cupy._core.core.ndarray.min
E           return _statistics._ndarray_min(self, axis, out, None, keepdims)
E         File "cupy/_core/_routines_statistics.pyx", line 59, in cupy._core._routines_statistics._ndarray_min
E           return _amin(self, axis=axis, out=out, dtype=dtype, keepdims=keepdims)
E         File "cupy/_core/_reduction.pyx", line 560, in cupy._core._reduction._SimpleReductionKernel.__call__
E           return self._call(
E         File "cupy/_core/_reduction.pyx", line 346, in cupy._core._reduction._AbstractReductionKernel._call
E           cub_success = _cub_reduction._try_to_call_cub_reduction(
E         File "cupy/_core/_cub_reduction.pyx", line 700, in cupy._core._cub_reduction._try_to_call_cub_reduction
E           _launch_cub(
E         File "cupy/_core/_cub_reduction.pyx", line 550, in cupy._core._cub_reduction._launch_cub
E           func = _SimpleCubReductionKernel_get_cached_function(
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1081, in __call__
E           return self._mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1085, in _mock_call
E           return self._execute_mock_call(*args, **kwargs)
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/unittest/mock.py", line 1155, in _execute_mock_call
E           return self._mock_wraps(*args, **kwargs)
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_cub_reduction.pyx", line 243, in cupy._core._cub_reduction._SimpleCubReductionKernel_get_cached_function
E           return _create_cub_reduction_function(
E         File "cupy/_core/_cub_reduction.pyx", line 228, in cupy._core._cub_reduction._create_cub_reduction_function
E           module = compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.complex64'>
axis is (0,) , ndim is 4 , shape is (10, 20, 30, 40) , order is F
_ TestScatterParametrized.test_scatter_add[_param_0_{shape=(2, 3, 4), slices=array(-1), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4ad640>  parameter: {'shape': (2, 3, 4), 'slices': array(-1), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4ad850>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_1_{shape=(2, 3, 4), slices=array([1, 0]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced568880>  parameter: {'shape': (2, 3, 4), 'slices': array([1, 0]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced568dc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_2_{shape=(2, 3, 4), slices=(slice(None, None, None), [1, 2]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce4f0fac0>  parameter: {'shape': (2, 3, 4), 'slices': (slice(None, None, None), [1, 2]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce4f0ffa0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_3_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced581a00>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), [[1, 2], [0, -1]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced581c10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_4_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5bd040>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5bdfa0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_5_{shape=(2, 3), slices=([1, 1], slice(None, None, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced456a60>  parameter: {'shape': (2, 3), 'slices': ([1, 1], slice(None, None, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced456a90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_6_{shape=(2, 3), slices=([1, 0, 1], slice(None, None, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5bac10>  parameter: {'shape': (2, 3), 'slices': ([1, 0, 1], slice(None, None, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5ba760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_7_{shape=(2, 3), slices=(slice(1, 2, None), [1, 0, 1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda9bfa0>  parameter: {'shape': (2, 3), 'slices': (slice(1, 2, None), [1, 0, 1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ceda9bc70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_8_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced591fd0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5918e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_9_{shape=(3, 4, 5), slices=(None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda6e310>  parameter: {'shape': (3, 4, 5), 'slices': (None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ceda6e5e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_10_{shape=(3, 4, 5), slices=(None, [1, -1], None), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced48b490>  parameter: {'shape': (3, 4, 5), 'slices': (None, [1, -1], None), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced48bac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_11_{shape=(3, 4, 5), slices=(None, None, None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda6b7c0>  parameter: {'shape': (3, 4, 5), 'slices': (None, None, None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ceda6bfa0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_12_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5587c0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5584f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_13_{shape=(3, 4, 5), slices=(slice(0, 1, None), slice(1, 2, None), [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5da6d0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), slice(1, 2, None), [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5dadc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_14_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, slice(1, 2, None), [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced48bdc0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), None, slice(1, 2, None), [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5a9670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_15_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=array([[[[ 0,  1,  2,  3,  4],\n         [ 5,  6,...1, 52, 53, 54],\n         [55, 56, 57, 58, 59]]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda6bdc0>  parameter: {'shape': (...0, 41, 42, 43, 44],
         [45, 46, 47, 48, 49]],

        [[50, 51, 52, 53, 54],
         [55, 56, 57, 58, 59]]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5db430>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_16_{shape=(2, 3, 4), slices=([1, 0], [2, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced726b50>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 0], [2, 1]), 'value': array([[0, 1, 2, 3],
       [4, 5, 6, 7]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced7263d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_17_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [2, 1]), value=array([[0, 1, 2],\n       [3, 4, 5]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5da670>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 0], slice(None, None, None), [2, 1]), 'value': array([[0, 1, 2],
       [3, 4, 5]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0a08cd02e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_18_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [[2, 0], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5d2c70>  parameter: {'shape': (...2, 0], [3, 1]]), 'value': array([[[ 0,  1,  2],
        [ 3,  4,  5]],

       [[ 6,  7,  8],
        [ 9, 10, 11]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5d2ac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_19_{shape=(1, 1, 2, 3, 4), slices=(None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc03abe0>  parameter: {'shape': (1, 1, 2, 3, 4), 'slices': (None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc03af10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_20_{shape=(2, 3, 4), slices=([1, 1], [1, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4dd130>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1], [1, 1]), 'value': array([[0, 1, 2, 3],
       [4, 5, 6, 7]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4dd4f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_21_{shape=(2, 3, 4), slices=([1, 1], slice(None, None, None), [[2, 2], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4b4df0>  parameter: {'shape': (...2, 2], [3, 1]]), 'value': array([[[ 0,  1,  2],
        [ 3,  4,  5]],

       [[ 6,  7,  8],
        [ 9, 10, 11]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4b4130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_22_{shape=(2, 3, 4), slices=([1, 1], 1, [[2, 2], [3, 1]]), value=array([[0, 1],\n       [2, 3]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4133a0>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1], 1, [[2, 2], [3, 1]]), 'value': array([[0, 1],
       [2, 3]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced413cd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_23_{shape=(3, 4, 5), slices=(array([[[ True, False,  True, False,  True],\n  ...\n        [ True,  True, False, False,  True]]]),), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5f4760>  parameter: {'shape': (...se, False],
        [ True,  True,  True,  True,  True],
        [ True,  True, False, False,  True]]]),), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:910: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_add_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5f46a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 910, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_add_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_24_{shape=(3, 4, 5), slices=(array([False, False,  True]),), value=array([[ 0,  1,  2,  3,  4],\n       [ 5,  6,  7,...0, 11, 12, 13, 14],\n       [15, 16, 17, 18, 19]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce5350580>  parameter: {'shape': (... array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:910: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_add_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce5350610>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 910, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_add_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_25_{shape=(3, 4, 5), slices=(slice(None, None, None), array([ True, False, False,  True])), value=array([[[ 0,  1,  2,  3,  4],\n        [ 5,  6,  ... 21, 22, 23, 24],\n        [25, 26, 27, 28, 29]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5b5730>  parameter: {'shape': (... [[10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19]],

       [[20, 21, 22, 23, 24],
        [25, 26, 27, 28, 29]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:910: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_add_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5b56a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 910, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_add_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_41_{shape=(2, 3, 4), slices=[1], value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc280d30>  parameter: {'shape': (2, 3, 4), 'slices': [1], 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5750d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_42_{shape=(2, 3, 4), slices=[1, 1], value=array([[[ 0,  1,  2,  3],\n        [ 4,  5,  6,  ...    [16, 17, 18, 19],\n        [20, 21, 22, 23]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced394070>  parameter: {'shape': (...  6,  7],
        [ 8,  9, 10, 11]],

       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced394820>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_43_{shape=(2, 3, 4), slices=([1],), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced564a90>  parameter: {'shape': (2, 3, 4), 'slices': ([1],), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced564940>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_44_{shape=(2, 3, 4), slices=([1, 1],), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cd3766e80>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1],), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cd37664c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_45_{shape=(2, 3, 4), slices=([1], [1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc201b80>  parameter: {'shape': (2, 3, 4), 'slices': ([1], [1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc201b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_46_{shape=(2, 3, 4), slices=([1, 1], 1), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc2f4d90>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1], 1), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc2f4310>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_47_{shape=(2, 3, 4), slices=([1], slice(1, 2, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc0a91c0>  parameter: {'shape': (2, 3, 4), 'slices': ([1], slice(1, 2, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc0a9700>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_add[_param_48_{shape=(2, 3, 4), slices=([[1]], slice(1, 2, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce52afb50>  parameter: {'shape': (2, 3, 4), 'slices': ([[1]], slice(1, 2, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float16,
                         numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_add(self, xp, dtype):
        if cupy.cuda.runtime.is_hip and dtype == numpy.float16:
            pytest.skip('atomicAdd does not support float16 in HIP')
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_add(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1426: in cupy._core.core.ndarray.scatter_add
    _indexing._ndarray_scatter_add(self, slices, value)
cupy/_core/_routines_indexing.pyx:126: in cupy._core._routines_indexing._ndarray_scatter_add
    _scatter_op(self, slices, value, 'add')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:863: in cupy._core._routines_indexing._scatter_op_single
    _scatter_add_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce52af640>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 123, in test_scatter_add
E           a.scatter_add(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1426, in cupy._core.core.ndarray.scatter_add
E           _indexing._ndarray_scatter_add(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 126, in cupy._core._routines_indexing._ndarray_scatter_add
E           _scatter_op(self, slices, value, 'add')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 863, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_add_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_0_{shape=(2, 3, 4), slices=array(-1), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc208340>  parameter: {'shape': (2, 3, 4), 'slices': array(-1), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc208d90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_1_{shape=(2, 3, 4), slices=array([1, 0]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce5365430>  parameter: {'shape': (2, 3, 4), 'slices': array([1, 0]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce5365340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_2_{shape=(2, 3, 4), slices=(slice(None, None, None), [1, 2]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4d3ac0>  parameter: {'shape': (2, 3, 4), 'slices': (slice(None, None, None), [1, 2]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4d3d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_3_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cedaa6b50>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), [[1, 2], [0, -1]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cedaa6cd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_4_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced726580>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5ba160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_5_{shape=(2, 3), slices=([1, 1], slice(None, None, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc302700>  parameter: {'shape': (2, 3), 'slices': ([1, 1], slice(None, None, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5d2190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_6_{shape=(2, 3), slices=([1, 0, 1], slice(None, None, None)), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdbbcf820>  parameter: {'shape': (2, 3), 'slices': ([1, 0, 1], slice(None, None, None)), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdbbcf580>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_7_{shape=(2, 3), slices=(slice(1, 2, None), [1, 0, 1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc3032b0>  parameter: {'shape': (2, 3), 'slices': (slice(1, 2, None), [1, 0, 1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc3038e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_8_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced4d35b0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4d3760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_9_{shape=(3, 4, 5), slices=(None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce5365f70>  parameter: {'shape': (3, 4, 5), 'slices': (None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced499f10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_10_{shape=(3, 4, 5), slices=(None, [1, -1], None), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce4f0fd00>  parameter: {'shape': (3, 4, 5), 'slices': (None, [1, -1], None), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0a08e688e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_11_{shape=(3, 4, 5), slices=(None, None, None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced434df0>  parameter: {'shape': (3, 4, 5), 'slices': (None, None, None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced434640>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_12_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc1ec310>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), None, [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc1ec7f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_13_{shape=(3, 4, 5), slices=(slice(0, 1, None), slice(1, 2, None), [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced44fa30>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), slice(1, 2, None), [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc28aa60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_14_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, slice(1, 2, None), [1, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda6b5e0>  parameter: {'shape': (3, 4, 5), 'slices': (slice(0, 1, None), None, slice(1, 2, None), [1, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ceda6b0d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_15_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=array([[[[ 0,  1,  2,  3,  4],\n         [ 5,  6,...1, 52, 53, 54],\n         [55, 56, 57, 58, 59]]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce52c2550>  parameter: {'shape': (...0, 41, 42, 43, 44],
         [45, 46, 47, 48, 49]],

        [[50, 51, 52, 53, 54],
         [55, 56, 57, 58, 59]]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce52c2310>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_16_{shape=(2, 3, 4), slices=([1, 0], [2, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5ed100>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 0], [2, 1]), 'value': array([[0, 1, 2, 3],
       [4, 5, 6, 7]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5ed280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_17_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [2, 1]), value=array([[0, 1, 2],\n       [3, 4, 5]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ce4f2e880>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 0], slice(None, None, None), [2, 1]), 'value': array([[0, 1, 2],
       [3, 4, 5]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ce4f2e3d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_18_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [[2, 0], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced48bd30>  parameter: {'shape': (...2, 0], [3, 1]]), 'value': array([[[ 0,  1,  2],
        [ 3,  4,  5]],

       [[ 6,  7,  8],
        [ 9, 10, 11]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced48b640>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_19_{shape=(1, 1, 2, 3, 4), slices=(None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced5c4a60>  parameter: {'shape': (1, 1, 2, 3, 4), 'slices': (None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced5c4550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_20_{shape=(2, 3, 4), slices=([1, 1], [1, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc2869d0>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1], [1, 1]), 'value': array([[0, 1, 2, 3],
       [4, 5, 6, 7]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc286d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_21_{shape=(2, 3, 4), slices=([1, 1], slice(None, None, None), [[2, 2], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced434af0>  parameter: {'shape': (...2, 2], [3, 1]]), 'value': array([[[ 0,  1,  2],
        [ 3,  4,  5]],

       [[ 6,  7,  8],
        [ 9, 10, 11]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc1b9070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_22_{shape=(2, 3, 4), slices=([1, 1], 1, [[2, 2], [3, 1]]), value=array([[0, 1],\n       [2, 3]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc1ec7c0>  parameter: {'shape': (2, 3, 4), 'slices': ([1, 1], 1, [[2, 2], [3, 1]]), 'value': array([[0, 1],
       [2, 3]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:943: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0a08c4ba30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 943, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a_interm, reduced_idx, value, li, ri, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_23_{shape=(3, 4, 5), slices=(array([[[ True, False,  True, False,  True],\n  ...\n        [ True,  True, False, False,  True]]]),), value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc346b20>  parameter: {'shape': (...se, False],
        [ True,  True,  True,  True,  True],
        [ True,  True, False, False,  True]]]),), 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:912: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_max_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc346b50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 912, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_max_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_24_{shape=(3, 4, 5), slices=(array([False, False,  True]),), value=array([[ 0,  1,  2,  3,  4],\n       [ 5,  6,  7,...0, 11, 12, 13, 14],\n       [15, 16, 17, 18, 19]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ceda6bb50>  parameter: {'shape': (... array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:912: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_max_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc330910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 912, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_max_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_25_{shape=(3, 4, 5), slices=(slice(None, None, None), array([ True, False, False,  True])), value=array([[[ 0,  1,  2,  3,  4],\n        [ 5,  6,  ... 21, 22, 23, 24],\n        [25, 26, 27, 28, 29]]])}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0cdc28a280>  parameter: {'shape': (... [[10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19]],

       [[20, 21, 22, 23, 24],
        [25, 26, 27, 28, 29]]])}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:930: in cupy._core._routines_indexing._scatter_op
    _scatter_op_mask_single(a, mask, value, mask_i, op)
cupy/_core/_routines_indexing.pyx:912: in cupy._core._routines_indexing._scatter_op_mask_single
    _scatter_max_mask_kernel(src, mask, mask_scanned, a)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0cdc28a1f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 930, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_mask_single(a, mask, value, mask_i, op)
E         File "cupy/_core/_routines_indexing.pyx", line 912, in cupy._core._routines_indexing._scatter_op_mask_single
E           _scatter_max_mask_kernel(src, mask, mask_scanned, a)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestScatterParametrized.test_scatter_max[_param_41_{shape=(2, 3, 4), slices=[1], value=1}] _

self = <<cupy_tests.core_tests.test_ndarray_scatter.TestScatterParametrized object at 0x7f0ced499dc0>  parameter: {'shape': (2, 3, 4), 'slices': [1], 'value': 1}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_dtypes([numpy.float32, numpy.int32, numpy.uint32,
                         numpy.uint64, numpy.ulonglong, numpy.float64])
    @testing.numpy_cupy_array_equal()
    def test_scatter_max(self, xp, dtype):
        a = xp.zeros(self.shape, dtype)
        if xp is cupy:
>           a.scatter_max(self.slices, self.value)

tests/cupy_tests/core_tests/test_ndarray_scatter.py:134: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1435: in cupy._core.core.ndarray.scatter_max
    _indexing._ndarray_scatter_max(self, slices, value)
cupy/_core/_routines_indexing.pyx:130: in cupy._core._routines_indexing._ndarray_scatter_max
    _scatter_op(self, slices, value, 'max')
cupy/_core/_routines_indexing.pyx:937: in cupy._core._routines_indexing._scatter_op
    _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
cupy/_core/_routines_indexing.pyx:873: in cupy._core._routines_indexing._scatter_op_single
    _scatter_max_kernel(
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f0ced4997f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/core_tests/test_ndarray_scatter.py", line 134, in test_scatter_max
E           a.scatter_max(self.slices, self.value)
E         File "cupy/_core/core.pyx", line 1435, in cupy._core.core.ndarray.scatter_max
E           _indexing._ndarray_scatter_max(self, slices, value)
E         File "cupy/_core/_routines_indexing.pyx", line 130, in cupy._core._routines_indexing._ndarray_scatter_max
E           _scatter_op(self, slices, value, 'max')
E         File "cupy/_core/_routines_indexing.pyx", line 937, in cupy._core._routines_indexing._scatter_op
E           _scatter_op_single(a, adv_slices[axis], value, axis, axis, op)
E         File "cupy/_core/_routines_indexing.pyx", line 873, in cupy._core._routines_indexing._scatter_op_single
E           _scatter_max_kernel(
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_________ TestConvolve_param_0_{mode='valid'}.test_convolve_diff_types _________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_1_{mode='same'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_2_{mode='full'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
________ TestCorrelate_param_0_{mode='valid'}.test_correlate_diff_types ________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_1_{mode='full'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_2_{mode='same'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
___________________________ TestRaw.test_atomic_add ____________________________

self = <cupyx_tests.jit_tests.test_raw.TestRaw testMethod=test_atomic_add>
dtype = <class 'numpy.float16'>

    @testing.for_dtypes('iILQefd')
    def test_atomic_add(self, dtype):
        @jit.rawkernel()
        def f(x, index, out):
            tid = jit.blockDim.x * jit.blockIdx.x + jit.threadIdx.x
            jit.atomic_add(out, index[tid], x[tid])
    
        x = testing.shaped_random((1024,), dtype=dtype, seed=0)
        index = testing.shaped_random(
            (1024,), dtype=numpy.bool_, seed=1).astype(numpy.int32)
        out = cupy.zeros((2,), dtype=dtype)
>       f((32,), (32,), (x, index, out))

tests/cupyx_tests/jit_tests/test_raw.py:146: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/jit/_interface.py:92: in __call__
    result = _compile.transpile(
cupyx/jit/_compile.py:85: in transpile
    cuda_code, env = _transpile_function(
cupyx/jit/_compile.py:175: in _transpile_function
    exc.reraise(source)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = _JitCompileError(TypeError('`atomicAdd` does not support float16 input.'), <_ast.Call object at 0x7f04d5f2f5b0>)
pycode = '  @jit.rawkernel()\n  def f(x, index, out):\n      tid = jit.blockDim.x * jit.blockIdx.x + jit.threadIdx.x\n>     jit.atomic_add(out, index[tid], x[tid])\n'

    def reraise(self, pycode):
        start = self.node.lineno
        end = getattr(self.node, 'end_lineno', start)
        pycode = '\n'.join([
            (f'> {line}' if start <= i + 1 <= end else f'  {line}').rstrip()
            for i, line in enumerate(pycode.split('\n'))])
>       raise self.error_type(self.mes + '\n\n' + pycode)
E       TypeError: `atomicAdd` does not support float16 input.
E       
E         @jit.rawkernel()
E         def f(x, index, out):
E             tid = jit.blockDim.x * jit.blockIdx.x + jit.threadIdx.x
E       >     jit.atomic_add(out, index[tid], x[tid])

cupyx/jit/_compile.py:42: TypeError
----------------------------- Captured stdout call -----------------------------
dtype is e
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f040193d130>  parameter: {'mode': 'grid-constant', 'order': 4}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([229.76997843, 598.96953239])
desired = array([3.06993892, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 590.96953239
E       Max relative difference: 73.87119155
E        x: array([229.769978, 598.969532])
E        y: array([3.069939, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f04014c13a0>  parameter: {'mode': 'grid-constant', 'order': 5}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([ 78.42728447, 201.97560613])
desired = array([3.12122783, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 193.97560613
E       Max relative difference: 24.24695077
E        x: array([ 78.427284, 201.975606])
E        y: array([3.121228, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8eee100>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8b7d2e0>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8b6ca60>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8b746d0>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_19_{grid_mode=False, mode='wrap', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8b7d9d0>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 1, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8b39820>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_20_{grid_mode=False, mode='wrap', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8606250>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 2, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f86066d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_21_{grid_mode=False, mode='wrap', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8521760>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 3, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8521b50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8765b20>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f87659d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84f28b0>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84f2370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_24_{grid_mode=False, mode='grid-wrap', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f85480a0>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 0, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8548880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_25_{grid_mode=False, mode='grid-wrap', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f86864f0>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 1, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f86869a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_26_{grid_mode=False, mode='grid-wrap', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8553610>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 2, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8553ac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_27_{grid_mode=False, mode='grid-wrap', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f83e7a30>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 3, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f83e7ee0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_28_{grid_mode=False, mode='grid-wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f861acd0>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f861a1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_29_{grid_mode=False, mode='grid-wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f83e1580>  parameter: {'grid_mode': False, 'mode': 'grid-wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f83e14c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_30_{grid_mode=False, mode='reflect', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84d9670>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 0, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84d9af0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_31_{grid_mode=False, mode='reflect', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84a44c0>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 1, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84a4820>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_32_{grid_mode=False, mode='reflect', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8622850>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 2, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8622d00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_33_{grid_mode=False, mode='reflect', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f849a0a0>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 3, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f849a130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_34_{grid_mode=False, mode='reflect', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84c0100>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84c0400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_35_{grid_mode=False, mode='reflect', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8af9160>  parameter: {'grid_mode': False, 'mode': 'reflect', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8af9910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_36_{grid_mode=False, mode='grid-mirror', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84c4880>  parameter: {'grid_mode': False, 'mode': 'grid-mirror', 'order': 0, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84c4d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_37_{grid_mode=False, mode='grid-mirror', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f861f9d0>  parameter: {'grid_mode': False, 'mode': 'grid-mirror', 'order': 1, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f861fe50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_38_{grid_mode=False, mode='grid-mirror', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f850bac0>  parameter: {'grid_mode': False, 'mode': 'grid-mirror', 'order': 2, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f850bf70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_39_{grid_mode=False, mode='grid-mirror', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8420b80>  parameter: {'grid_mode': False, 'mode': 'grid-mirror', 'order': 3, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8420280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8419550>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-1.6466675e-04],
        [-3.1765160e-06],
        [-2.8256103e-04],
        [ 1.0465207e-04],
        [-5.02...       [-1.4928388e-06],
        [-5.8970027e-06],
        [-2.4932410e-06],
        [-3.5395026e-06]]], dtype=float32)
desired = array([[[-8.12850668e-17],
        [-9.62678620e-17],
        [-7.64445911e-17],
        [ 6.90388762e-17],
        [-...   [-1.31306278e-18],
        [-2.34584224e-18],
        [-1.16198641e-18],
        [-3.16820747e-19]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 75 / 100 (75%)
E       Max absolute difference: 0.00034115
E       Max relative difference: 2.5044335e+14
E        x: array([[[-1.646668e-04],
E               [-3.176516e-06],
E               [-2.825610e-04],...
E        y: array([[[-8.128507e-17],
E               [-9.626786e-17],
E               [-7.644459e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f85302e0>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.46576144e-06],
        [-1.07652804e-05],
        [ 1.48250510e-05],
        [-2.88788979e-05],
        [-...   [ 3.59045725e-06],
        [ 3.90473633e-06],
        [ 2.02454498e-06],
        [ 1.08106917e-06]]], dtype=float32)
desired = array([[[-5.28892732e-17],
        [-4.68497761e-17],
        [-1.70810335e-16],
        [-1.91986781e-16],
        [-...   [-3.94138989e-18],
        [-8.65396191e-18],
        [ 1.07858407e-18],
        [-2.29544853e-18]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 40 / 100 (40%)
E       Max absolute difference: 0.00011814
E       Max relative difference: 9.6834375e+13
E        x: array([[[ 1.465761e-06],
E               [-1.076528e-05],
E               [ 1.482505e-05],...
E        y: array([[[-5.288927e-17],
E               [-4.684978e-17],
E               [-1.708103e-16],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f846b7c0>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.    ... [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[   0.      ],
E               [   0.      ],
E               [   0.      ],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f875e130>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84c4070>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  48.82195577],
        [  48.82195577],
        [ 290.39318135],
        [ 337.78017528],
        [ 112.1240... [ -53.24969236],
        [ -21.88859247],
        [  44.15090669],
        [  53.29762289],
        [  53.29762289]]])
desired = array([[[ 8.54663183e-03],
        [ 8.54663183e-03],
        [ 5.30645857e-02],
        [ 6.15797757e-02],
        [ ...126e-03],
        [-5.57818230e-04],
        [ 2.89445841e-04],
        [ 8.46143247e-05],
        [ 8.46143247e-05]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.88795612
E        x: array([[[  48.821956],
E               [  48.821956],
E               [ 290.393181],...
E        y: array([[[ 8.546632e-03],
E               [ 8.546632e-03],
E               [ 5.306459e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f852ed30>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.71685805e+00],
        [ 4.71685805e+00],
        [ 2.76221015e+01],
        [ 3.32433453e+01],
        [ ...958e+00],
        [-1.62349834e+00],
        [ 1.50933488e+01],
        [ 1.97919669e+01],
        [ 1.97919669e+01]]])
desired = array([[[ 8.60075856e-03],
        [ 8.60075856e-03],
        [ 5.25533883e-02],
        [ 6.23449044e-02],
        [ ...600e-03],
        [-8.00397905e-04],
        [ 4.16976616e-04],
        [ 1.32949066e-04],
        [ 1.32949066e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248854
E        x: array([[[ 4.716858e+00],
E               [ 4.716858e+00],
E               [ 2.762210e+01],...
E        y: array([[[ 8.600759e-03],
E               [ 8.600759e-03],
E               [ 5.255339e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f8398610>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  53.29762289],
        [  51.0107262 ],
        [ 303.41199632],
        [ 352.92342892],
        [ 117.1507... [ -50.96485228],
        [ -20.9493958 ],
        [  42.25647769],
        [  51.0107262 ],
        [  48.82195577]]])
desired = array([[[ 8.46143247e-05],
        [ 8.50392545e-04],
        [ 5.27994291e-03],
        [ 6.12720698e-03],
        [ ...636e-02],
        [-5.60619571e-03],
        [ 2.90899427e-03],
        [ 8.50392545e-04],
        [ 8.54663183e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[  53.297623],
E               [  51.010726],
E               [ 303.411996],...
E        y: array([[[ 8.461432e-05],
E               [ 8.503925e-04],
E               [ 5.279943e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f87193d0>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.97919669e+01],
        [ 9.66208561e+00],
        [ 5.65815436e+01],
        [ 6.80961870e+01],
        [ ...577e+00],
        [-7.92562963e-01],
        [ 7.36830399e+00],
        [ 9.66208561e+00],
        [ 4.71685805e+00]]])
desired = array([[[ 1.32949066e-04],
        [ 1.06932821e-03],
        [ 6.53393769e-03],
        [ 7.75131221e-03],
        [ ...718e-02],
        [-6.43771396e-03],
        [ 3.35380211e-03],
        [ 1.06932821e-03],
        [ 8.60075856e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 1.979197e+01],
E               [ 9.662086e+00],
E               [ 5.658154e+01],...
E        y: array([[[ 1.329491e-04],
E               [ 1.069328e-03],
E               [ 6.533938e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_86_{grid_mode=True, mode='grid-mirror', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f852ee50>  parameter: {'grid_mode': True, 'mode': 'grid-mirror', 'order': 2, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f85a2160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_87_{grid_mode=True, mode='grid-mirror', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f864fac0>  parameter: {'grid_mode': True, 'mode': 'grid-mirror', 'order': 3, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:718: in zoom
    filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
cupyx/scipy/ndimage/interpolation.py:245: in _filter_input
    filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
cupyx/scipy/ndimage/interpolation.py:179: in spline_filter
    spline_filter1d(x, order, axis, output=temp, mode=mode)
cupyx/scipy/ndimage/interpolation.py:143: in spline_filter1d
    kern(grid, block, (temp, info))
cupy/_core/raw.pyx:89: in cupy._core.raw.RawKernel.__call__
    self.kernel(
cupy/_core/raw.pyx:96: in cupy._core.raw.RawKernel.kernel.__get__
    return self._kernel()
cupy/_core/raw.pyx:113: in cupy._core.raw.RawKernel._kernel
    mod = _get_raw_module(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:1973: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f864ff70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 718, in zoom
E           filtered, nprepad = _filter_input(input, prefilter, mode, cval, order)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 245, in _filter_input
E           filtered = spline_filter(padded, order, output=float_dtype, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 179, in spline_filter
E           spline_filter1d(x, order, axis, output=temp, mode=mode)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 143, in spline_filter1d
E           kern(grid, block, (temp, info))
E         File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
E           self.kernel(
E         File "cupy/_core/raw.pyx", line 96, in cupy._core.raw.RawKernel.kernel.__get__
E           return self._kernel()
E         File "cupy/_core/raw.pyx", line 113, in cupy._core.raw.RawKernel._kernel
E           mod = _get_raw_module(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E           mod = cupy._core.core.compile_with_cache(
E         File "cupy/_core/core.pyx", line 1973, in cupy._core.core.compile_with_cache
E           cpdef function.Module compile_with_cache(
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_88_{grid_mode=True, mode='grid-mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84c7f10>  parameter: {'grid_mode': True, 'mode': 'grid-mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84c7280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_89_{grid_mode=True, mode='grid-mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84e11f0>  parameter: {'grid_mode': True, 'mode': 'grid-mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84e1520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_90_{grid_mode=True, mode='grid-constant', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f7dcc550>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 0, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_float_dtypes(no_float16=True)
    @testing.numpy_cupy_allclose(atol=1e-5, scipy_name='scp')
    @testing.with_requires('scipy>=1.6.0')
    def test_zoom_output_size1(self, xp, scp, dtype):
        x = xp.zeros(self.shape, dtype=dtype)
        x[1, 1, 1] = 1
>       return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
                                grid_mode=self.grid_mode)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:748: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/interpolation.py:727: in zoom
    kern(filtered, zoom, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7dcca60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py", line 748, in test_zoom_output_size1
E           return scp.ndimage.zoom(x, self.zoom, order=self.order, mode=self.mode,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/interpolation.py", line 727, in zoom
E           kern(filtered, zoom, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84b3460>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 5.63055219e+01],
        [-1.22528405e+02],
        [-3.83476709e+02],
        [-3.83476709e+02],
        [-...021e+00],
        [ 4.40535983e+00],
        [-2.69124172e+00],
        [-1.59183812e+00],
        [ 9.72456581e-01]]])
desired = array([[[ 1.27949283e-02],
        [-2.43606830e-02],
        [-7.91692940e-02],
        [-7.91692940e-02],
        [-...333e-03],
        [ 9.13158865e-04],
        [-5.54269262e-04],
        [-3.27391850e-04],
        [ 1.99955080e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2611.23242921
E       Max relative difference: 5747.85704324
E        x: array([[[ 5.630552e+01],
E               [-1.225284e+02],
E               [-3.834767e+02],...
E        y: array([[[ 1.279493e-02],
E               [-2.436068e-02],
E               [-7.916929e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f03f84102b0>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.16965077e+00],
        [-1.18699209e+01],
        [-3.36177788e+01],
        [-3.36177788e+01],
        [-...671e-01],
        [ 6.07624141e-01],
        [-3.96545295e-01],
        [-2.61764771e-01],
        [ 1.70742628e-01]]])
desired = array([[[ 1.44354197e-02],
        [-2.67893098e-02],
        [-8.45564959e-02],
        [-8.45564959e-02],
        [-...699e-03],
        [ 1.49724992e-03],
        [-9.55056276e-04],
        [-6.25982935e-04],
        [ 4.07383783e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 270.54779997
E       Max relative difference: 678.67662434
E        x: array([[[ 4.169651e+00],
E               [-1.186992e+01],
E               [-3.361778e+01],...
E        y: array([[[ 1.443542e-02],
E               [-2.678931e-02],
E               [-8.455650e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
________________ TestStats.test_single_dim[_param_0_{op='sum'}] ________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7589700>  parameter: {'op': 'sum'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.bool_'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:427: in sum_labels
    return _ndimage_sum_kernel_2(input, labels, index, out)
cupyx/scipy/ndimage/measurements.py:242: in _ndimage_sum_kernel_2
    sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
cupy/_sorting/search.py:211: in where
    return _where_ufunc(condition.astype('?'), x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f759a0a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 427, in sum_labels
E           return _ndimage_sum_kernel_2(input, labels, index, out)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 242, in _ndimage_sum_kernel_2
E           sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_sorting/search.py", line 211, in where
E           return _where_ufunc(condition.astype('?'), x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.bool_'>
_______________ TestStats.test_single_dim[_param_1_{op='mean'}] ________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f73a6430>  parameter: {'op': 'mean'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:520: in mean
    return _mean_driver(input, labels, index, use_kern=use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73a6d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 520, in mean
E           return _mean_driver(input, labels, index, use_kern=use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_____________ TestStats.test_single_dim[_param_2_{op='variance'}] ______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f74dd370>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74dd730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
________ TestStats.test_single_dim[_param_3_{op='standard_deviation'}] _________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7513760>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7513d90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
__________ TestStats.test_single_dim[_param_4_{op='center_of_mass'}] ___________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7257a00>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.bool_'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1055: in center_of_mass
    normalizer = sum(input, labels, index)
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:427: in sum_labels
    return _ndimage_sum_kernel_2(input, labels, index, out)
cupyx/scipy/ndimage/measurements.py:242: in _ndimage_sum_kernel_2
    sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
cupy/_sorting/search.py:211: in where
    return _where_ufunc(condition.astype('?'), x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7257d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1055, in center_of_mass
E           normalizer = sum(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 427, in sum_labels
E           return _ndimage_sum_kernel_2(input, labels, index, out)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 242, in _ndimage_sum_kernel_2
E           sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_sorting/search.py", line 211, in where
E           return _where_ufunc(condition.astype('?'), x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.bool_'>
____________ TestStats.test_single_dim[_param_5_{op='sum_labels'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f71bf400>  parameter: {'op': 'sum_labels'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.bool_'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_single_dim(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:136: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:427: in sum_labels
    return _ndimage_sum_kernel_2(input, labels, index, out)
cupyx/scipy/ndimage/measurements.py:242: in _ndimage_sum_kernel_2
    sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
cupy/_sorting/search.py:211: in where
    return _where_ufunc(condition.astype('?'), x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71bf9a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 136, in test_single_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 427, in sum_labels
E           return _ndimage_sum_kernel_2(input, labels, index, out)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 242, in _ndimage_sum_kernel_2
E           sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_sorting/search.py", line 211, in where
E           return _where_ufunc(condition.astype('?'), x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.bool_'>
________________ TestStats.test_multi_dim[_param_0_{op='sum'}] _________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7141550>  parameter: {'op': 'sum'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.bool_'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:427: in sum_labels
    return _ndimage_sum_kernel_2(input, labels, index, out)
cupyx/scipy/ndimage/measurements.py:242: in _ndimage_sum_kernel_2
    sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
cupy/_sorting/search.py:211: in where
    return _where_ufunc(condition.astype('?'), x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7141730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 427, in sum_labels
E           return _ndimage_sum_kernel_2(input, labels, index, out)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 242, in _ndimage_sum_kernel_2
E           sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_sorting/search.py", line 211, in where
E           return _where_ufunc(condition.astype('?'), x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.bool_'>
________________ TestStats.test_multi_dim[_param_1_{op='mean'}] ________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f716a580>  parameter: {'op': 'mean'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:520: in mean
    return _mean_driver(input, labels, index, use_kern=use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f716ad00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 520, in mean
E           return _mean_driver(input, labels, index, use_kern=use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
______________ TestStats.test_multi_dim[_param_2_{op='variance'}] ______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f74b0550>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b0b50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_________ TestStats.test_multi_dim[_param_3_{op='standard_deviation'}] _________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f73dd160>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73ddbe0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
___________ TestStats.test_multi_dim[_param_4_{op='center_of_mass'}] ___________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7286670>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1058: in center_of_mass
    results = [
cupyx/scipy/ndimage/measurements.py:1059: in <listcomp>
    sum(input * grids[dir].astype(float), labels, index) / normalizer
cupy/_core/core.pyx:1119: in cupy._core.core.ndarray.__mul__
    return _math._multiply(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7286eb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1058, in center_of_mass
E           results = [
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1059, in <listcomp>
E           sum(input * grids[dir].astype(float), labels, index) / normalizer
E         File "cupy/_core/core.pyx", line 1119, in cupy._core.core.ndarray.__mul__
E           return _math._multiply(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_____________ TestStats.test_multi_dim[_param_5_{op='sum_labels'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f71cc940>  parameter: {'op': 'sum_labels'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.bool_'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_multi_dim(self, xp, scp, dtype):
        image = self._make_image((8, 8, 8), xp, dtype)
        labels = testing.shaped_random((8, 8, 8), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:153: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:427: in sum_labels
    return _ndimage_sum_kernel_2(input, labels, index, out)
cupyx/scipy/ndimage/measurements.py:242: in _ndimage_sum_kernel_2
    sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
cupy/_sorting/search.py:211: in where
    return _where_ufunc(condition.astype('?'), x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71cceb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 153, in test_multi_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 427, in sum_labels
E           return _ndimage_sum_kernel_2(input, labels, index, out)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 242, in _ndimage_sum_kernel_2
E           sum_val[i:i + batch_size] = cupy.where(matched, input, 0).sum(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_sorting/search.py", line 211, in where
E           return _where_ufunc(condition.astype('?'), x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.bool_'>
_____________ TestStats.test_broadcast_labels[_param_0_{op='sum'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7136df0>  parameter: {'op': 'sum'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:412: in sum_labels
    return input[labels != 0].sum()
cupy/_core/core.pyx:1062: in cupy._core.core.ndarray.__richcmp__
    return numpy.not_equal(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71365e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 412, in sum_labels
E           return input[labels != 0].sum()
E         File "cupy/_core/core.pyx", line 1062, in cupy._core.core.ndarray.__richcmp__
E           return numpy.not_equal(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
____________ TestStats.test_broadcast_labels[_param_1_{op='mean'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f746ebb0>  parameter: {'op': 'mean'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:509: in mean
    return calc_mean_with_intermediate_float(input[labels > 0])
cupy/_core/core.pyx:1064: in cupy._core.core.ndarray.__richcmp__
    return numpy.greater(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f746e3a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 509, in mean
E           return calc_mean_with_intermediate_float(input[labels > 0])
E         File "cupy/_core/core.pyx", line 1064, in cupy._core.core.ndarray.__richcmp__
E           return numpy.greater(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
__________ TestStats.test_broadcast_labels[_param_2_{op='variance'}] ___________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f72a4cd0>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:344: in variance
    return calc_var_with_intermediate_float(input[labels > 0])
cupy/_core/core.pyx:1064: in cupy._core.core.ndarray.__richcmp__
    return numpy.greater(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72a44c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 344, in variance
E           return calc_var_with_intermediate_float(input[labels > 0])
E         File "cupy/_core/core.pyx", line 1064, in cupy._core.core.ndarray.__richcmp__
E           return numpy.greater(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_____ TestStats.test_broadcast_labels[_param_3_{op='standard_deviation'}] ______

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f71c78e0>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:344: in variance
    return calc_var_with_intermediate_float(input[labels > 0])
cupy/_core/core.pyx:1064: in cupy._core.core.ndarray.__richcmp__
    return numpy.greater(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71c7670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 344, in variance
E           return calc_var_with_intermediate_float(input[labels > 0])
E         File "cupy/_core/core.pyx", line 1064, in cupy._core.core.ndarray.__richcmp__
E           return numpy.greater(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_______ TestStats.test_broadcast_labels[_param_4_{op='center_of_mass'}] ________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f74b1100>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1055: in center_of_mass
    normalizer = sum(input, labels, index)
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:412: in sum_labels
    return input[labels != 0].sum()
cupy/_core/core.pyx:1062: in cupy._core.core.ndarray.__richcmp__
    return numpy.not_equal(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b1790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1055, in center_of_mass
E           normalizer = sum(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 412, in sum_labels
E           return input[labels != 0].sum()
E         File "cupy/_core/core.pyx", line 1062, in cupy._core.core.ndarray.__richcmp__
E           return numpy.not_equal(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_________ TestStats.test_broadcast_labels[_param_5_{op='sum_labels'}] __________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f73df130>  parameter: {'op': 'sum_labels'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:170: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:412: in sum_labels
    return input[labels != 0].sum()
cupy/_core/core.pyx:1062: in cupy._core.core.ndarray.__richcmp__
    return numpy.not_equal(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73dfa60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 170, in test_broadcast_labels
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 412, in sum_labels
E           return input[labels != 0].sum()
E         File "cupy/_core/core.pyx", line 1062, in cupy._core.core.ndarray.__richcmp__
E           return numpy.not_equal(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
____________ TestStats.test_broadcast_labels2[_param_0_{op='sum'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f714a5b0>  parameter: {'op': 'sum'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels2(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        index = 2
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:418: in sum_labels
    return (input[labels == index]).sum()
cupy/_core/core.pyx:1060: in cupy._core.core.ndarray.__richcmp__
    return numpy.equal(self, other)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f714ac10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 183, in test_broadcast_labels2
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 418, in sum_labels
E           return (input[labels == index]).sum()
E         File "cupy/_core/core.pyx", line 1060, in cupy._core.core.ndarray.__richcmp__
E           return numpy.equal(self, other)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
__________ TestStats.test_broadcast_labels2[_param_2_{op='variance'}] __________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7214250>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels2(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        index = 2
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:347: in variance
    return calc_var_with_intermediate_float(input[labels == index])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72147f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 183, in test_broadcast_labels2
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 347, in variance
E           return calc_var_with_intermediate_float(input[labels == index])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_____ TestStats.test_broadcast_labels2[_param_3_{op='standard_deviation'}] _____

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f72a28e0>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels2(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        index = 2
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:347: in variance
    return calc_var_with_intermediate_float(input[labels == index])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72a2be0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 183, in test_broadcast_labels2
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 347, in variance
E           return calc_var_with_intermediate_float(input[labels == index])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_______ TestStats.test_broadcast_labels2[_param_4_{op='center_of_mass'}] _______

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f713cb20>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_broadcast_labels2(self, xp, scp, dtype):
        # 1d label will be broadcast to 2d
        image = self._make_image((16, 6), xp, dtype)
        labels = xp.asarray([1, 0, 2, 2, 2, 0], dtype=xp.int32)
        index = 2
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:183: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1058: in center_of_mass
    results = [
cupyx/scipy/ndimage/measurements.py:1059: in <listcomp>
    sum(input * grids[dir].astype(float), labels, index) / normalizer
cupy/_core/core.pyx:1141: in cupy._core.core.ndarray.__truediv__
    return _math._true_divide(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f713c310>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 183, in test_broadcast_labels2
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1058, in center_of_mass
E           results = [
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1059, in <listcomp>
E           sum(input * grids[dir].astype(float), labels, index) / normalizer
E         File "cupy/_core/core.pyx", line 1141, in cupy._core.core.ndarray.__truediv__
E           return _math._true_divide(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_________________ TestStats.test_zero_dim[_param_0_{op='sum'}] _________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f73f3c70>  parameter: {'op': 'sum'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
                    op(image, labels, index)
            return xp.array([])
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:202: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:428: in sum_labels
    return _ndimage_sum_kernel(input, labels, index, index.size, out)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73f3340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 202, in test_zero_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 428, in sum_labels
E           return _ndimage_sum_kernel(input, labels, index, index.size, out)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
________________ TestStats.test_zero_dim[_param_1_{op='mean'}] _________________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f740f160>  parameter: {'op': 'mean'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
                    op(image, labels, index)
            return xp.array([])
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:202: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:520: in mean
    return _mean_driver(input, labels, index, use_kern=use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f740f460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 202, in test_zero_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 520, in mean
E           return _mean_driver(input, labels, index, use_kern=use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
______________ TestStats.test_zero_dim[_param_2_{op='variance'}] _______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f71d53d0>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
                    op(image, labels, index)
            return xp.array([])
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:202: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71d55b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 202, in test_zero_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_________ TestStats.test_zero_dim[_param_3_{op='standard_deviation'}] __________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7355130>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
                    op(image, labels, index)
            return xp.array([])
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:202: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:356: in variance
    mean_val, count = _mean_driver(input, labels, index, True, use_kern)
cupyx/scipy/ndimage/measurements.py:285: in _mean_driver
    sum, count = _ndimage_mean_kernel(input,
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7355940>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 202, in test_zero_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 356, in variance
E           mean_val, count = _mean_driver(input, labels, index, True, use_kern)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 285, in _mean_driver
E           sum, count = _ndimage_mean_kernel(input,
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
___________ TestStats.test_zero_dim[_param_4_{op='center_of_mass'}] ____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f70ce4c0>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
>                   op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:198: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1055: in center_of_mass
    normalizer = sum(input, labels, index)
cupyx/scipy/ndimage/measurements.py:453: in sum
    return sum_labels(input, labels, index)
cupyx/scipy/ndimage/measurements.py:428: in sum_labels
    return _ndimage_sum_kernel(input, labels, index, index.size, out)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70cebb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 198, in test_zero_dim
E           op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1055, in center_of_mass
E           normalizer = sum(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 453, in sum
E           return sum_labels(input, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 428, in sum_labels
E           return _ndimage_sum_kernel(input, labels, index, index.size, out)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_____________ TestStats.test_zero_dim[_param_5_{op='sum_labels'}] ______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7543610>  parameter: {'op': 'sum_labels'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_zero_dim(self, xp, scp, dtype):
        image = self._make_image((), xp, dtype)
        labels = testing.shaped_random((), xp, dtype=xp.int32, scale=4)
        index = xp.array([1, 2, 3])
        op = getattr(scp.ndimage, self.op)
        if self.op == 'center_of_mass':
            # SciPy doesn't handle 0-dimensional array input for center_of_mass
            with pytest.raises(IndexError):
                with warnings.catch_warnings():
                    warnings.simplefilter('ignore', _util.PerformanceWarning)
                    op(image, labels, index)
            return xp.array([])
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:202: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:428: in sum_labels
    return _ndimage_sum_kernel(input, labels, index, index.size, out)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7543130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 202, in test_zero_dim
E           result = op(image, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 428, in sum_labels
E           return _ndimage_sum_kernel(input, labels, index, index.size, out)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_____________ TestStats.test_only_input[_param_2_{op='variance'}] ______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f064ab3edc0>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_only_input(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:212: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:336: in variance
    return calc_var_with_intermediate_float(input)
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84e6220>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 212, in test_only_input
E           result = op(image)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 336, in variance
E           return calc_var_with_intermediate_float(input)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
________ TestStats.test_only_input[_param_3_{op='standard_deviation'}] _________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f720b160>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_only_input(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:212: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:336: in variance
    return calc_var_with_intermediate_float(input)
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f720bbb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 212, in test_only_input
E           result = op(image)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 336, in variance
E           return calc_var_with_intermediate_float(input)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
__________ TestStats.test_only_input[_param_4_{op='center_of_mass'}] ___________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f72d1190>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_only_input(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:212: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1058: in center_of_mass
    results = [
cupyx/scipy/ndimage/measurements.py:1059: in <listcomp>
    sum(input * grids[dir].astype(float), labels, index) / normalizer
cupy/_core/core.pyx:1141: in cupy._core.core.ndarray.__truediv__
    return _math._true_divide(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72d1ac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 212, in test_only_input
E           result = op(image)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1058, in center_of_mass
E           results = [
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1059, in <listcomp>
E           sum(input * grids[dir].astype(float), labels, index) / normalizer
E         File "cupy/_core/core.pyx", line 1141, in cupy._core.core.ndarray.__truediv__
E           return _math._true_divide(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
______________ TestStats.test_no_index[_param_2_{op='variance'}] _______________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7409070>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_no_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:223: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:344: in variance
    return calc_var_with_intermediate_float(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7409160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 223, in test_no_index
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 344, in variance
E           return calc_var_with_intermediate_float(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_________ TestStats.test_no_index[_param_3_{op='standard_deviation'}] __________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f7458d30>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_no_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:223: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:344: in variance
    return calc_var_with_intermediate_float(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74584f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 223, in test_no_index
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 344, in variance
E           return calc_var_with_intermediate_float(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
___________ TestStats.test_no_index[_param_4_{op='center_of_mass'}] ____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f735cc70>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_no_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:223: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1058: in center_of_mass
    results = [
cupyx/scipy/ndimage/measurements.py:1059: in <listcomp>
    sum(input * grids[dir].astype(float), labels, index) / normalizer
cupy/_core/core.pyx:1141: in cupy._core.core.ndarray.__truediv__
    return _math._true_divide(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f735c520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 223, in test_no_index
E           result = op(image, labels)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1058, in center_of_mass
E           results = [
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1059, in <listcomp>
E           sum(input * grids[dir].astype(float), labels, index) / normalizer
E         File "cupy/_core/core.pyx", line 1141, in cupy._core.core.ndarray.__truediv__
E           return _math._true_divide(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
____________ TestStats.test_scalar_index[_param_2_{op='variance'}] _____________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f71a6580>  parameter: {'op': 'variance'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_scalar_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, 1)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:234: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:347: in variance
    return calc_var_with_intermediate_float(input[labels == index])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71a6340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 234, in test_scalar_index
E           result = op(image, labels, 1)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 347, in variance
E           return calc_var_with_intermediate_float(input[labels == index])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_______ TestStats.test_scalar_index[_param_3_{op='standard_deviation'}] ________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f85cb3a0>  parameter: {'op': 'standard_deviation'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_scalar_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, 1)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:234: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:540: in standard_deviation
    return cupy.sqrt(variance(input, labels, index))
cupyx/scipy/ndimage/measurements.py:347: in variance
    return calc_var_with_intermediate_float(input[labels == index])
cupyx/scipy/ndimage/measurements.py:329: in calc_var_with_intermediate_float
    vals_c = input - input.mean()
cupy/_core/core.pyx:1111: in cupy._core.core.ndarray.__sub__
    return _math._subtract(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f85cb6a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 234, in test_scalar_index
E           result = op(image, labels, 1)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 540, in standard_deviation
E           return cupy.sqrt(variance(input, labels, index))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 347, in variance
E           return calc_var_with_intermediate_float(input[labels == index])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 329, in calc_var_with_intermediate_float
E           vals_c = input - input.mean()
E         File "cupy/_core/core.pyx", line 1111, in cupy._core.core.ndarray.__sub__
E           return _math._subtract(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_________ TestStats.test_scalar_index[_param_4_{op='center_of_mass'}] __________

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestStats object at 0x7f03f72d1f40>  parameter: {'op': 'center_of_mass'}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_scalar_index(self, xp, scp, dtype):
        image = self._make_image((100,), xp, dtype)
        labels = testing.shaped_random((100,), xp, dtype=xp.int32, scale=4)
        op = getattr(scp.ndimage, self.op)
        with warnings.catch_warnings():
            warnings.simplefilter('ignore', _util.PerformanceWarning)
>           result = op(image, labels, 1)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:234: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1058: in center_of_mass
    results = [
cupyx/scipy/ndimage/measurements.py:1059: in <listcomp>
    sum(input * grids[dir].astype(float), labels, index) / normalizer
cupy/_core/core.pyx:1141: in cupy._core.core.ndarray.__truediv__
    return _math._true_divide(x, y)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f724ed30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 234, in test_scalar_index
E           result = op(image, labels, 1)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1058, in center_of_mass
E           results = [
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1059, in <listcomp>
E           sum(input * grids[dir].astype(float), labels, index) / normalizer
E         File "cupy/_core/core.pyx", line 1141, in cupy._core.core.ndarray.__truediv__
E           return _math._true_divide(x, y)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_ TestMeasurementsSelect.test_measurements_select[_param_6_{enable_cub=True, index=None, labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74b0190>  parameter: {'enable_cub': True, 'index': None, 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03fe115d00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_8_{enable_cub=True, index=None, labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72e1340>  parameter: {'enable_cub': True, 'index': None, 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72e11c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_18_{enable_cub=True, index=None, labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73b8790>  parameter: {'enable_cub': True, 'index': None, 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f739fd30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_19_{enable_cub=True, index=None, labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f84100d0>  parameter: {'enable_cub': True, 'index': None, 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73a6d90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_20_{enable_cub=True, index=None, labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73ef3a0>  parameter: {'enable_cub': True, 'index': None, 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73efa30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_21_{enable_cub=True, index=None, labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f744d5b0>  parameter: {'enable_cub': True, 'index': None, 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f744d550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_30_{enable_cub=True, index=None, labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70ced90>  parameter: {'enable_cub': True, 'index': None, 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7127760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_31_{enable_cub=True, index=None, labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72cd400>  parameter: {'enable_cub': True, 'index': None, 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72cd2e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_32_{enable_cub=True, index=None, labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71d2f10>  parameter: {'enable_cub': True, 'index': None, 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71d2280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_33_{enable_cub=True, index=None, labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74dd340>  parameter: {'enable_cub': True, 'index': None, 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f712c940>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_42_{enable_cub=True, index=1, labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71868b0>  parameter: {'enable_cub': True, 'index': 1, 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7186e80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_44_{enable_cub=True, index=1, labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74c2f40>  parameter: {'enable_cub': True, 'index': 1, 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74c29d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_54_{enable_cub=True, index=1, labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71ed5b0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03fe35ed30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_55_{enable_cub=True, index=1, labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72ac0a0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72acc40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_56_{enable_cub=True, index=1, labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f752ad30>  parameter: {'enable_cub': True, 'index': 1, 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f739f100>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_57_{enable_cub=True, index=1, labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72be4c0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84b3b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_66_{enable_cub=True, index=1, labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f748c8b0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f748c760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_67_{enable_cub=True, index=1, labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7550310>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7550be0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_68_{enable_cub=True, index=1, labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fd33d0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6fd36a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_69_{enable_cub=True, index=1, labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7550370>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74f0550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_70_{enable_cub=True, index=1, labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70ef1c0>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70ef8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_71_{enable_cub=True, index=1, labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f3a550>  parameter: {'enable_cub': True, 'index': 1, 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f3ab50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_78_{enable_cub=True, index='all', labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f749c3d0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f711f880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_80_{enable_cub=True, index='all', labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72147c0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72149d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_84_{enable_cub=True, index='all', labels=5, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7050bb0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f720e970>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_85_{enable_cub=True, index='all', labels=5, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74e1280>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74e19a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_86_{enable_cub=True, index='all', labels=5, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f064aabeeb0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7190400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_87_{enable_cub=True, index='all', labels=5, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f6a250>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f6a910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_88_{enable_cub=True, index='all', labels=5, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74b30d0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b3190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_89_{enable_cub=True, index='all', labels=5, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74ed670>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71ccd30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_90_{enable_cub=True, index='all', labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71d2d60>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71d2a90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_91_{enable_cub=True, index='all', labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f6a490>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f6a8b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_92_{enable_cub=True, index='all', labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71d5cd0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71d5490>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_93_{enable_cub=True, index='all', labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f726e130>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f726ef10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_94_{enable_cub=True, index='all', labels=5, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7202730>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7202dc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_95_{enable_cub=True, index='all', labels=5, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72e5070>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 5, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72e5d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_96_{enable_cub=True, index='all', labels=50, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7034a60>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7034dc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_97_{enable_cub=True, index='all', labels=50, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7347550>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7347c40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_98_{enable_cub=True, index='all', labels=50, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73effd0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73ef910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_99_{enable_cub=True, index='all', labels=50, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7347df0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7462ca0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_100_{enable_cub=True, index='all', labels=50, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6efb5b0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6efbbe0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_101_{enable_cub=True, index='all', labels=50, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f740ed90>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f740e160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_102_{enable_cub=True, index='all', labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7027400>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70277f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_103_{enable_cub=True, index='all', labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72959d0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7295880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_104_{enable_cub=True, index='all', labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6edb4c0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6edb8b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_105_{enable_cub=True, index='all', labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72950d0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74621c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_106_{enable_cub=True, index='all', labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70200a0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70207c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_107_{enable_cub=True, index='all', labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fc31c0>  parameter: {'enable_cub': True, 'index': 'all', 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6fc35b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_114_{enable_cub=True, index='subset', labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6efbaf0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f749a1f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_116_{enable_cub=True, index='subset', labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7550ee0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7550940>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_120_{enable_cub=True, index='subset', labels=5, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72027c0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7355df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_121_{enable_cub=True, index='subset', labels=5, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f744d460>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f744d970>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_122_{enable_cub=True, index='subset', labels=5, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73bcdc0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73bcd00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_123_{enable_cub=True, index='subset', labels=5, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f713c310>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f713c1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_124_{enable_cub=True, index='subset', labels=5, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72e1bb0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72e1400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_125_{enable_cub=True, index='subset', labels=5, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73ee370>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f94ca0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_126_{enable_cub=True, index='subset', labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f064aa615b0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72ad1f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_127_{enable_cub=True, index='subset', labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f705d250>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f705dcd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_128_{enable_cub=True, index='subset', labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70bbc10>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70bb8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_129_{enable_cub=True, index='subset', labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fff970>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6fffb80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_130_{enable_cub=True, index='subset', labels=5, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74b3cd0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b3c40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_131_{enable_cub=True, index='subset', labels=5, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f5bb80>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 5, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f5bc40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_132_{enable_cub=True, index='subset', labels=50, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7104310>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7104820>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_133_{enable_cub=True, index='subset', labels=50, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73e45b0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73e4ee0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_134_{enable_cub=True, index='subset', labels=50, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72e16a0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f335e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_135_{enable_cub=True, index='subset', labels=50, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f94400>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f94790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_136_{enable_cub=True, index='subset', labels=50, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74e33d0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74e3370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_137_{enable_cub=True, index='subset', labels=50, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f719ac10>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:710: in _select
    return _select_via_looping(
cupyx/scipy/ndimage/measurements.py:595: in _select_via_looping
    label_idx = labels == i
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f704b580>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 710, in _select
E           return _select_via_looping(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 595, in _select_via_looping
E           label_idx = labels == i
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_138_{enable_cub=True, index='subset', labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f057f0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f05c70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_139_{enable_cub=True, index='subset', labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74edeb0>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74edf10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_140_{enable_cub=True, index='subset', labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f752a190>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71a61c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_141_{enable_cub=True, index='subset', labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6ec2a00>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ec2550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_142_{enable_cub=True, index='subset', labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70ca910>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70ca1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_143_{enable_cub=True, index='subset', labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71edb50>  parameter: {'enable_cub': True, 'index': 'subset', 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71ed040>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_150_{enable_cub=False, index=None, labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7027d30>  parameter: {'enable_cub': False, 'index': None, 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7027d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_152_{enable_cub=False, index=None, labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fd3370>  parameter: {'enable_cub': False, 'index': None, 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6fd3040>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_162_{enable_cub=False, index=None, labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f744d100>  parameter: {'enable_cub': False, 'index': None, 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84e6220>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_163_{enable_cub=False, index=None, labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72d7670>  parameter: {'enable_cub': False, 'index': None, 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72d7730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_164_{enable_cub=False, index=None, labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71f5940>  parameter: {'enable_cub': False, 'index': None, 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71f5880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_165_{enable_cub=False, index=None, labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f3a3d0>  parameter: {'enable_cub': False, 'index': None, 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72b03a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_174_{enable_cub=False, index=None, labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f721fd00>  parameter: {'enable_cub': False, 'index': None, 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f33a00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_175_{enable_cub=False, index=None, labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fada30>  parameter: {'enable_cub': False, 'index': None, 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f748c610>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_176_{enable_cub=False, index=None, labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f714a190>  parameter: {'enable_cub': False, 'index': None, 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74621f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_177_{enable_cub=False, index=None, labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70bb850>  parameter: {'enable_cub': False, 'index': None, 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:659: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70bb8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 659, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_186_{enable_cub=False, index=1, labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7106160>  parameter: {'enable_cub': False, 'index': 1, 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f33340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_188_{enable_cub=False, index=1, labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72a6b50>  parameter: {'enable_cub': False, 'index': 1, 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72a6af0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_198_{enable_cub=False, index=1, labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70589a0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f160a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_199_{enable_cub=False, index=1, labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70bb9a0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f064aa611f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_200_{enable_cub=False, index=1, labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e33190>  parameter: {'enable_cub': False, 'index': 1, 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e33df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_201_{enable_cub=False, index=1, labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f129a0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7060280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_210_{enable_cub=False, index=1, labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e789d0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f720b7c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_211_{enable_cub=False, index=1, labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e4fb50>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e4f190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_212_{enable_cub=False, index=1, labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e7a1f0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e7a9a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_213_{enable_cub=False, index=1, labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6fb94c0>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74589a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_214_{enable_cub=False, index=1, labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f711e160>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f711efa0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_215_{enable_cub=False, index=1, labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f711ff40>  parameter: {'enable_cub': False, 'index': 1, 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:666: in _select
    return single_group(input[mask], masked_positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f16310>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 666, in _select
E           return single_group(input[mask], masked_positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_222_{enable_cub=False, index='all', labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e38cd0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e38d00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_224_{enable_cub=False, index='all', labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7034310>  parameter: {'enable_cub': False, 'index': 'all', 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7462370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_228_{enable_cub=False, index='all', labels=5, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f722a1c0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7196e20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_229_{enable_cub=False, index='all', labels=5, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f752ca60>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72d71f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_230_{enable_cub=False, index='all', labels=5, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6d65070>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d659a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_231_{enable_cub=False, index='all', labels=5, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7034610>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6fb9d90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_232_{enable_cub=False, index='all', labels=5, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f064aa6e130>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7409b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_233_{enable_cub=False, index='all', labels=5, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f16b80>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f16e50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_234_{enable_cub=False, index='all', labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7173be0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7173bb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_235_{enable_cub=False, index='all', labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6dbad00>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6dba850>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_236_{enable_cub=False, index='all', labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7489e20>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d41310>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_237_{enable_cub=False, index='all', labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f70c40>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f704c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_238_{enable_cub=False, index='all', labels=5, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6eb29a0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6eb24c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_239_{enable_cub=False, index='all', labels=5, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f752c1c0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 5, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7027910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_240_{enable_cub=False, index='all', labels=50, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f064aa052b0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73dd460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_241_{enable_cub=False, index='all', labels=50, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f73bcc40>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73bc910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_242_{enable_cub=False, index='all', labels=50, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f711e280>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f711eca0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_243_{enable_cub=False, index='all', labels=50, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70cf670>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70cfe50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_244_{enable_cub=False, index='all', labels=50, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f704eee0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f704eb20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_245_{enable_cub=False, index='all', labels=50, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f706e070>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f706ee50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_246_{enable_cub=False, index='all', labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7043910>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72a6e80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_247_{enable_cub=False, index='all', labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71189d0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71181f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_248_{enable_cub=False, index='all', labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6f2e5e0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f2ea00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_249_{enable_cub=False, index='all', labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70acc40>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70ace50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_250_{enable_cub=False, index='all', labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e1b4c0>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e1b340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_251_{enable_cub=False, index='all', labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6ef5970>  parameter: {'enable_cub': False, 'index': 'all', 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ef5370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_258_{enable_cub=False, index='subset', labels=None, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f747cd30>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': None, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:643: in single_group
    result += [positions[vals == vals.max()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e33520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 643, in single_group
E           result += [positions[vals == vals.max()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_260_{enable_cub=False, index='subset', labels=None, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f720e400>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': None, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:649: in _select
    return single_group(input, positions)
cupyx/scipy/ndimage/measurements.py:639: in single_group
    result += [positions[vals == vals.min()][0]]
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d865e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 649, in _select
E           return single_group(input, positions)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 639, in single_group
E           result += [positions[vals == vals.min()][0]]
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestMeasurementsSelect.test_measurements_select[_param_264_{enable_cub=False, index='subset', labels=5, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6ffeee0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ffec40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_265_{enable_cub=False, index='subset', labels=5, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f743e610>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71c7a00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_266_{enable_cub=False, index='subset', labels=5, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6d4a4f0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d4a220>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_267_{enable_cub=False, index='subset', labels=5, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f726e8b0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70ef670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_268_{enable_cub=False, index='subset', labels=5, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f70cf1c0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70cf730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_269_{enable_cub=False, index='subset', labels=5, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6eaabe0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6eaa2b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_270_{enable_cub=False, index='subset', labels=5, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7106100>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f33d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_271_{enable_cub=False, index='subset', labels=5, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74edb80>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7030460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_272_{enable_cub=False, index='subset', labels=5, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74b3460>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b3490>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_273_{enable_cub=False, index='subset', labels=5, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6ca2dc0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ca2e80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_274_{enable_cub=False, index='subset', labels=5, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f71bbd60>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71bb850>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_275_{enable_cub=False, index='subset', labels=5, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6ef4ac0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 5, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ef43a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_276_{enable_cub=False, index='subset', labels=50, op='maximum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7347c70>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'maximum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7347e80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_277_{enable_cub=False, index='subset', labels=50, op='maximum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6eaa040>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'maximum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:827: in maximum
    return _select(input, labels, index, find_max=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6eaa880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 827, in maximum
E           return _select(input, labels, index, find_max=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_278_{enable_cub=False, index='subset', labels=50, op='median', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7239100>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'median', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f737d9d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_279_{enable_cub=False, index='subset', labels=50, op='median', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7426f40>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'median', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:855: in median
    return _select(input, labels, index, find_median=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7426d90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 855, in median
E           return _select(input, labels, index, find_median=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_280_{enable_cub=False, index='subset', labels=50, op='minimum', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f7027910>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'minimum', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6de9910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_281_{enable_cub=False, index='subset', labels=50, op='minimum', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6d21f40>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'minimum', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:799: in minimum
    return _select(input, labels, index, find_min=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d21a30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 799, in minimum
E           return _select(input, labels, index, find_min=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_282_{enable_cub=False, index='subset', labels=50, op='maximum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f74b3ac0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'maximum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74b3580>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_283_{enable_cub=False, index='subset', labels=50, op='maximum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f064aa051f0>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'maximum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:958: in maximum_position
    result = _select(input, labels, index, find_max_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7043c40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 958, in maximum_position
E           result = _select(input, labels, index, find_max_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_284_{enable_cub=False, index='subset', labels=50, op='minimum_position', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6d8a130>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'minimum_position', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d8adf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_285_{enable_cub=False, index='subset', labels=50, op='minimum_position', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f72acb50>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'minimum_position', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:901: in minimum_position
    result = _select(input, labels, index, find_min_positions=True)[0]
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f064ab1df40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 901, in minimum_position
E           result = _select(input, labels, index, find_min_positions=True)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_286_{enable_cub=False, index='subset', labels=50, op='extrema', shape=(512,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f6e7a550>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'extrema', 'shape': (512,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e7ad30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMeasurementsSelect.test_measurements_select[_param_287_{enable_cub=False, index='subset', labels=50, op='extrema', shape=(32, 64)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestMeasurementsSelect object at 0x7f03f709a160>  parameter: {'enable_cub': False, 'index': 'subset', 'labels': 50, 'op': 'extrema', 'shape': (32, 64)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True, no_bool=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_measurements_select(self, xp, scp, dtype):
        self._hip_skip_invalid_condition()
    
        shape = self.shape
        rstate = numpy.random.RandomState(0)
        # scale must be small enough to avoid potential integer overflow due to
        # https://github.com/scipy/scipy/issues/12836
        x = testing.shaped_random(shape, xp=xp, dtype=dtype, scale=32)
        non_unique = xp.unique(x).size < x.size
    
        if (self.op in ['minimum_position', 'maximum_position'] and
                non_unique and self.index is not None):
            # skip cases with non-unique min or max position
            return xp.array([])
    
        if self.labels is None:
            labels = self.labels
        else:
            labels = rstate.choice(self.labels, x.size).reshape(shape) + 1
            labels = xp.asarray(labels)
        if self.index is None or isinstance(self.index, int):
            index = self.index
        elif self.index == 'all':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)
            else:
                index = None
        elif self.index == 'subset':
            if self.labels is not None:
                index = xp.arange(1, self.labels + 1, dtype=cupy.intp)[1::2]
            else:
                index = None
        func = getattr(scp.ndimage, self.op)
>       result = func(x, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:358: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1002: in extrema
    minimums, min_positions, maximums, max_positions = _select(
cupyx/scipy/ndimage/measurements.py:723: in _select
    cupy.arange(1, max_label + 2))
cupy/_creation/ranges.py:43: in arange
    size = int(numpy.ceil((stop - start) / step))
cupy/_core/core.pyx:1115: in cupy._core.core.ndarray.__sub__
    return numpy.subtract(x, y)
cupy/_core/core.pyx:1499: in cupy._core.core.ndarray.__array_ufunc__
    return cp_ufunc(*inputs, **kwargs)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f709a3d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 358, in test_measurements_select
E           result = func(x, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1002, in extrema
E           minimums, min_positions, maximums, max_positions = _select(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 723, in _select
E           cupy.arange(1, max_label + 2))
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_creation/ranges.py", line 43, in arange
E           size = int(numpy.ceil((stop - start) / step))
E         File "cupy/_core/core.pyx", line 1115, in cupy._core.core.ndarray.__sub__
E           return numpy.subtract(x, y)
E         File "cupy/_core/core.pyx", line 1499, in cupy._core.core.ndarray.__array_ufunc__
E           return cp_ufunc(*inputs, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_0_{index=None, labels=None, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6e21f70>  parameter: {'index': None, 'labels': None, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1118: in labeled_comprehension
    return func(input.ravel())
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e21d60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1118, in labeled_comprehension
E           return func(input.ravel())
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_1_{index=None, labels=None, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f72d1310>  parameter: {'index': None, 'labels': None, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1118: in labeled_comprehension
    return func(input.ravel())
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d55d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1118, in labeled_comprehension
E           return func(input.ravel())
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_2_{index=None, labels=4, shape=(200,)}] __

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f735c0d0>  parameter: {'index': None, 'labels': 4, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1132: in labeled_comprehension
    return func(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71bbd90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1132, in labeled_comprehension
E           return func(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_3_{index=None, labels=4, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f740a130>  parameter: {'index': None, 'labels': 4, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1132: in labeled_comprehension
    return func(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f740aeb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1132, in labeled_comprehension
E           return func(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_4_{index=None, labels=6, shape=(200,)}] __

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6bb4c70>  parameter: {'index': None, 'labels': 6, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1132: in labeled_comprehension
    return func(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bb4070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1132, in labeled_comprehension
E           return func(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_5_{index=None, labels=6, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f7003be0>  parameter: {'index': None, 'labels': 6, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float32'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1132: in labeled_comprehension
    return func(input[labels > 0])
cupyx/scipy/ndimage/measurements.py:1234: in _hist
    return cupy.histogram(vals, _bins)[0]
cupy/_statistics/histogram.py:254: in histogram
    _histogram_kernel(x, bin_edges, bin_edges.size, y)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f754d790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1132, in labeled_comprehension
E           return func(input[labels > 0])
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1234, in _hist
E           return cupy.histogram(vals, _bins)[0]
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/_statistics/histogram.py", line 254, in histogram
E           _histogram_kernel(x, bin_edges, bin_edges.size, y)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestHistogram.test_histogram[_param_8_{index=[0, 2], labels=4, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f72d7790>  parameter: {'index': [0, 2], 'labels': 4, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72d7280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_9_{index=[0, 2], labels=4, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f7396520>  parameter: {'index': [0, 2], 'labels': 4, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73964f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_10_{index=[0, 2], labels=6, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6c70850>  parameter: {'index': [0, 2], 'labels': 6, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6daf250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_11_{index=[0, 2], labels=6, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f71c7eb0>  parameter: {'index': [0, 2], 'labels': 6, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f713c340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_14_{index=[3, 1, 0], labels=4, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6d8a4c0>  parameter: {'index': [3, 1, 0], 'labels': 4, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d8a910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_15_{index=[3, 1, 0], labels=4, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f7332280>  parameter: {'index': [3, 1, 0], 'labels': 4, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7543d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_16_{index=[3, 1, 0], labels=6, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6e31550>  parameter: {'index': [3, 1, 0], 'labels': 6, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e31f40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_17_{index=[3, 1, 0], labels=6, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6e44f40>  parameter: {'index': [3, 1, 0], 'labels': 6, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e442e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_20_{index=[1], labels=4, shape=(200,)}] __

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f71a6af0>  parameter: {'index': [1], 'labels': 4, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71a6550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_21_{index=[1], labels=4, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f7058dc0>  parameter: {'index': [1], 'labels': 4, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f708e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_22_{index=[1], labels=6, shape=(200,)}] __

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6e387f0>  parameter: {'index': [1], 'labels': 6, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e38760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHistogram.test_histogram[_param_23_{index=[1], labels=6, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestHistogram object at 0x7f03f6ce9730>  parameter: {'index': [1], 'labels': 6, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True)
    @testing.numpy_cupy_allclose(scipy_name='scp')
    def test_histogram(self, xp, scp, dtype):
        nbins = 5
        minval = 0
        maxval = 10
        image = self._make_image(self.shape, xp, dtype, scale=maxval)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=self.labels)
        if index is not None:
            index = xp.array(index)
        op = getattr(scp.ndimage, 'histogram')
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, minval, maxval, nbins, labels, index)
            return xp.asarray([])
>       result = op(image, minval, maxval, nbins, labels, index)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:404: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1236: in histogram
    return labeled_comprehension(
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ce9850>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 404, in test_histogram
E           result = op(image, minval, maxval, nbins, labels, index)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1236, in histogram
E           return labeled_comprehension(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_12_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f746a280>  paramete...'default': 0, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7489b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_13_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f713edc0>  paramete...efault': 0, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f713e8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_14_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f712deb0>  paramete...default': 0, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73ccac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_15_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e87280>  paramete...fault': 0, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e879a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_20_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f7426be0>  paramete...fault': 0, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f064aa104f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_21_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f71fac70>  paramete...ult': 0, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e4f100>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_22_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6ea1a30>  paramete...ault': 0, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ea17c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_23_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e8eca0>  paramete...lt': 0, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e8eee0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_28_{default=0, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f741b820>  parameter: {'default': 0, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f740ef40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_29_{default=0, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f7550a60>  parameter: {'default': 0, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6baddc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_30_{default=0, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f70297c0>  parameter: {'default': 0, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7029a30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_31_{default=0, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e873d0>  paramete...'default': 0, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e87d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_44_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e31c10>  parameter: {'default': 0, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c70cd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_45_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f7017f10>  parameter: {'default': 0, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73af5e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_46_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e44550>  parameter: {'default': 0, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e440a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_47_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f749cc10>  parameter: {'default': 0, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bcc6d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_52_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6c70760>  parameter: {'default': 0, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f748c040>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_53_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f72cd100>  parameter: {'default': 0, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c0c7c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_54_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6d2eca0>  parameter: {'default': 0, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d2e970>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_55_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e1b490>  parameter: {'default': 0, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e1b370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_60_{default=0, dtype='same', index=[1], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6d9f2b0>  parameter: {'default': 0, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d9f250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_61_{default=0, dtype='same', index=[1], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6f62070>  parameter: {'default': 0, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f62250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_62_{default=0, dtype='same', index=[1], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6d7d970>  parameter: {'default': 0, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d7d8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_63_{default=0, dtype='same', index=[1], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6d9c880>  parameter: {'default': 0, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d9cdf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_76_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f724e640>  paramete...'default': 3, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73f32e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_77_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f71d5b80>  paramete...efault': 3, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d97be0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_78_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6f53700>  paramete...default': 3, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f717e520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_79_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6eb1700>  paramete...fault': 3, 'dtype': <class 'numpy.float64'>, 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6eb13a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_84_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6cd4610>  paramete...fault': 3, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f713c5b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_85_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6db16a0>  paramete...ult': 3, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6db1520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_86_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f064aa357f0>  paramete...ault': 3, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d7d8b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_87_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f72a67c0>  paramete...lt': 3, 'dtype': <class 'numpy.float64'>, 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72a6550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_92_{default=3, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6b18820>  parameter: {'default': 3, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b18370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_93_{default=3, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f7003490>  parameter: {'default': 3, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c47a30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_94_{default=3, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f7190d00>  parameter: {'default': 3, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f739fa30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_95_{default=3, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6e3b640>  paramete...'default': 3, 'dtype': <class 'numpy.float64'>, 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e3b430>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_108_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6f2e730>  parameter: {'default': 3, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73ee460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_109_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f70ef700>  parameter: {'default': 3, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6de9700>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_110_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6ca2520>  parameter: {'default': 3, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ca2e50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_111_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f70cfd30>  parameter: {'default': 3, 'dtype': 'same', 'index': [0, 2], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f737f550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_116_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6f2ecd0>  parameter: {'default': 3, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b105e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_117_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f75153d0>  parameter: {'default': 3, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6dd8be0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_118_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f064a9c2c70>  parameter: {'default': 3, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d6c1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_119_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6fce580>  parameter: {'default': 3, 'dtype': 'same', 'index': [3, 1, 0], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e786d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_124_{default=3, dtype='same', index=[1], labels=4, pass_positions=True, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6fcee80>  parameter: {'default': 3, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d2eaf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_125_{default=3, dtype='same', index=[1], labels=4, pass_positions=True, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f71a6760>  parameter: {'default': 3, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': True, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1193: in labeled_comprehension
    do_map([input, positions], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d15880>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1193, in labeled_comprehension
E           do_map([input, positions], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_126_{default=3, dtype='same', index=[1], labels=4, pass_positions=False, shape=(200,)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f6d99100>  parameter: {'default': 3, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (200,)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1150: in labeled_comprehension
    mask = (labels >= lo) & (labels <= hi)
cupy/_core/core.pyx:1051: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_greater_equal(self, other)
cupy/_core/_routines_logic.pyx:20: in cupy._core._routines_logic._ndarray_greater_equal
    return _greater_equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d99910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1150, in labeled_comprehension
E           mask = (labels >= lo) & (labels <= hi)
E         File "cupy/_core/core.pyx", line 1051, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_greater_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 20, in cupy._core._routines_logic._ndarray_greater_equal
E           return _greater_equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestLabeledComprehension.test_labeled_comprehension[_param_127_{default=3, dtype='same', index=[1], labels=4, pass_positions=False, shape=(16, 20)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_measurements.TestLabeledComprehension object at 0x7f03f72a4c40>  parameter: {'default': 3, 'dtype': 'same', 'index': [1], 'labels': 4, 'pass_positions': False, 'shape': (16, 20)}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_bool=True, no_complex=True, no_float16=True)
    @testing.numpy_cupy_allclose(scipy_name='scp', rtol=1e-4, atol=1e-4)
    def test_labeled_comprehension(self, xp, scp, dtype):
        image = self._make_image(self.shape, xp, dtype, scale=101)
        labels = self.labels
        index = self.index
        if labels is not None:
            labels = testing.shaped_random(self.shape, xp, dtype=xp.int32,
                                           scale=4)
        if index is not None:
            index = xp.array(index)
    
        if self.pass_positions:
            # simple function that takes a positions argument
            def func(x, pos):
                return xp.sum(x + pos > 50)
        else:
            # simple function to apply to each lable
            func = xp.sum
    
        op = getattr(scp.ndimage, 'labeled_comprehension')
        dtype == image.dtype if self.dtype == 'same' else self.dtype
        if index is not None and labels is None:
            # cannot give an index array without labels
            with pytest.raises(ValueError):
                op(image, labels, index, func, dtype, self.default,
                   self.pass_positions)
            return xp.asarray([])
>       return op(image, labels, index, func, dtype, self.default,
                  self.pass_positions)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py:457: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/measurements.py:1191: in labeled_comprehension
    do_map([input], temp)
cupyx/scipy/ndimage/measurements.py:1178: in do_map
    if low == high:
cupy/_core/core.pyx:1045: in cupy._core.core.ndarray.__richcmp__
    return _logic._ndarray_equal(self, other)
cupy/_core/_routines_logic.pyx:32: in cupy._core._routines_logic._ndarray_equal
    return _equal(self, other)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f70207f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py", line 457, in test_labeled_comprehension
E           return op(image, labels, index, func, dtype, self.default,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1191, in labeled_comprehension
E           do_map([input], temp)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/measurements.py", line 1178, in do_map
E           if low == high:
E         File "cupy/_core/core.pyx", line 1045, in cupy._core.core.ndarray.__richcmp__
E           return _logic._ndarray_equal(self, other)
E         File "cupy/_core/_routines_logic.pyx", line 32, in cupy._core._routines_logic._ndarray_equal
E           return _equal(self, other)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_________________ TestIterateStructure.test_iterate_structure1 _________________

self = <cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestIterateStructure object at 0x7f03f6b7b400>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_iterate_structure1(self, xp, scp):
        struct = xp.asarray([[0, 1, 0],
                             [1, 1, 1],
                             [0, 1, 0]])
>       return scp.ndimage.iterate_structure(struct, 2)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:44: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/morphology.py:113: in iterate_structure
    out = binary_dilation(out, structure, iterations=ni)
cupyx/scipy/ndimage/morphology.py:358: in binary_dilation
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:167: in _binary_erosion
    structure = structure.astype(dtype=bool, copy=False)
cupy/_core/core.pyx:401: in cupy._core.core.ndarray.astype
    cpdef ndarray astype(
cupy/_core/core.pyx:470: in cupy._core.core.ndarray.astype
    elementwise_copy(self, newarray)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b7bb50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 44, in test_iterate_structure1
E           return scp.ndimage.iterate_structure(struct, 2)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 113, in iterate_structure
E           out = binary_dilation(out, structure, iterations=ni)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 358, in binary_dilation
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 167, in _binary_erosion
E           structure = structure.astype(dtype=bool, copy=False)
E         File "cupy/_core/core.pyx", line 401, in cupy._core.core.ndarray.astype
E           cpdef ndarray astype(
E         File "cupy/_core/core.pyx", line 470, in cupy._core.core.ndarray.astype
E           elementwise_copy(self, newarray)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_________________ TestIterateStructure.test_iterate_structure2 _________________

self = <cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestIterateStructure object at 0x7f03f6ab01c0>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_iterate_structure2(self, xp, scp):
        struct = xp.asarray([[0, 1],
                             [1, 1],
                             [0, 1]])
>       return scp.ndimage.iterate_structure(struct, 2)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:51: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/morphology.py:113: in iterate_structure
    out = binary_dilation(out, structure, iterations=ni)
cupyx/scipy/ndimage/morphology.py:358: in binary_dilation
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:167: in _binary_erosion
    structure = structure.astype(dtype=bool, copy=False)
cupy/_core/core.pyx:401: in cupy._core.core.ndarray.astype
    cpdef ndarray astype(
cupy/_core/core.pyx:470: in cupy._core.core.ndarray.astype
    elementwise_copy(self, newarray)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ab0130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 51, in test_iterate_structure2
E           return scp.ndimage.iterate_structure(struct, 2)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 113, in iterate_structure
E           out = binary_dilation(out, structure, iterations=ni)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 358, in binary_dilation
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 167, in _binary_erosion
E           structure = structure.astype(dtype=bool, copy=False)
E         File "cupy/_core/core.pyx", line 401, in cupy._core.core.ndarray.astype
E           cpdef ndarray astype(
E         File "cupy/_core/core.pyx", line 470, in cupy._core.core.ndarray.astype
E           elementwise_copy(self, newarray)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_________________ TestIterateStructure.test_iterate_structure3 _________________

self = <cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestIterateStructure object at 0x7f03f6b3ed90>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_iterate_structure3(self, xp, scp):
        struct = xp.asarray([[0, 1, 0],
                             [1, 1, 1],
                             [0, 1, 0]])
>       out, origin = scp.ndimage.iterate_structure(struct, 2, 1)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:58: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/ndimage/morphology.py:113: in iterate_structure
    out = binary_dilation(out, structure, iterations=ni)
cupyx/scipy/ndimage/morphology.py:358: in binary_dilation
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:167: in _binary_erosion
    structure = structure.astype(dtype=bool, copy=False)
cupy/_core/core.pyx:401: in cupy._core.core.ndarray.astype
    cpdef ndarray astype(
cupy/_core/core.pyx:470: in cupy._core.core.ndarray.astype
    elementwise_copy(self, newarray)
cupy/_core/_kernel.pyx:1185: in cupy._core._kernel.ufunc.__call__
    kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
cupy/_core/_kernel.pyx:1212: in cupy._core._kernel.ufunc._get_ufunc_kernel
    kern = _get_ufunc_kernel(
cupy/_core/_kernel.pyx:952: in cupy._core._kernel._get_ufunc_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b3e400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 58, in test_iterate_structure3
E           out, origin = scp.ndimage.iterate_structure(struct, 2, 1)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 113, in iterate_structure
E           out = binary_dilation(out, structure, iterations=ni)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 358, in binary_dilation
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 167, in _binary_erosion
E           structure = structure.astype(dtype=bool, copy=False)
E         File "cupy/_core/core.pyx", line 401, in cupy._core.core.ndarray.astype
E           cpdef ndarray astype(
E         File "cupy/_core/core.pyx", line 470, in cupy._core.core.ndarray.astype
E           elementwise_copy(self, newarray)
E         File "cupy/_core/_kernel.pyx", line 1185, in cupy._core._kernel.ufunc.__call__
E           kern = self._get_ufunc_kernel(dev_id, op, arginfos, has_where)
E         File "cupy/_core/_kernel.pyx", line 1212, in cupy._core._kernel.ufunc._get_ufunc_kernel
E           kern = _get_ufunc_kernel(
E         File "cupy/_core/_kernel.pyx", line 952, in cupy._core._kernel._get_ufunc_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_360_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c34970>  para... 1, 1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e256d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_361_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c794f0>  para..., 1, 1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c79dc0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_362_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f84b3520>  para... 1, 1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f714aac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_363_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e025b0>  para..., 1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e02700>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_364_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f70203a0>  para..., 1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d86df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_365_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b07670>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b07400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_366_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6be1670>  para...1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6be13a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_367_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f73af5e0>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e96e50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_368_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e0e340>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e0e1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_369_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6adf6a0>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6adf400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_370_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f75438e0>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f75438b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_371_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f85cb220>  para...1], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f85cb460>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_372_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6ab46d0>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ab49d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_373_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6ca2880>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ca2130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_374_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e970d0>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e502b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_375_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c72730>  para...binary_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c72b50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_376_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6fad400>  para...'binary_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f33e20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_377_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7196ac0>  para...binary_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7196b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_379_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f70b50>  para...nary_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f707f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_380_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f16ac0>  para...y_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7347730>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_381_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c0d4c0>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c0d0a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_382_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6cacd60>  para...y_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6cac2e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_384_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c78790>  para...erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c78370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_385_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e2b280>  para...y_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e2bf70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_386_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f740f580>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d2e2b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_387_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e618b0>  para...y_erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e618e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_389_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b47bb0>  para...erosion', 'origin': -1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b47430>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_390_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f71d2f40>  para...: 'binary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73bccd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_392_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e449d0>  para...: 'binary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d990d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_393_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d86490>  para...'binary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d865b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_394_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6ef5f40>  para...'binary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ef51c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_395_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6dba790>  para...nary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6dba400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_397_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f695e7f0>  para...nary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f695e1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_398_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f85cd0>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6be1ac0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_399_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d3ae20>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d3a6d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_400_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6cbf520>  para...nary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6cc8370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_402_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f064a0ce130>  para...nary_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84b3220>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_403_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f064a999d90>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c47670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_404_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e4ffd0>  para...ry_erosion', 'origin': -1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e4f550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_405_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d4aa00>  para... 1], 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f84b3490>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_406_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6a6a9a0>  para..., 1], 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e4fee0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_407_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6afaf10>  para... 1], 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6afae20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_408_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f71ab460>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71ab550>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_409_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7050100>  para...], 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f752c1f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_410_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e9f880>  para...'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e9f8e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_411_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c87070>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c87df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_412_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b7b190>  para...'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b7bfa0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_413_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6adde50>  para...ilter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6add190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_414_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c35310>  para...ilter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c35610>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_415_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f71edc10>  para...'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f71ed520>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_416_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f72c70>  para... 'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f72190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_417_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6de90d0>  para...'filter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6de9790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_418_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f71a6430>  para...ilter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68f8a90>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_419_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7239b50>  para...ilter': 'binary_erosion', 'origin': -1, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7497790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_420_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69a19a0>  para..., 1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69a1c40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_421_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f72ac370>  para...0, 1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f064a0f2670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_422_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69d94c0>  para..., 1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69d9f40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_423_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6bccc70>  para...1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bccfd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_424_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7184520>  para...1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7184340>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_425_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c5fa60>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c5ffd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_426_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f74915e0>  para... 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7491610>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_427_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f04670>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d8a2e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_428_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f73b8af0>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73b8b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_429_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6941ee0>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6941790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_430_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b898e0>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b891c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_431_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d0a160>  para... 1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c18370>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_432_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f693d730>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f693d910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_433_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f74ce8e0>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f74ce280>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_434_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6dfb190>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6dfb5e0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_435_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6895b20>  para...'binary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6895d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_436_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e7dc40>  para... 'binary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e7df10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_437_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f691d8e0>  para...'binary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f691d850>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_439_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f70a90>  para...inary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f70040>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_440_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6cc82b0>  para...ry_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6cc89a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_441_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d06760>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d06f10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_442_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f064a0e67f0>  para...ry_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f064a0e6130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_444_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6956850>  para..._erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69569a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_445_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c47700>  para...ry_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6a6a250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_446_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6881b80>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68815b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_447_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e87130>  para...ry_erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e87a00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_449_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6beb8e0>  para..._erosion', 'origin': 0, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68caf40>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_450_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68d0d90>  para...': 'binary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68d0b20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_452_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e38730>  para...': 'binary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e38d30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_453_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69214f0>  para... 'binary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6921bb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_454_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f85cb0a0>  para... 'binary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f85cbe20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_455_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69c7d60>  para...inary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69c7670>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_457_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e442e0>  para...inary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e443d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_458_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f717e790>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f717e1f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_459_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f16ee0>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e8efd0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_460_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f709a100>  para...inary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f709a910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_462_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b0d580>  para...inary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f67f80a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_463_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68f36d0>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68f36a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_464_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f692ba30>  para...ary_erosion', 'origin': 0, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f692b100>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_465_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d8e9a0>  para..., 1], 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68d0790>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_466_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6fcedc0>  para...1, 1], 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bc1400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_467_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6902880>  para..., 1], 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6902e20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_468_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6af2700>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68d0070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_469_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f72ac790>  para...1], 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6895e20>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_470_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e12070>  para... 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e121c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_471_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68fe1c0>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68fe070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_472_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f73b8bb0>  para... 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ea1190>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_473_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68f4dc0>  para...filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68f4130>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_474_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f70603d0>  para...filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f676cd60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_475_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7491250>  para... 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7491400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_476_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6bc0a90>  para..., 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bc06d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_477_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7535490>  para... 'filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7535c10>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_478_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6bdcb20>  para...filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6bdcb50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_479_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f70507f0>  para...filter': 'binary_erosion', 'origin': 0, 'output': 'array', 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7050400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_480_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f74b0070>  para..., 1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7056e50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_481_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7122190>  para...0, 1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f739f580>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_482_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6a6a280>  para..., 1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6a6a160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_483_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b7b4f0>  para...1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b7bee0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_484_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6903370>  para...1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6903610>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_485_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6893310>  para...1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6893250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_486_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d99e20>  para... 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d990a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_487_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68851f0>  para...1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6885df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_488_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6868b20>  para..., 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6868970>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_489_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6a03f70>  para..., 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6a03400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_490_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b35790>  para...1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b35700>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_491_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6b49a30>  para... 1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6b493a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_492_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f693d400>  para...1], 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f8410a60>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_493_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f698e430>  para..., 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f698e2b0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_494_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7122640>  para..., 'filter': 'binary_erosion', 'origin': 1, 'output': None, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ea13a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_495_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f709a430>  para...'binary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f709a7c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_496_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f73afd90>  para... 'binary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f73afd30>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_497_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6cac070>  para...'binary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6cac4f0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_499_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f691bc40>  para...inary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f691b640>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_500_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f68ce070>  para...ry_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f68ce1c0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_501_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f5b910>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f5b0d0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_502_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6f3ac40>  para...ry_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6f3adf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_504_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6a6da60>  para..._erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6a6d070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_505_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7202880>  para...ry_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7202df0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_506_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6c5f7c0>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6c5f400>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_507_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e9fb50>  para...ry_erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e9f250>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_509_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6e61160>  para..._erosion', 'origin': 1, 'output': <class 'numpy.float32'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6e61b80>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_510_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7196970>  para...': 'binary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7196430>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_512_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f73768e0>  para...': 'binary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7376760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_513_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d7dd60>  para... 'binary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6d7d160>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_514_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6889910>  para... 'binary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': None, 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6889760>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_515_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f672f7f0>  para...inary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f672fb50>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_517_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69a18e0>  para...inary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69a1be0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_518_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f717e1c0>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f667edf0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_519_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6ac83a0>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 0, 1], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6ac8580>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_520_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6d20dc0>  para...inary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7202f70>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_522_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f69a1580>  para...inary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f69a1070>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_523_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=float32}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6eb18e0>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float32'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6767910>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_524_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=float64}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f6885eb0>  para...ary_erosion', 'origin': 1, 'output': <class 'numpy.int8'>, 'structure': [1, 1, 0], 'x_dtype': <class 'numpy.float64'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:89: in _filter
    return filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f6885970>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 89, in _filter
E           return filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_525_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=bool_}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f7056dc0>  para..., 1], 'filter': 'binary_erosion', 'origin': 1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.bool_'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f693dd00>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_526_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=int8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f064a949cd0>  para...1, 1], 'filter': 'binary_erosion', 'origin': 1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.int8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f72570a0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestBinaryErosionAndDilation1d.test_binary_erosion_and_dilation_1d[_param_527_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=uint8}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_morphology.TestBinaryErosionAndDilation1d object at 0x7f03f692b8b0>  para..., 1], 'filter': 'binary_erosion', 'origin': 1, 'output': 'array', 'structure': None, 'x_dtype': <class 'numpy.uint8'>}>
xp = <module 'cupy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/__init__.py'>
scp = <module 'cupyx.scipy' from '/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/__init__.py'>

    @testing.numpy_cupy_array_equal(scipy_name='scp')
    def test_binary_erosion_and_dilation_1d(self, xp, scp):
        if self.x_dtype == self.output:
            pytest.skip('redundant')
        x = xp.asarray(self.data, dtype=self.x_dtype)
>       return self._filter(xp, scp, x)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:98: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py:85: in _filter
    filter(x, structure, iterations=1, mask=None,
cupyx/scipy/ndimage/morphology.py:307: in binary_erosion
    return _binary_erosion(input, structure, iterations, mask, output,
cupyx/scipy/ndimage/morphology.py:227: in _binary_erosion
    output = erode_kernel(input, structure, output)
cupy/_core/_kernel.pyx:850: in cupy._core._kernel.ElementwiseKernel.__call__
    kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
cupy/_core/_kernel.pyx:875: in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
    kern = _get_elementwise_kernel(
cupy/_util.pyx:59: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_kernel.pyx:662: in cupy._core._kernel._get_elementwise_kernel
    return _get_simple_elementwise_kernel(
cupy/_core/_kernel.pyx:62: in cupy._core._kernel._get_simple_elementwise_kernel
    module = compile_with_cache(module_code, options)
cupy/_core/core.pyx:2042: in cupy._core.core.compile_with_cache
    return cuda.compile_with_cache(
cupy/cuda/compiler.py:456: in compile_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:874: in _compile_with_cache_hip
    temp_path = tf.name
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tempfile._TemporaryFileWrapper object at 0x7f03f7257eb0>, exc = None
value = None, tb = None

    def __exit__(self, exc, value, tb):
>       result = self.file.__exit__(exc, value, tb)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 98, in test_binary_erosion_and_dilation_1d
E           return self._filter(xp, scp, x)
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py", line 85, in _filter
E           filter(x, structure, iterations=1, mask=None,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 307, in binary_erosion
E           return _binary_erosion(input, structure, iterations, mask, output,
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupyx/scipy/ndimage/morphology.py", line 227, in _binary_erosion
E           output = erode_kernel(input, structure, output)
E         File "cupy/_core/_kernel.pyx", line 850, in cupy._core._kernel.ElementwiseKernel.__call__
E           kern = self._get_elementwise_kernel(dev_id, arginfos, type_map)
E         File "cupy/_core/_kernel.pyx", line 875, in cupy._core._kernel.ElementwiseKernel._get_elementwise_kernel
E           kern = _get_elementwise_kernel(
E         File "cupy/_util.pyx", line 59, in cupy._util.memoize.decorator.ret
E           result = f(*args, **kwargs)
E         File "cupy/_core/_kernel.pyx", line 662, in cupy._core._kernel._get_elementwise_kernel
E           return _get_simple_elementwise_kernel(
E         File "cupy/_core/_kernel.pyx", line 62, in cupy._core._kernel._get_simple_elementwise_kernel
E           module = compile_with_cache(module_code, options)
E         File "cupy/_core/core.pyx", line 2042, in cupy._core.core.compile_with_cache
E           return cuda.compile_with_cache(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 456, in compile_with_cache
E           return _compile_with_cache_hip(
E         File "/global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/cupy/cuda/compiler.py", line 874, in _compile_with_cache_hip
E           temp_path = tf.name
E         File "/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py", line 491, in __exit__
E           result = self.file.__exit__(exc, value, tb)
E       OSError: [Errno 28] No space left on device

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/tempfile.py:491: AssertionError
_ TestFFTConvolve.test_convolve_fft[_param_12_{mode='full', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f03ea487790>  parameter: {'mode': 'full', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float16'>}, dtype = <class 'numpy.float16'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[-1.6748e-01,  1.1859e+01, -1.2731e+02, -1.7312e+02,
         -1.4500e+02, -1.3275e+02, -9.6250e+01, -1.5875e+...672e+01, -1.0879e+00, -1.8297e+01,
         -5.0898e+00, -1.6219e+01, -7.9062e+00,  7.8242e+00]]],
      dtype=float16)
y = array([[[ 30.12 ,  78.5  , 117.3  , 116.1  ,  98.56 ,  98.6  ,  95.75 ,
         119.1  , 143.   , 143.6  ,  85.5  ,  ... ,  68.8  ,  60.4  ,  38.7  ,  61.03 ,  47.47 ,
          68.94 ,  60.25 ,  72.94 ,  56.97 ,   9.93 ]]], dtype=float16)
func = <function assert_array_compare.<locals>.<lambda> at 0x7f03f6d82310>
hasval = '+inf'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=0.001, atol=0.001
E           
E           x and y +inf location mismatch:
E            x: array([[[-1.6748e-01,  1.1859e+01, -1.2731e+02, -1.7312e+02,
E                    -1.4500e+02, -1.3275e+02, -9.6250e+01, -1.5875e+02,
E                    -9.4562e+01, -2.1100e+02, -2.4238e+02, -9.9812e+01],...
E            y: array([[[ 30.12 ,  78.5  , 117.3  , 116.1  ,  98.56 ,  98.6  ,  95.75 ,
E                    119.1  , 143.   , 143.6  ,  85.5  ,  23.11 ],
E                   [ 73.4  , 147.9  , 215.4  , 224.8  , 189.5  , 154.   ,  90.2  ,...

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float16'>
_ TestFFTConvolve.test_convolve_fft[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f03e9efb100>  parameter: {'mode': 'valid', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 736.59918049, 1030.44086599, -237.40000711,  700.2293108 ,
          808.2306715 , 1688.01579117, 1182.41398...9, 1769.2147835 ,  102.14641712,   63.6837677 ,
         -481.33726756, 1028.54630664,  871.75403147,  779.59842176]]])
desired = array([[[800.51063884, 862.97485863, 683.19938084, 644.7455668 ,
         573.72374126, 714.88524965, 728.84981796, 80...74148182, 920.51448428, 785.24073245, 688.98377411,
         587.26448895, 719.43755651, 815.77499972, 851.23709194]]])
rtol = 1e-08, atol = 1e-08, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-08, atol=1e-08
E       
E       Mismatched elements: 16 / 16 (100%)
E       Max absolute difference: 1068.60175651
E       Max relative difference: 1.81962604
E        x: array([[[ 736.59918 , 1030.440866, -237.400007,  700.229311,
E                 808.230672, 1688.015791, 1182.413981,  758.287133],
E               [ 772.658921, 1769.214784,  102.146417,   63.683768,
E                -481.337268, 1028.546307,  871.754031,  779.598422]]])
E        y: array([[[800.510639, 862.974859, 683.199381, 644.745567, 573.723741,
E                714.88525 , 728.849818, 808.565173],
E               [879.741482, 920.514484, 785.240732, 688.983774, 587.264489,
E                719.437557, 815.775   , 851.237092]]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
=============================== warnings summary ===============================
tests/cupy_tests/core_tests/fusion_tests/test_array.py: 1 warning
tests/cupy_tests/math_tests/test_sumprod.py: 19 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: overflow encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/core_tests/fusion_tests/test_routines.py::TestFusionNumericalReduction_param_1_{func='prod'}::test_reduction
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: overflow encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_0_{type_l='poly1d', type_r='ndarray'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_3_{type_l='ndarray', type_r='ndarray'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_array
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in multiply
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in half_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in byte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in short_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ubyte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ushort_scalars
    y = y * x + p[i]

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in power
    absx **= ord

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in reciprocal
    absx **= ord

tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf
tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf_nan
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/numeric.py:2276: RuntimeWarning: overflow encountered in absolute
    return less_equal(abs(x-y), atol + rtol * abs(y))

tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all_transposed2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axis_transposed2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes4
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_2_{op='variance'}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_3_{op='standard_deviation'}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:47: RuntimeWarning: overflow encountered in reduce
    return umr_sum(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/math_tests/test_sumprod.py: 15 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: invalid value encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: invalid value encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/math_tests/test_sumprod.py: 32 warnings
  /global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/math_tests/test_sumprod.py:803: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/statistics_tests/test_meanvar.py: 32 warnings
  /global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupy_tests/statistics_tests/test_meanvar.py:113: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_4_{axis=0, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_5_{axis=0, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_6_{axis=0, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_7_{axis=0, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_8_{axis=1, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_9_{axis=1, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_10_{axis=1, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_11_{axis=1, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/nanfunctions.py:1113: RuntimeWarning: All-NaN slice encountered
    r, k = function_base._ureduce(a, func=_nanmedian, axis=axis, out=out,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_3_{func='mean', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_5_{func='mean', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
    return _methods._mean(a, axis=axis, dtype=dtype,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:168: RuntimeWarning: invalid value encountered in true_divide
    ret = arr.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_9_{func='std', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_11_{func='std', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:233: RuntimeWarning: Degrees of freedom <= 0 for slice
    ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:194: RuntimeWarning: invalid value encountered in true_divide
    arrmean = um.true_divide(

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_15_{func='var', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_17_{func='var', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3621: RuntimeWarning: Degrees of freedom <= 0 for slice
    return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_217_{cval=nan, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_220_{cval=nan, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_223_{cval=nan, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_226_{cval=inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_229_{cval=inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_232_{cval=inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_235_{cval=-inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_238_{cval=-inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_241_{cval=-inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
  /global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:533: RuntimeWarning: invalid value encountered in remainder
    float_out = self._shift(xp, scp, a.astype(xp.float64)) % 1

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_1_{op='mean'}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:684: RuntimeWarning: invalid value encountered in true_divide
    return sum / numpy.asanyarray(count).astype(numpy.float64)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_2_{op='variance'}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_3_{op='standard_deviation'}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:736: RuntimeWarning: invalid value encountered in true_divide
    return sum_c_sq / np.asanyarray(count).astype(float)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_0_{im=(10,), mysize=3, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_1_{im=(10,), mysize=3, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_2_{im=(10,), mysize=4, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_3_{im=(10,), mysize=4, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: divide by zero encountered in true_divide
    res *= (1 - noise / lVar)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_0_{im=(10,), mysize=3, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_1_{im=(10,), mysize=3, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_2_{im=(10,), mysize=4, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_3_{im=(10,), mysize=4, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: invalid value encountered in multiply
    res *= (1 - noise / lVar)

-- Docs: https://docs.pytest.org/en/stable/warnings.html
- generated html file: file:///global/scratch/kmaeh/cupy-rocm-ci-work/tmp.fT9jvmvnl2/cupy/_output/report.html -
=========================== short test summary info ============================
FAILED tests/cupy_tests/core_tests/test_ndarray_copy_and_view.py::TestArrayCopyAndView::test_astype_boolean_view
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_add_array_boolarray
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_iadd_array_boolarray
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmax_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmax_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmax_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmax_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmax_nan_imag
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmin_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmin_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmin_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmin_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_argmin_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_all_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_multiple_axes
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_multiple_axes_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_nan
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_nan_imag
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_max_nan_real
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_all_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_multiple_axes
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_multiple_axes_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_nan
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_nan_imag
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_min_nan_real
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_all_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_multiple_axes
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_multiple_axes_keepdims
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_nan
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_nan_imag
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_0_{order='C'}::test_ptp_nan_real
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_axis1
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_axis2
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_axis_large
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_nan_imag
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmax_nan_real
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmin_all
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestArrayReduction_param_1_{order='F'}::test_argmin_axis0
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_9_{backend='block', order='C', shape=(10, 20)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)}::test_cub_max
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_10_{backend='block', order='C', shape=(10, 20, 30)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)}::test_cub_max
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_11_{backend='block', order='C', shape=(10, 20, 30, 40)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_13_{backend='block', order='F', shape=(10, 20)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)}::test_cub_max
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_14_{backend='block', order='F', shape=(10, 20, 30)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)}::test_cub_max
FAILED tests/cupy_tests/core_tests/test_ndarray_reduction.py::TestCubReduction_param_15_{backend='block', order='F', shape=(10, 20, 30, 40)}::test_cub_min
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_0_{shape=(2, 3, 4), slices=array(-1), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_1_{shape=(2, 3, 4), slices=array([1, 0]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_2_{shape=(2, 3, 4), slices=(slice(None, None, None), [1, 2]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_3_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_4_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_5_{shape=(2, 3), slices=([1, 1], slice(None, None, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_6_{shape=(2, 3), slices=([1, 0, 1], slice(None, None, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_7_{shape=(2, 3), slices=(slice(1, 2, None), [1, 0, 1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_8_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_9_{shape=(3, 4, 5), slices=(None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_10_{shape=(3, 4, 5), slices=(None, [1, -1], None), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_11_{shape=(3, 4, 5), slices=(None, None, None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_12_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_13_{shape=(3, 4, 5), slices=(slice(0, 1, None), slice(1, 2, None), [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_14_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, slice(1, 2, None), [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_15_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=array([[[[ 0,  1,  2,  3,  4],\n         [ 5,  6,...1, 52, 53, 54],\n         [55, 56, 57, 58, 59]]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_16_{shape=(2, 3, 4), slices=([1, 0], [2, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_17_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [2, 1]), value=array([[0, 1, 2],\n       [3, 4, 5]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_18_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [[2, 0], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_19_{shape=(1, 1, 2, 3, 4), slices=(None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_20_{shape=(2, 3, 4), slices=([1, 1], [1, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_21_{shape=(2, 3, 4), slices=([1, 1], slice(None, None, None), [[2, 2], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_22_{shape=(2, 3, 4), slices=([1, 1], 1, [[2, 2], [3, 1]]), value=array([[0, 1],\n       [2, 3]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_23_{shape=(3, 4, 5), slices=(array([[[ True, False,  True, False,  True],\n  ...\n        [ True,  True, False, False,  True]]]),), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_24_{shape=(3, 4, 5), slices=(array([False, False,  True]),), value=array([[ 0,  1,  2,  3,  4],\n       [ 5,  6,  7,...0, 11, 12, 13, 14],\n       [15, 16, 17, 18, 19]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_25_{shape=(3, 4, 5), slices=(slice(None, None, None), array([ True, False, False,  True])), value=array([[[ 0,  1,  2,  3,  4],\n        [ 5,  6,  ... 21, 22, 23, 24],\n        [25, 26, 27, 28, 29]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_41_{shape=(2, 3, 4), slices=[1], value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_42_{shape=(2, 3, 4), slices=[1, 1], value=array([[[ 0,  1,  2,  3],\n        [ 4,  5,  6,  ...    [16, 17, 18, 19],\n        [20, 21, 22, 23]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_43_{shape=(2, 3, 4), slices=([1],), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_44_{shape=(2, 3, 4), slices=([1, 1],), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_45_{shape=(2, 3, 4), slices=([1], [1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_46_{shape=(2, 3, 4), slices=([1, 1], 1), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_47_{shape=(2, 3, 4), slices=([1], slice(1, 2, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_add[_param_48_{shape=(2, 3, 4), slices=([[1]], slice(1, 2, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_0_{shape=(2, 3, 4), slices=array(-1), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_1_{shape=(2, 3, 4), slices=array([1, 0]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_2_{shape=(2, 3, 4), slices=(slice(None, None, None), [1, 2]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_3_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_4_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(None, None, None), [[1, 2], [0, 3]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_5_{shape=(2, 3), slices=([1, 1], slice(None, None, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_6_{shape=(2, 3), slices=([1, 0, 1], slice(None, None, None)), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_7_{shape=(2, 3), slices=(slice(1, 2, None), [1, 0, 1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_8_{shape=(3, 4, 5), slices=(slice(None, None, None), slice(1, 2, None), [[1, 3], [0, 2]]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_9_{shape=(3, 4, 5), slices=(None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_10_{shape=(3, 4, 5), slices=(None, [1, -1], None), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_11_{shape=(3, 4, 5), slices=(None, None, None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_12_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_13_{shape=(3, 4, 5), slices=(slice(0, 1, None), slice(1, 2, None), [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_14_{shape=(3, 4, 5), slices=(slice(0, 1, None), None, slice(1, 2, None), [1, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_15_{shape=(3, 4, 5), slices=(slice(None, None, None), [[1, 2], [0, -1]]), value=array([[[[ 0,  1,  2,  3,  4],\n         [ 5,  6,...1, 52, 53, 54],\n         [55, 56, 57, 58, 59]]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_16_{shape=(2, 3, 4), slices=([1, 0], [2, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_17_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [2, 1]), value=array([[0, 1, 2],\n       [3, 4, 5]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_18_{shape=(2, 3, 4), slices=([1, 0], slice(None, None, None), [[2, 0], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_19_{shape=(1, 1, 2, 3, 4), slices=(None, slice(None, None, None), 0, [1, 0], slice(0, 2, 2), [2, -1]), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_20_{shape=(2, 3, 4), slices=([1, 1], [1, 1]), value=array([[0, 1, 2, 3],\n       [4, 5, 6, 7]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_21_{shape=(2, 3, 4), slices=([1, 1], slice(None, None, None), [[2, 2], [3, 1]]), value=array([[[ 0,  1,  2],\n        [ 3,  4,  5]],\n\n       [[ 6,  7,  8],\n        [ 9, 10, 11]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_22_{shape=(2, 3, 4), slices=([1, 1], 1, [[2, 2], [3, 1]]), value=array([[0, 1],\n       [2, 3]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_23_{shape=(3, 4, 5), slices=(array([[[ True, False,  True, False,  True],\n  ...\n        [ True,  True, False, False,  True]]]),), value=1}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_24_{shape=(3, 4, 5), slices=(array([False, False,  True]),), value=array([[ 0,  1,  2,  3,  4],\n       [ 5,  6,  7,...0, 11, 12, 13, 14],\n       [15, 16, 17, 18, 19]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_25_{shape=(3, 4, 5), slices=(slice(None, None, None), array([ True, False, False,  True])), value=array([[[ 0,  1,  2,  3,  4],\n        [ 5,  6,  ... 21, 22, 23, 24],\n        [25, 26, 27, 28, 29]]])}]
FAILED tests/cupy_tests/core_tests/test_ndarray_scatter.py::TestScatterParametrized::test_scatter_max[_param_41_{shape=(2, 3, 4), slices=[1], value=1}]
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_0_{mode='valid'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_1_{mode='same'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_2_{mode='full'}::test_convolve_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_0_{mode='valid'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_1_{mode='full'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_2_{mode='same'}::test_correlate_diff_types
FAILED tests/cupyx_tests/jit_tests/test_raw.py::TestRaw::test_atomic_add - Ty...
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_19_{grid_mode=False, mode='wrap', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_20_{grid_mode=False, mode='wrap', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_21_{grid_mode=False, mode='wrap', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_24_{grid_mode=False, mode='grid-wrap', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_25_{grid_mode=False, mode='grid-wrap', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_26_{grid_mode=False, mode='grid-wrap', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_27_{grid_mode=False, mode='grid-wrap', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_28_{grid_mode=False, mode='grid-wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_29_{grid_mode=False, mode='grid-wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_30_{grid_mode=False, mode='reflect', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_31_{grid_mode=False, mode='reflect', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_32_{grid_mode=False, mode='reflect', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_33_{grid_mode=False, mode='reflect', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_34_{grid_mode=False, mode='reflect', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_35_{grid_mode=False, mode='reflect', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_36_{grid_mode=False, mode='grid-mirror', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_37_{grid_mode=False, mode='grid-mirror', order=1, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_38_{grid_mode=False, mode='grid-mirror', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_39_{grid_mode=False, mode='grid-mirror', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_86_{grid_mode=True, mode='grid-mirror', order=2, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_87_{grid_mode=True, mode='grid-mirror', order=3, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_88_{grid_mode=True, mode='grid-mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_89_{grid_mode=True, mode='grid-mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_90_{grid_mode=True, mode='grid-constant', order=0, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_0_{op='sum'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_1_{op='mean'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_single_dim[_param_5_{op='sum_labels'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_0_{op='sum'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_1_{op='mean'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_multi_dim[_param_5_{op='sum_labels'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_0_{op='sum'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_1_{op='mean'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels[_param_5_{op='sum_labels'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels2[_param_0_{op='sum'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels2[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels2[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_broadcast_labels2[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_0_{op='sum'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_1_{op='mean'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_zero_dim[_param_5_{op='sum_labels'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_no_index[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_no_index[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_no_index[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_scalar_index[_param_2_{op='variance'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_scalar_index[_param_3_{op='standard_deviation'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_scalar_index[_param_4_{op='center_of_mass'}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_6_{enable_cub=True, index=None, labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_8_{enable_cub=True, index=None, labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_18_{enable_cub=True, index=None, labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_19_{enable_cub=True, index=None, labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_20_{enable_cub=True, index=None, labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_21_{enable_cub=True, index=None, labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_30_{enable_cub=True, index=None, labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_31_{enable_cub=True, index=None, labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_32_{enable_cub=True, index=None, labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_33_{enable_cub=True, index=None, labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_42_{enable_cub=True, index=1, labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_44_{enable_cub=True, index=1, labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_54_{enable_cub=True, index=1, labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_55_{enable_cub=True, index=1, labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_56_{enable_cub=True, index=1, labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_57_{enable_cub=True, index=1, labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_66_{enable_cub=True, index=1, labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_67_{enable_cub=True, index=1, labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_68_{enable_cub=True, index=1, labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_69_{enable_cub=True, index=1, labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_70_{enable_cub=True, index=1, labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_71_{enable_cub=True, index=1, labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_78_{enable_cub=True, index='all', labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_80_{enable_cub=True, index='all', labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_84_{enable_cub=True, index='all', labels=5, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_85_{enable_cub=True, index='all', labels=5, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_86_{enable_cub=True, index='all', labels=5, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_87_{enable_cub=True, index='all', labels=5, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_88_{enable_cub=True, index='all', labels=5, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_89_{enable_cub=True, index='all', labels=5, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_90_{enable_cub=True, index='all', labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_91_{enable_cub=True, index='all', labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_92_{enable_cub=True, index='all', labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_93_{enable_cub=True, index='all', labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_94_{enable_cub=True, index='all', labels=5, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_95_{enable_cub=True, index='all', labels=5, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_96_{enable_cub=True, index='all', labels=50, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_97_{enable_cub=True, index='all', labels=50, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_98_{enable_cub=True, index='all', labels=50, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_99_{enable_cub=True, index='all', labels=50, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_100_{enable_cub=True, index='all', labels=50, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_101_{enable_cub=True, index='all', labels=50, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_102_{enable_cub=True, index='all', labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_103_{enable_cub=True, index='all', labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_104_{enable_cub=True, index='all', labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_105_{enable_cub=True, index='all', labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_106_{enable_cub=True, index='all', labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_107_{enable_cub=True, index='all', labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_114_{enable_cub=True, index='subset', labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_116_{enable_cub=True, index='subset', labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_120_{enable_cub=True, index='subset', labels=5, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_121_{enable_cub=True, index='subset', labels=5, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_122_{enable_cub=True, index='subset', labels=5, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_123_{enable_cub=True, index='subset', labels=5, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_124_{enable_cub=True, index='subset', labels=5, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_125_{enable_cub=True, index='subset', labels=5, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_126_{enable_cub=True, index='subset', labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_127_{enable_cub=True, index='subset', labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_128_{enable_cub=True, index='subset', labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_129_{enable_cub=True, index='subset', labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_130_{enable_cub=True, index='subset', labels=5, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_131_{enable_cub=True, index='subset', labels=5, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_132_{enable_cub=True, index='subset', labels=50, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_133_{enable_cub=True, index='subset', labels=50, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_134_{enable_cub=True, index='subset', labels=50, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_135_{enable_cub=True, index='subset', labels=50, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_136_{enable_cub=True, index='subset', labels=50, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_137_{enable_cub=True, index='subset', labels=50, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_138_{enable_cub=True, index='subset', labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_139_{enable_cub=True, index='subset', labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_140_{enable_cub=True, index='subset', labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_141_{enable_cub=True, index='subset', labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_142_{enable_cub=True, index='subset', labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_143_{enable_cub=True, index='subset', labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_150_{enable_cub=False, index=None, labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_152_{enable_cub=False, index=None, labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_162_{enable_cub=False, index=None, labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_163_{enable_cub=False, index=None, labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_164_{enable_cub=False, index=None, labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_165_{enable_cub=False, index=None, labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_174_{enable_cub=False, index=None, labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_175_{enable_cub=False, index=None, labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_176_{enable_cub=False, index=None, labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_177_{enable_cub=False, index=None, labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_186_{enable_cub=False, index=1, labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_188_{enable_cub=False, index=1, labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_198_{enable_cub=False, index=1, labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_199_{enable_cub=False, index=1, labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_200_{enable_cub=False, index=1, labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_201_{enable_cub=False, index=1, labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_210_{enable_cub=False, index=1, labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_211_{enable_cub=False, index=1, labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_212_{enable_cub=False, index=1, labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_213_{enable_cub=False, index=1, labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_214_{enable_cub=False, index=1, labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_215_{enable_cub=False, index=1, labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_222_{enable_cub=False, index='all', labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_224_{enable_cub=False, index='all', labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_228_{enable_cub=False, index='all', labels=5, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_229_{enable_cub=False, index='all', labels=5, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_230_{enable_cub=False, index='all', labels=5, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_231_{enable_cub=False, index='all', labels=5, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_232_{enable_cub=False, index='all', labels=5, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_233_{enable_cub=False, index='all', labels=5, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_234_{enable_cub=False, index='all', labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_235_{enable_cub=False, index='all', labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_236_{enable_cub=False, index='all', labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_237_{enable_cub=False, index='all', labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_238_{enable_cub=False, index='all', labels=5, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_239_{enable_cub=False, index='all', labels=5, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_240_{enable_cub=False, index='all', labels=50, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_241_{enable_cub=False, index='all', labels=50, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_242_{enable_cub=False, index='all', labels=50, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_243_{enable_cub=False, index='all', labels=50, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_244_{enable_cub=False, index='all', labels=50, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_245_{enable_cub=False, index='all', labels=50, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_246_{enable_cub=False, index='all', labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_247_{enable_cub=False, index='all', labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_248_{enable_cub=False, index='all', labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_249_{enable_cub=False, index='all', labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_250_{enable_cub=False, index='all', labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_251_{enable_cub=False, index='all', labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_258_{enable_cub=False, index='subset', labels=None, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_260_{enable_cub=False, index='subset', labels=None, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_264_{enable_cub=False, index='subset', labels=5, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_265_{enable_cub=False, index='subset', labels=5, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_266_{enable_cub=False, index='subset', labels=5, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_267_{enable_cub=False, index='subset', labels=5, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_268_{enable_cub=False, index='subset', labels=5, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_269_{enable_cub=False, index='subset', labels=5, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_270_{enable_cub=False, index='subset', labels=5, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_271_{enable_cub=False, index='subset', labels=5, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_272_{enable_cub=False, index='subset', labels=5, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_273_{enable_cub=False, index='subset', labels=5, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_274_{enable_cub=False, index='subset', labels=5, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_275_{enable_cub=False, index='subset', labels=5, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_276_{enable_cub=False, index='subset', labels=50, op='maximum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_277_{enable_cub=False, index='subset', labels=50, op='maximum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_278_{enable_cub=False, index='subset', labels=50, op='median', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_279_{enable_cub=False, index='subset', labels=50, op='median', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_280_{enable_cub=False, index='subset', labels=50, op='minimum', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_281_{enable_cub=False, index='subset', labels=50, op='minimum', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_282_{enable_cub=False, index='subset', labels=50, op='maximum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_283_{enable_cub=False, index='subset', labels=50, op='maximum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_284_{enable_cub=False, index='subset', labels=50, op='minimum_position', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_285_{enable_cub=False, index='subset', labels=50, op='minimum_position', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_286_{enable_cub=False, index='subset', labels=50, op='extrema', shape=(512,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestMeasurementsSelect::test_measurements_select[_param_287_{enable_cub=False, index='subset', labels=50, op='extrema', shape=(32, 64)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_0_{index=None, labels=None, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_1_{index=None, labels=None, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_2_{index=None, labels=4, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_3_{index=None, labels=4, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_4_{index=None, labels=6, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_5_{index=None, labels=6, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_8_{index=[0, 2], labels=4, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_9_{index=[0, 2], labels=4, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_10_{index=[0, 2], labels=6, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_11_{index=[0, 2], labels=6, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_14_{index=[3, 1, 0], labels=4, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_15_{index=[3, 1, 0], labels=4, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_16_{index=[3, 1, 0], labels=6, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_17_{index=[3, 1, 0], labels=6, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_20_{index=[1], labels=4, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_21_{index=[1], labels=4, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_22_{index=[1], labels=6, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestHistogram::test_histogram[_param_23_{index=[1], labels=6, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_12_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_13_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_14_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_15_{default=0, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_20_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_21_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_22_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_23_{default=0, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_28_{default=0, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_29_{default=0, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_30_{default=0, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_31_{default=0, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_44_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_45_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_46_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_47_{default=0, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_52_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_53_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_54_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_55_{default=0, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_60_{default=0, dtype='same', index=[1], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_61_{default=0, dtype='same', index=[1], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_62_{default=0, dtype='same', index=[1], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_63_{default=0, dtype='same', index=[1], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_76_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_77_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_78_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_79_{default=3, dtype=float64, index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_84_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_85_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_86_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_87_{default=3, dtype=float64, index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_92_{default=3, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_93_{default=3, dtype=float64, index=[1], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_94_{default=3, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_95_{default=3, dtype=float64, index=[1], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_108_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_109_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_110_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_111_{default=3, dtype='same', index=[0, 2], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_116_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_117_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_118_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_119_{default=3, dtype='same', index=[3, 1, 0], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_124_{default=3, dtype='same', index=[1], labels=4, pass_positions=True, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_125_{default=3, dtype='same', index=[1], labels=4, pass_positions=True, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_126_{default=3, dtype='same', index=[1], labels=4, pass_positions=False, shape=(200,)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestLabeledComprehension::test_labeled_comprehension[_param_127_{default=3, dtype='same', index=[1], labels=4, pass_positions=False, shape=(16, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestIterateStructure::test_iterate_structure1
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestIterateStructure::test_iterate_structure2
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestIterateStructure::test_iterate_structure3
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_360_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_361_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_362_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_363_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_364_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_365_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_366_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_367_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_368_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_369_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_370_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_371_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_372_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_373_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_374_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=None, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_375_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_376_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_377_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_379_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_380_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_381_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_382_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_384_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_385_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_386_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_387_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_389_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=float32, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_390_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_392_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_393_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_394_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_395_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_397_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_398_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_399_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_400_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_402_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_403_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_404_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output=int8, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_405_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_406_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_407_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_408_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_409_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_410_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_411_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_412_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_413_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_414_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_415_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_416_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_417_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_418_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_419_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=-1, output='array', structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_420_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_421_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_422_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_423_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_424_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_425_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_426_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_427_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_428_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_429_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_430_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_431_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_432_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_433_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_434_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=None, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_435_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_436_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_437_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_439_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_440_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_441_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_442_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_444_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_445_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_446_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_447_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_449_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=float32, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_450_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_452_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_453_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_454_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_455_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_457_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_458_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_459_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_460_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_462_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_463_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_464_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output=int8, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_465_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_466_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_467_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_468_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_469_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_470_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_471_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_472_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_473_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_474_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_475_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_476_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_477_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_478_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_479_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=0, output='array', structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_480_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_481_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_482_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_483_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_484_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_485_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_486_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_487_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_488_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_489_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_490_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_491_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_492_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_493_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_494_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=None, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_495_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_496_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_497_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_499_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_500_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_501_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_502_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_504_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_505_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_506_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_507_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_509_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=float32, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_510_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_512_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_513_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_514_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=None, x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_515_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_517_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_518_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_519_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 0, 1], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_520_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_522_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_523_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=float32}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_524_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output=int8, structure=[1, 1, 0], x_dtype=float64}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_525_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=bool_}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_526_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=int8}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py::TestBinaryErosionAndDilation1d::test_binary_erosion_and_dilation_1d[_param_527_{border_value=0, data=[1, 1, 0, 1, 1], filter='binary_erosion', origin=1, output='array', structure=None, x_dtype=uint8}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_convolve_fft[_param_12_{mode='full', size1=(3, 4, 10), size2=3}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_convolve_fft[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}]
= 581 failed, 63363 passed, 7427 skipped, 85 deselected, 564 xfailed, 237 warnings in 26962.80s (7:29:22) =
