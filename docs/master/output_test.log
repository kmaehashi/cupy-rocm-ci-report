master: 827328a Merge pull request #5576 from kmaehashi/fix-flexci-scipy-cython
============================= test session starts ==============================
platform linux -- Python 3.8.7, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy, configfile: setup.cfg
plugins: html-3.1.1, metadata-1.11.0
collected 97790 items / 647 deselected / 2 skipped / 97141 selected

tests/cupy_tests/test_cublas.py ........................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
...........................x...........x.............................x.. [  2%]
.........x..........                                                     [  2%]
tests/cupy_tests/test_cudnn.py sssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssss                  [  4%]
tests/cupy_tests/test_cusolver.py ssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssss                                       [  5%]
tests/cupy_tests/test_cusparse.py xx..xx....xx....xx...................x [  5%]
xx.xxx.................ssss.xssssx.ssss.xssssx..xx..xxxx..xx....xx..xx.. [  5%]
xx..xxxx..xx....xx..xx..xx..xxxx..xx....xx..xx..xx..xxxx..xx....xx..xx.. [  5%]
..xxxxxxxx........xxxx....xxxxxxxx........xxxx....xxxxxxxx........xxxx.. [  5%]
..xxxxxxxx........xxxx....xxxxxxxx........xxxx....xxxxxxxx........xxxx.. [  5%]
..xxxxxxxx........xxxx....xxxxxxxx........xxxx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx.. [  5%]
..xx....xx....xx....xx....xx....xx....xx....xx.........x.x.x.x.x.x.x.x.x [  6%]
..................x.x.x.x.x.x.x.x.x..................                    [  6%]
tests/cupy_tests/test_cutensor.py ssssssssssssssssssssssssssssssssssssss [  6%]
sssssssssssssssssssssssssssssssssssss                                    [  6%]
tests/cupy_tests/test_init.py ..s........                                [  6%]
tests/cupy_tests/test_ndim.py ............                               [  6%]
tests/cupy_tests/test_numpy_interop.py ..x......                         [  6%]
tests/cupy_tests/test_type_routines.py ................................. [  6%]
.                                                                        [  6%]
tests/cupy_tests/binary_tests/test_elementwise.py ......                 [  6%]
tests/cupy_tests/binary_tests/test_packing.py ...                        [  6%]
tests/cupy_tests/core_tests/test_array_function.py .....                 [  6%]
tests/cupy_tests/core_tests/test_carray.py .....                         [  6%]
tests/cupy_tests/core_tests/test_core.py ......                          [  6%]
tests/cupy_tests/core_tests/test_cub_reduction.py ...................... [  6%]
...                                                                      [  6%]
tests/cupy_tests/core_tests/test_dlpack.py ......                        [  6%]
tests/cupy_tests/core_tests/test_elementwise.py ...............          [  6%]
tests/cupy_tests/core_tests/test_flags.py .............................  [  6%]
tests/cupy_tests/core_tests/test_function.py .....                       [  6%]
tests/cupy_tests/core_tests/test_gufuncs.py ............................ [  6%]
................................                                         [  6%]
tests/cupy_tests/core_tests/test_internal.py ........................... [  6%]
...............................................................          [  6%]
tests/cupy_tests/core_tests/test_iter.py ............                    [  6%]
tests/cupy_tests/core_tests/test_ndarray.py ..........................ss [  6%]
ssss.................................................................... [  6%]
......................F...sss...............                             [  6%]
tests/cupy_tests/core_tests/test_ndarray_adv_indexing.py ............... [  6%]
........................................................................ [  6%]
........................................................................ [  6%]
........................................................................ [  6%]
.............................................                            [  6%]
tests/cupy_tests/core_tests/test_ndarray_complex_ops.py ................ [  6%]
.....                                                                    [  6%]
tests/cupy_tests/core_tests/test_ndarray_contiguity.py .                 [  6%]
tests/cupy_tests/core_tests/test_ndarray_conversion.py .......xx..       [  6%]
tests/cupy_tests/core_tests/test_ndarray_copy_and_view.py .............. [  7%]
.........................sssssss                                         [  7%]
tests/cupy_tests/core_tests/test_ndarray_cuda_array_interface.py sssssss [  7%]
sssssssssssssssssssssssssssssssssssssssssssssssss                        [  7%]
tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py .F........... [  7%]
........................................F............................... [  7%]
...................................................................      [  7%]
tests/cupy_tests/core_tests/test_ndarray_get.py ............             [  7%]
tests/cupy_tests/core_tests/test_ndarray_indexing.py xxxx..........x...x [  7%]
........x..........x.............................                        [  7%]
tests/cupy_tests/core_tests/test_ndarray_math.py ......................s [  7%]
sssssssssss                                                              [  7%]
tests/cupy_tests/core_tests/test_ndarray_owndata.py ...                  [  7%]
tests/cupy_tests/core_tests/test_ndarray_reduction.py .................. [  7%]
........................................................................ [  7%]
........................................................................ [  7%]
................................                                         [  7%]
tests/cupy_tests/core_tests/test_ndarray_scatter.py .................... [  7%]
........................................................................ [  7%]
...............................................................          [  7%]
tests/cupy_tests/core_tests/test_ndarray_ufunc.py .........              [  7%]
tests/cupy_tests/core_tests/test_ndarray_unary_op.py ..................s [  7%]
...                                                                      [  7%]
tests/cupy_tests/core_tests/test_raw.py .ss.........sss..s.s.s........ss [  7%]
.........sss..s.s.s........ss.........sss..s.s.s......ssssssssssssssssss [  7%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s [  7%]
s.......sssss....s.s......sssssssssssssssssssssssssssss                  [  8%]
tests/cupy_tests/core_tests/test_reduction.py .......................    [  8%]
tests/cupy_tests/core_tests/test_scan.py ....                            [  8%]
tests/cupy_tests/core_tests/test_syncdetect.py ....                      [  8%]
tests/cupy_tests/core_tests/test_userkernel.py ....sss.............      [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_array.py ................. [  8%]
........................................................................ [  8%]
....................................................                     [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_indexing.py .............. [  8%]
.................s                                                       [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_kernel_cache.py ....       [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_misc.py .......s.......... [  8%]
........                                                                 [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_optimization.py .......... [  8%]
....                                                                     [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_reduction.py ............. [  8%]
........................................................................ [  8%]
.........................................................s.s.s.s.s.s.s.s [  8%]
.s.ssssssssssssssssss.sss                                                [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_routines.py .............. [  8%]
........................................................................ [  8%]
..............                                                           [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_ufunc.py ................. [  8%]
......................................................                   [  8%]
tests/cupy_tests/creation_tests/test_basic.py .......................... [  8%]
...........................................................s............ [  8%]
....s.                                                                   [  8%]
tests/cupy_tests/creation_tests/test_from_data.py ssssssssssssssssssssss [  8%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssss............. [  8%]
...................................................................      [  8%]
tests/cupy_tests/creation_tests/test_matrix.py ......................... [  8%]
.................................                                        [  8%]
tests/cupy_tests/creation_tests/test_ranges.py ......................... [  9%]
..............................................................           [  9%]
tests/cupy_tests/cuda_tests/test_compiler.py sssssss........             [  9%]
tests/cupy_tests/cuda_tests/test_cublas.py .                             [  9%]
tests/cupy_tests/cuda_tests/test_cudnn.py s                              [  9%]
tests/cupy_tests/cuda_tests/test_cufft.py ssssssssssssssss.              [  9%]
tests/cupy_tests/cuda_tests/test_curand.py .....                         [  9%]
tests/cupy_tests/cuda_tests/test_cusolver.py .                           [  9%]
tests/cupy_tests/cuda_tests/test_cusparse.py .                           [  9%]
tests/cupy_tests/cuda_tests/test_cutensor.py s                           [  9%]
tests/cupy_tests/cuda_tests/test_device.py ................              [  9%]
tests/cupy_tests/cuda_tests/test_driver.py ss.                           [  9%]
tests/cupy_tests/cuda_tests/test_memory.py ....ssssssss................. [  9%]
.ssssssssss......s.............................................sssssssss [  9%]
ssssssssssss                                                             [  9%]
tests/cupy_tests/cuda_tests/test_memory_hook.py .                        [  9%]
tests/cupy_tests/cuda_tests/test_nccl.py ........                        [  9%]
tests/cupy_tests/cuda_tests/test_nvrtc.py .                              [  9%]
tests/cupy_tests/cuda_tests/test_nvtx.py ....                            [  9%]
tests/cupy_tests/cuda_tests/test_pinned_memory.py ............           [  9%]
tests/cupy_tests/cuda_tests/test_profile.py ..                           [  9%]
tests/cupy_tests/cuda_tests/test_runtime.py .                            [  9%]
tests/cupy_tests/cuda_tests/test_stream.py ..s..s......ssssssssssss.s    [  9%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_debug_print.py .     [  9%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_line_profile.py ..   [  9%]
tests/cupy_tests/fft_tests/test_cache.py ..sss.....s..                   [  9%]
tests/cupy_tests/fft_tests/test_callback.py ssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssss                     [  9%]
tests/cupy_tests/fft_tests/test_fft.py ....ssss....ssss........ssss....s [  9%]
sss........ssss....ssss........ssss....ssss........ssss....ssss........s [ 10%]
sss....ssss........ssss....ssss........ssss....ssss........ssss....ssss. [ 10%]
.......ssss....ssss....................................................s [ 10%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 10%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss. [ 10%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 10%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 10%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.. [ 10%]
s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s. [ 10%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 10%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 10%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 10%]
.s.s.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 10%]
.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.sss [ 10%]
ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 11%]
.sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s...ss..ss....ss..ss....ss..ss....ss [ 11%]
..ss....ss..ss....ss..ss....ss..ss....ss..ss...s.s.s.s.s.s.s.s.s.s.s.s.s [ 11%]
.s.s.s.s.s.s.s.s.s.s.s.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s......s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 11%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s.sssss.s.s..s.s.sssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s..s.s..s.s..s.s..s. [ 11%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s.......ss..ss....ss..ss....ss..ss....ss..ss [ 12%]
....ss..ss....ss..ss....ss..ss....ss..ss........................         [ 12%]
tests/cupy_tests/functional_tests/test_piecewise.py .............        [ 12%]
tests/cupy_tests/functional_tests/test_vectorize.py .................... [ 12%]
..................................                                       [ 12%]
tests/cupy_tests/indexing_tests/test_generate.py ....................... [ 12%]
...............                                                          [ 12%]
tests/cupy_tests/indexing_tests/test_indexing.py ....................... [ 12%]
.........................                                                [ 12%]
tests/cupy_tests/indexing_tests/test_insert.py ......................... [ 12%]
........................................................................ [ 12%]
........................................................................ [ 12%]
.........................................................                [ 12%]
tests/cupy_tests/indexing_tests/test_iterate.py ........................ [ 12%]
...............................................                          [ 12%]
tests/cupy_tests/io_tests/test_base_n.py ............................    [ 12%]
tests/cupy_tests/io_tests/test_formatting.py ..                          [ 12%]
tests/cupy_tests/io_tests/test_npz.py .......                            [ 12%]
tests/cupy_tests/lib_tests/test_polynomial.py .......ss.......ssssssssss [ 12%]
sssssss........ssssssssssssssssssssssssssssssssssssxxxxxxxxxxxxxxxxxxxx. [ 12%]
..ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 12%]
ssssssssssssssssssssssssss......xxxxxxxxxxxxxxxxxxxxxxxx................ [ 12%]
........................................................................ [ 12%]
........xxxxxxxx........xxxxxxxx........................................ [ 12%]
...........xxxxxx............................x.......................... [ 13%]
..                                                                       [ 13%]
tests/cupy_tests/lib_tests/test_shape_base.py ......................     [ 13%]
tests/cupy_tests/lib_tests/test_strided_tricks.py ..                     [ 13%]
tests/cupy_tests/linalg_tests/test_decomposition.py .................... [ 13%]
.......................                                                  [ 13%]
tests/cupy_tests/linalg_tests/test_eigenvalue.py xxxxxxxx                [ 13%]
tests/cupy_tests/linalg_tests/test_einsum.py ........................... [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
..........                                                               [ 13%]
tests/cupy_tests/linalg_tests/test_norms.py ............................ [ 13%]
........................................................................ [ 14%]
........................................................................ [ 14%]
.................................................................        [ 14%]
tests/cupy_tests/linalg_tests/test_product.py .......................... [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
................................................                         [ 14%]
tests/cupy_tests/linalg_tests/test_solve.py ............................ [ 14%]
....................................                                     [ 14%]
tests/cupy_tests/logic_tests/test_comparison.py ........................ [ 14%]
.....                                                                    [ 14%]
tests/cupy_tests/logic_tests/test_content.py ...                         [ 14%]
tests/cupy_tests/logic_tests/test_ops.py ....                            [ 14%]
tests/cupy_tests/logic_tests/test_truth.py ............................. [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
...........................................                              [ 15%]
tests/cupy_tests/logic_tests/test_type_test.py ......................... [ 15%]
.......                                                                  [ 15%]
tests/cupy_tests/manipulation_tests/test_add_remove.py ................. [ 15%]
.........................                                                [ 15%]
tests/cupy_tests/manipulation_tests/test_basic.py ...................... [ 15%]
.......................................................                  [ 15%]
tests/cupy_tests/manipulation_tests/test_dims.py .....x.x............... [ 15%]
................................................                         [ 15%]
tests/cupy_tests/manipulation_tests/test_join.py ....................... [ 15%]
...........................                                              [ 15%]
tests/cupy_tests/manipulation_tests/test_kind.py ...........             [ 15%]
tests/cupy_tests/manipulation_tests/test_rearrange.py .................. [ 15%]
.......................................................                  [ 15%]
tests/cupy_tests/manipulation_tests/test_shape.py ...................... [ 15%]
......................................                                   [ 15%]
tests/cupy_tests/manipulation_tests/test_split.py ..................     [ 15%]
tests/cupy_tests/manipulation_tests/test_tiling.py ..................... [ 15%]
...........                                                              [ 15%]
tests/cupy_tests/manipulation_tests/test_transpose.py .................. [ 15%]
..........                                                               [ 15%]
tests/cupy_tests/math_tests/test_arithmetic.py ......................... [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 24%]
........................................................................ [ 24%]
...........................                                              [ 24%]
tests/cupy_tests/math_tests/test_explog.py .........                     [ 24%]
tests/cupy_tests/math_tests/test_floating.py .......                     [ 24%]
tests/cupy_tests/math_tests/test_hyperbolic.py ......                    [ 24%]
tests/cupy_tests/math_tests/test_matmul.py ............................. [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
................................................                         [ 24%]
tests/cupy_tests/math_tests/test_misc.py ............................... [ 24%]
............................................F..F..F..................... [ 24%]
..............................                                           [ 24%]
tests/cupy_tests/math_tests/test_rational.py ....                        [ 24%]
tests/cupy_tests/math_tests/test_rounding.py ........................... [ 24%]
..........................................                               [ 24%]
tests/cupy_tests/math_tests/test_special.py ...                          [ 24%]
tests/cupy_tests/math_tests/test_sumprod.py ............................ [ 24%]
....................................................ssssssssssssssss.... [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
..............................................................           [ 25%]
tests/cupy_tests/math_tests/test_trigonometric.py ..........sssssssss    [ 25%]
tests/cupy_tests/math_tests/test_window.py ............................. [ 25%]
.....                                                                    [ 25%]
tests/cupy_tests/misc_tests/test_memory_ranges.py ................       [ 25%]
tests/cupy_tests/misc_tests/test_who.py ......                           [ 25%]
tests/cupy_tests/padding_tests/test_pad.py ............................. [ 25%]
..............................................                           [ 25%]
tests/cupy_tests/polynomial_tests/test_polynomial.py ................... [ 25%]
                                                                         [ 25%]
tests/cupy_tests/polynomial_tests/test_polyutils.py .................... [ 25%]
................                                                         [ 25%]
tests/cupy_tests/prof_tests/test_range.py ........                       [ 25%]
tests/cupy_tests/random_tests/test_bit_generator.py ssssssssssss         [ 25%]
tests/cupy_tests/random_tests/test_distributions.py .................... [ 25%]
........................................................................ [ 25%]
................................................x.x.x.x.x.x.x.x.x.x.x.x. [ 25%]
x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x......................... [ 25%]
........................................................................ [ 25%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
......................................................................x. [ 26%]
x.x.x.x.x............................x.x.x.x.x.x........................ [ 26%]
........................................................................ [ 26%]
.........................................x.x.                            [ 26%]
tests/cupy_tests/random_tests/test_generator.py ........................ [ 26%]
.........................................s.......s.s.................... [ 26%]
........................................................................ [ 27%]
......................................s.s............................... [ 27%]
............................................x........................... [ 27%]
....                                                                     [ 27%]
tests/cupy_tests/random_tests/test_generator_api.py ssssssssssssssssssss [ 27%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 27%]
ssssssssssssssssssss                                                     [ 27%]
tests/cupy_tests/random_tests/test_init.py .                             [ 27%]
tests/cupy_tests/random_tests/test_permutations.py ...x...x............. [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
.............                                                            [ 27%]
tests/cupy_tests/random_tests/test_random.py .                           [ 27%]
tests/cupy_tests/random_tests/test_sample.py ...............x........x.. [ 27%]
............                                                             [ 27%]
tests/cupy_tests/sorting_tests/test_count.py ....                        [ 27%]
tests/cupy_tests/sorting_tests/test_search.py ssssssss........ssssssss.. [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
....................................................................     [ 27%]
tests/cupy_tests/sorting_tests/test_sort.py ............................ [ 27%]
........................................................................ [ 27%]
..........................................................x...........   [ 27%]
tests/cupy_tests/statistics_tests/test_correlation.py .................. [ 27%]
..............................F..F.xF...................                 [ 28%]
tests/cupy_tests/statistics_tests/test_histogram.py .................... [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................                 [ 28%]
tests/cupy_tests/statistics_tests/test_meanvar.py ...................... [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
......                                                                   [ 28%]
tests/cupy_tests/statistics_tests/test_order.py sssss................... [ 28%]
.........................                                                [ 28%]
tests/cupy_tests/testing_tests/test_array.py ........................... [ 28%]
...............................................                          [ 28%]
tests/cupy_tests/testing_tests/test_condition.py ................        [ 28%]
tests/cupy_tests/testing_tests/test_helper.py .......................... [ 28%]
........................................................................ [ 28%]
.....sssss..sssssss..ssxxxxxxxx................x..x.................     [ 28%]
tests/cupy_tests/testing_tests/test_parameterized.py ............s.s.s.s [ 28%]
....ssss......                                                           [ 28%]
tests/cupyx_tests/test_cupyx.py ..                                       [ 28%]
tests/cupyx_tests/test_lapack.py .s.s.s.s.....s.s.s.s.....s.s.s.s.....s. [ 28%]
s.s.s.............sssssssssssss                                          [ 29%]
tests/cupyx_tests/test_optimize.py sssssssss                             [ 29%]
tests/cupyx_tests/test_pinned_array.py ................................. [ 29%]
.......................................                                  [ 29%]
tests/cupyx_tests/test_rsqrt.py .                                        [ 29%]
tests/cupyx_tests/test_runtime.py s.                                     [ 29%]
tests/cupyx_tests/test_scatter.py ...                                    [ 29%]
tests/cupyx_tests/test_time.py .........                                 [ 29%]
tests/cupyx_tests/fallback_mode_tests/test_fallback.py ................. [ 29%]
........................................................................ [ 29%]
.........                                                                [ 29%]
tests/cupyx_tests/fallback_mode_tests/test_notifications.py .........    [ 29%]
tests/cupyx_tests/jit_tests/test_raw.py ................................ [ 29%]
...........                                                              [ 29%]
tests/cupyx_tests/linalg_tests/test_solve.py xxxxxxxxxxxxxxxx....ssss    [ 29%]
tests/cupyx_tests/scipy_tests/test_get_array_module.py ..                [ 29%]
tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py .................... [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
.................sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 37%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss.........sss.........sss.........sss.... [ 38%]
.....sss.........sss.........sss........................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................F............... [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
......................................................................   [ 39%]
tests/cupyx_tests/scipy_tests/fft_tests/test_helper.py .                 [ 39%]
tests/cupyx_tests/scipy_tests/fftpack_tests/test_fftpack.py ............ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
.........................                                                [ 40%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_decomp_lu.py ........... [ 40%]
...................................................                      [ 40%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_solve_triangular.py .... [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
....................................................................     [ 40%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_special_matrices.py .... [ 40%]
........................................................................ [ 41%]
.................................................                        [ 41%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_filters.py ...sss...... [ 41%]
sss......sss......sss......sss......sss.........sss......sss......sss... [ 41%]
...sss......sss......sss................................................ [ 41%]
...........................................................sss......sss. [ 41%]
.....sss......sss......sss......sss.........sss......sss......sss......s [ 41%]
ss......sss......sss.................................................... [ 41%]
.......................................................sss......sss..... [ 41%]
.sss......sss......sss......sss.........sss......sss......sss......sss.. [ 41%]
....sss......sss........................................................ [ 41%]
...................................................sss......sss......sss [ 41%]
......sss......sss......sss.........sss......sss......sss......sss...... [ 41%]
sss......sss............................................................ [ 41%]
...............................................sss......sss......sss.... [ 42%]
..sss......sss......sss.........sss......sss......sss......sss......sss. [ 42%]
.....sss................................................................ [ 42%]
...........................................sss......sss......sss......ss [ 42%]
s......sss......sss.........sss......sss......sss......sss......sss..... [ 42%]
.sss.................................................................... [ 42%]
.......................................sss......sss......sss......sss... [ 42%]
...sss......sss.........sss......sss......sss......sss......sss......sss [ 42%]
........................................................................ [ 42%]
...................................sss......sss......sss......sss......s [ 42%]
ss......sss.........sss......sss......sss......sss......sss......sss.... [ 42%]
........................................................................ [ 42%]
...............................sss......sss......sss......sss......sss.. [ 42%]
....sss.........sss......sss......sss......sss......sss......sss........ [ 42%]
........................................................................ [ 43%]
...........................sss......sss......sss......sss......sss...... [ 43%]
sss.........sss......sss......sss......sss......sss......sss............ [ 43%]
........................................................................ [ 43%]
.......................sss......sss......sss......sss......sss......sss. [ 43%]
........sss......sss......sss......sss......sss......sss................ [ 43%]
........................................................................ [ 43%]
...................sss......sss......sss......sss......sss......sss..... [ 43%]
....sss......sss......sss......sss......sss......sss.................... [ 43%]
........................................................................ [ 43%]
...............sss......sss......sss......sss......sss......sss......... [ 43%]
sss......sss......sss......sss......sss......sss........................ [ 43%]
........................................................................ [ 43%]
...........sss......sss......sss......sss......sss......sss.........sss. [ 44%]
.....sss......sss......sss......sss......sss............................ [ 44%]
........................................................................ [ 44%]
xxx....sss......sss......sss......sss......sss......sss....x..x.sss.x..x [ 44%]
.sss.x..x.sss......sss......sss......sss................................ [ 44%]
.....................................................x..x.............x. [ 44%]
......................................x.....x....x.....x......x.....x... [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 46%]
........................................................................ [ 46%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 46%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 46%]
.............................................................s.s.s.s.s.s [ 46%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 46%]
........................................................................ [ 46%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 46%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 47%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 47%]
........................................................................ [ 47%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 47%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 47%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 47%]
........................................................................ [ 47%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 47%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 47%]
.s.s.s.s.s.s.s.s.s.s.s.ssss..sss..sss............sss..sss..sss.......... [ 47%]
..sss..sss..sss............sss..sss..sss............sss..sss..sss....... [ 48%]
.....sss..sss..sss............sss..sss..sss............sss..sss..sss.... [ 48%]
........sss..sss..sss............sss..sss..sss............sss..sss..sss. [ 48%]
...........sss..sss..sss................................................ [ 48%]
........................................................................ [ 48%]
....................................                                     [ 48%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_fourier.py ............ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................                                 [ 48%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py ...... [ 48%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
................FF...................................................... [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
...............................x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x...................................................... [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
.....................sssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 60%]
sssssssssssssssssssssssssssssssssssssssssssssss......................... [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
..................................................x.....x.....x.....x... [ 60%]
..x.....x.....x.....x.....x.....x.....x.....x.......x........x..x..x.... [ 60%]
....s................................................................... [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
................................x.....x....................x.....x...... [ 61%]
..............x.....x....................x.....x....................x... [ 61%]
..x....................x.....x....................x.....x............... [ 61%]
.....x.....x............................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
.................................................................s...... [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
......................................FF..........FF....FF.............. [ 62%]
........FF....FF..........FF....FF......................FFss............ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
....................................ssssssssssssssssssssssssssssssssssss [ 62%]
ssssssssssss                                                             [ 62%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py ....... [ 62%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
...................xx..........xx..........xx..........xx..........xx... [ 65%]
...................xx..................................xx............... [ 65%]
...................xx..........xx..........xx..........xx..........xx... [ 65%]
...................xx..................................xx............... [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
.................                                                        [ 66%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py ......... [ 66%]
......................s....s....s..s....s....s.......................... [ 66%]
..........s....s....s..s....s....s....................................s. [ 66%]
...s....s..s....s....s....................................s....s....s..s [ 66%]
....s....s....................................s....s....s..s....s....s.. [ 66%]
..................................s....s....s..s....s....s.............. [ 66%]
......................s....s....s..s....s....s.......................... [ 66%]
..........s....s....s..s....s....s....................................s. [ 66%]
...s....s..s....s....s....................................s....s....s..s [ 66%]
....s....s....................................s....s....s..s....s....s.. [ 66%]
..................................s....s....s..s....s....s.............. [ 66%]
......................s....s....s..s....s....s.......................... [ 66%]
..........s....s....s..s....s....s....................................s. [ 67%]
...s....s..s....s....s....................................s....s....s..s [ 67%]
....s....s....................................s....s....s..s....s....s.. [ 67%]
..................................s....s....s..s....s....s.............. [ 67%]
......................s....s....s..s....s....s.......................... [ 67%]
..........s....s....s..s....s....s....................................s. [ 67%]
...s....s..s....s....s....................................s....s....s..s [ 67%]
....s....s....................................s....s....s..s....s....s.. [ 67%]
..................................s....s....s..s....s....s.............. [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
.......................................................................s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............. [ 70%]
........................................................................ [ 70%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 71%]
..........................................s....s....s....s....s....s.... [ 71%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 71%]
s....s....s....s........................................................ [ 71%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 71%]
..........................................s....s....s....s....s....s.... [ 71%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 71%]
s....s....s....s........................................................ [ 71%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 71%]
..........................................s....s....s....s....s....s.... [ 71%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 72%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 72%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 72%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 72%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 72%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 73%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 73%]
s....s....s....s........................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
                                                                         [ 74%]
tests/cupyx_tests/scipy_tests/signal_tests/test_bsplines.py ............ [ 74%]
                                                                         [ 74%]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py ......... [ 74%]
........................................................................ [ 74%]
...................................................FFFxxxxxxxxx......... [ 74%]
...........................xxxxxxxxxxxx................................. [ 75%]
.....F......xxx..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 75%]
x.x..................................................................... [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
..................ssssssssssssssssss                                     [ 75%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_base.py .......          [ 75%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_construct.py ........... [ 75%]
........................................................................ [ 75%]
................................s.......s.......s.......s.......s....... [ 75%]
s....................................................................... [ 75%]
...........xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 75%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 75%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....................................x [ 75%]
xxxxxxxxxxxxxxxxxxxxxxx................................................. [ 76%]
...................................xxxxxxxxxxxx......................... [ 76%]
...........xxxxxxxxxxxxxxxxxxxxxxxx..................................... [ 76%]
...............................................xxxxxxxxxxxx............. [ 76%]
.......................xxxxxxxxxxxxxxxxxxxxxxxx......................... [ 76%]
...........................................................xxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxx....................................xxxxxxxxxxxxx [ 76%]
xxxxxxxxxxx............................................................. [ 76%]
.......................xxxxxxxxxxxx....................................x [ 76%]
xxxxxxxxxxxxxxxxxxxxxxx................................................. [ 77%]
...................................xxxxxxxxxxxx......................... [ 77%]
...........xxxxxxxxxxxxxxxxxxxxxxxx..................................... [ 77%]
...............................................xxxxxxxxxxxx............. [ 77%]
.......................xxxxxxxxxxxxxxxxxxxxxxxx......................... [ 77%]
...........................................................xxxxxxxxxxxx. [ 77%]
...................................xxxxxxxxxxxxxxxxxxxxxxxx............. [ 77%]
.......................................................................x [ 77%]
xxxxxxxxxxx....................................xxxxxxxxxxxxxxxxxxxxxxxx. [ 77%]
........................................................................ [ 77%]
...........xxxxxxxxxxxx....................................xxxxxxxxxxxxx [ 77%]
xxxxxxxxxxx............................................................. [ 77%]
.......................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 77%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx............. [ 77%]
.......................................................................x [ 78%]
xxxxxxxxxxx............................................................. [ 78%]
.......................xxxxxxxxxxxx..................................... [ 78%]
...............................................xxxxxxxxxxxx............. [ 78%]
.......................................................................x [ 78%]
xxxxxxxxxxx............................................................. [ 78%]
.......................xxxxxxxxxxxx..................................... [ 78%]
...............................................xxxxxxxxxxxx............. [ 78%]
........................................................................ [ 78%]
..                                                                       [ 78%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_coo.py ................. [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
.............................................                            [ 80%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_csc.py .............x... [ 80%]
......................x.........................x....................... [ 80%]
..x..................................................................... [ 80%]
.....................x..xx...............s......x.x..................... [ 80%]
................................x..xx...............s......x.x.......... [ 80%]
.................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxx [ 80%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........x..xx............. [ 81%]
..s......x.x...........................................xxxxxxxxxxxxxxxxx [ 81%]
xxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...... [ 81%]
....x..xx...............s......x.x...................................... [ 81%]
...............x..xx...............s......x.x........................... [ 81%]
................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxx [ 81%]
xxxxxxxxxxxxxxxxxxxxxxxxxxx..........x..xx...............s......x.x..... [ 81%]
......................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxx [ 81%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........x..xx........ [ 81%]
.......s......x.x.....................................................x. [ 81%]
.xx...............s......x.x...........................................x [ 81%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 81%]
xxxxxxxxxx..........x..xx...............s......x.x...................... [ 81%]
.....................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxx [ 81%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........x..xx...............s......x.x [ 82%]
.....................................................x..xx.............. [ 82%]
.s......x.x...........................................xxxxxxxxxxxxxxxxxx [ 82%]
xxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....... [ 82%]
...x..xx...............s......x.x....................................... [ 82%]
....xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 82%]
xxxxxxxxxxxxxxxxxxxxxxxxxxx............xxxxxxxxxxxxxxxxxxxxxxxx......... [ 82%]
...........ss....ss..................................................... [ 82%]
....xxx.........xxx.........xxx.........xxx............................. [ 82%]
........................................................................ [ 82%]
.................................................................        [ 82%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py .............x... [ 82%]
......................x.........................x....................... [ 82%]
..x..................................................................... [ 82%]
...............................................s........................ [ 83%]
......x................................................................. [ 83%]
....s..............................x.................................xxx [ 83%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxxxxxxxxxxxxxxxx....................................s......... [ 83%]
.....................x.................................xxxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxx....................................s....................... [ 83%]
.......x................................................................ [ 83%]
.....s..............................x.................................xx [ 83%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxxxxxxxxxxxxxxxxx....................................s........ [ 83%]
......................x.................................xxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 83%]
xxxxxxxxxxxxx....................................s...................... [ 84%]
........x............................................................... [ 84%]
......s..............................x.................................x [ 84%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 84%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxx....................................s....... [ 84%]
.......................x.................................xxxxxxxxxxxxxxx [ 84%]
xxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 84%]
xxxxxxxxxxxxxx....................................s..................... [ 84%]
.........x.............................................................. [ 84%]
.......s..............................x................................. [ 84%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 84%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxx....................................s...... [ 84%]
........................x.................................xxxxxxxxxxxxxx [ 84%]
xxxxxxxxxxxxxxxxxxxxxxsxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 85%]
xxxxxxxxxxxxxxx........................................................x [ 85%]
xxxxxxxxxxxxxxxxxxxxxxx................................................x [ 85%]
xxxxxxxxxxxxxxxxxxxxxxx........ss....ss................................. [ 85%]
.......................x...x.......x...x.......x...x.......x...x........ [ 85%]
........................................................................ [ 85%]
.......................................................................s [ 85%]
sssssssssss............................................................. [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
..........s..........s..........s..........s............................ [ 87%]
......................................................................s. [ 87%]
.........s..........s..........s........................................ [ 87%]
..........................................................s..........s.. [ 87%]
........s..........s.................................................... [ 87%]
..............................................s..........s..........s... [ 87%]
.......s................................................................ [ 88%]
..................................s..........s..........s..........s.... [ 88%]
........................................................................ [ 88%]
......................s..........s..........s..........s................ [ 88%]
........................................................................ [ 88%]
..........s..........s..........s..........s............................ [ 88%]
......................................................................s. [ 88%]
.........s..........s..........s........................................ [ 88%]
..........................................................s..........s.. [ 88%]
........s..........s.................................................... [ 88%]
..............................................s..........s..........s... [ 88%]
.......s................................................................ [ 88%]
..................................s..........s..........s..........s.... [ 88%]
........................................................................ [ 89%]
......................s..........s..........s..........s................ [ 89%]
........................................................................ [ 89%]
..........s..........s..........s..........s............................ [ 89%]
......................................................................s. [ 89%]
.........s..........s..........s........................................ [ 89%]
..........................................................s..........s.. [ 89%]
........s..........s.................................................... [ 89%]
..............................................s..........s..........s... [ 89%]
.......s.................                                                [ 89%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_dia.py ................. [ 89%]
........................................................................ [ 89%]
......xxxxxxxxxxxxxxx...............xxxxxxxxxxxxxxx...............xxxxxx [ 89%]
xxxxxxxxx...............xxxxxxxxxxxxxxx............xxxxxxxxxxxx......... [ 89%]
...............xxxxxxxxxxxx..                                            [ 89%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_extract.py ............. [ 89%]
........................................................................ [ 90%]
.......................                                                  [ 90%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py ............... [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
.....................................sss...sss.......................... [ 92%]
........................................................................ [ 92%]
.................................................sss...sss...sss...sss.. [ 92%]
.sss...sss...sss...sss.......................................ssssss..... [ 92%]
.....................................ssssss............................. [ 92%]
.............ssssss..........................................ssssss..... [ 92%]
.....................................ssssss............................. [ 92%]
.............ssssss..........................................ssssss..... [ 93%]
.....................................ssssss............................. [ 93%]
.sssssssss...sssssssss...sssssssss...sssssssss...sssssssss.............. [ 93%]
.........................sss...sss...................................... [ 93%]
........................................................................ [ 93%]
.....................................sss...sss...sss...sss...sss...sss.. [ 93%]
.sss...sss.......................................ssssss................. [ 93%]
.........................ssssss......................................... [ 93%]
.ssssss..........................................ssssss................. [ 93%]
.........................ssssss......................................... [ 93%]
.ssssss..........................................ssssss................. [ 93%]
.........................ssssss..............................sssssssss.. [ 93%]
.sssssssss...sssssssss...sssssssss...sssssssss...................x...... [ 93%]
.....x.......sss...sss.................................................. [ 93%]
....xxx.........xxx.................................xxx.........xxx..... [ 94%]
.........................sss...sss...sss...sss...sss...sss...sss...sss.. [ 94%]
...................xxx.........xxx...ssssss........................xxxxx [ 94%]
x......xxxxxxssssss..........................................ssssss..... [ 94%]
.....................................ssssss............................. [ 94%]
.............ssssss........................xxx.........xxx...ssssss..... [ 94%]
.....................................ssssss............................. [ 94%]
.............ssssss..............................sssssssss...sssssssss.. [ 94%]
.sssssssss...sssssssss...sssssssss...................x...........x...... [ 94%]
.sss...sss......................................................xxx..... [ 94%]
....xxx...xxx...........................xxx.........xxx...xxx........... [ 94%]
.............sss...sss...sss...sss...sss...sss...sss...sss.............. [ 94%]
.......xxx.........xxx...ssssss........................xxx.........xxx.. [ 94%]
.ssssss..........................................ssssss................. [ 95%]
.........................ssssss........................xxx.........xxx.. [ 95%]
.ssssss........................xxx.........xxx...ssssss................. [ 95%]
.......xxx.........xxx...ssssss........................xxx.........xxx.. [ 95%]
.ssssss..............................sssssssss...sssssssss...sssssssss.. [ 95%]
.sssssssss...sssssssss.................................................. [ 95%]
........................................................................ [ 95%]
........................................................................ [ 95%]
.....................                                                    [ 95%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py ssssssss.x.x.x [ 95%]
..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x.. [ 95%]
x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x.xx..xxxxxxxxxx....xx..xxxxxxxx [ 95%]
xx....xx..xxxxxxxxxx....xx..xxxxxxxxxx.................................. [ 95%]
..........................................xx..xxxxxxxxxx....xx..xxxxxxxx [ 95%]
xx....xx..xxxxxxxxxx....xx..xxxxxxxxxx.................................. [ 95%]
................................................................xxxxxx.. [ 96%]
xxxx.................................................................... [ 96%]
..........xxxxxx..xxxx.................................................. [ 96%]
............................xxxxxx..xxxx................................ [ 96%]
..............................................xxxxxx..xxxx.............. [ 96%]
................................................................xxxxxx.. [ 96%]
xxxx.................................................................... [ 96%]
..........xxxxxx..xxxx.................................................. [ 96%]
............................xxxxxx..xxxx................................ [ 96%]
..............................................xxxxxx..xxxx.............. [ 96%]
................................................................xxxxxx.. [ 96%]
xxxx.................................................................... [ 96%]
..........xxxxxx..xxxx.................................................. [ 96%]
............................xxxxxx..xxxx................................ [ 96%]
..............................................xxxxxx..xxxx.............. [ 97%]
................................................................xxxxxx.. [ 97%]
xxxx.................................................................... [ 97%]
..........xxxxxx..xxxx.................................................. [ 97%]
............................xxxxxx..xxxx................................ [ 97%]
..............................................xxxxxx..xxxx.............. [ 97%]
..........................................ssssssss...................... [ 97%]
......................................................s..s..s....sss.s.s [ 97%]
ss....s..s..s....sss.s.sss....s..s..s....sss.s.sss..F.sF.sF.sF..Fsss.sFs [ 97%]
ss..F.sF.sF.sF..Fsss.sFsss..F.sF.sF.sF..Fsss.sFsss..x.sx.sx.sx..xssx.sxs [ 97%]
sx..x.sx.sx.sx..xssx.sxssx..x.sx.sx.sx..xssx.sxssx....s..s..s.....s..s.. [ 97%]
s.....s..s..s.....s..s..s.....s..s..s.....s..s..s...F.sF.sF.sF..F.sF.sF. [ 97%]
sF..F.sF.sF.sF..F.sF.sF.sF..F.sF.sF.sF..F.sF.sF.sF..x.sx.sx.sx..x.sx.sx. [ 97%]
sx..x.sx.sx.sx..x.sx.sx.sx..x.sx.sx.sx..x.sx.sx.sx....s..s..s.....s..s.. [ 98%]
s.....s..s..s.....s..s..s.....s..s..s.....s..s..s...F.sF.sF.sF..F.sF.sF. [ 98%]
sF..F.sF.sF.sF..F.sF.sF.sF..F.sF.sF.sF..F.sF.sF.sF..x.sx.sx.sx..x.sx.sx. [ 98%]
sx..x.sx.sx.sx..x.sx.sx.sx..x.sx.sx.sx..x.sx.sx.sx...................... [ 98%]
..xxxxxxxxxxxxxxxxxxxxxxxx.............................................. [ 98%]
..xxxxxxxxxxxxxxxxxxxxxxxxss..ss..ss..ss..ss..ss..xxxxxxxxxxxxxxxxxxxxxx [ 98%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................... [ 98%]
..................................................xxxxxxxxxxxxxxxxxxxxxx [ 98%]
xxxxxxxxxxxxxxs.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s....................... [ 98%]
..........................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 98%]
xx...................................................................... [ 98%]
...........................sss.sssssssssssssssssssssssssss.............. [ 98%]
........................................................................ [ 98%]
..........................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 98%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................... [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
...........sssssss.sssssssssssssssssssssssssssssssssssssssssssssssssssss [ 99%]
ss...................................................................... [ 99%]
..ssssssss.sssssssssssssssxxxxxxxxxxxxxxx............................... [ 99%]
.................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....... [ 99%]
........................................................................ [ 99%]
..................sss.sssssssssssssssssssssssssss                        [ 99%]
tests/cupyx_tests/scipy_tests/sparse_tests/csgraph_tests/test_traversal.py s [ 99%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 99%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_bessel.py ............  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_convex_analysis.py .... [ 99%]
.                                                                        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_digamma.py .....        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_erf.py ............     [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gamma.py ....           [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gammaln.py ....         [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_polygamma.py ....       [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_statistics.py ..        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_zeta.py ....            [ 99%]
tests/cupyx_tests/scipy_tests/stats_tests/test_distributions.py ........ [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
                                                                         [ 99%]
tests/cupyx_tests/tools_tests/test_install_library.py ......             [ 99%]
tests/example_tests/test_custom_struct.py FFF                            [ 99%]
tests/example_tests/test_finance.py ...                                  [ 99%]
tests/example_tests/test_gemm.py .                                       [ 99%]
tests/example_tests/test_gmm.py ss                                       [ 99%]
tests/example_tests/test_kmeans.py sss                                   [ 99%]
tests/install_tests/test_build.py sx.                                    [ 99%]
tests/install_tests/test_utils.py ..                                     [100%]

=================================== FAILURES ===================================
______________ TestNdarrayCopy.test_copy_multi_device_with_stream ______________

self = <cupy_tests.core_tests.test_ndarray.TestNdarrayCopy testMethod=test_copy_multi_device_with_stream>

    @testing.multi_gpu(2)
    def test_copy_multi_device_with_stream(self):
        # Kernel that takes long enough then finally writes values.
        kern = cupy.RawKernel(
            _test_copy_multi_device_with_stream_src, 'wait_and_write')
    
        # Allocates a memory and launches the kernel on a device with its
        # stream.
        with cuda.Device(0):
            # Keep this stream alive over the D2D copy below for HIP
            with cuda.Stream() as s1:  # NOQA
                a = cupy.zeros((2,), dtype=numpy.uint64)
                kern((1,), (1,), a)
    
        # D2D copy to another device with another stream should get the
        # original values of the memory before the kernel on the first device
        # finally makes the write.
        with cuda.Device(1):
            with cuda.Stream():
                b = a.copy()
>               testing.assert_array_equal(
                    b, numpy.array([0, 0], dtype=numpy.uint64))

tests/cupy_tests/core_tests/test_ndarray.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([13744632839234567870, 13744632839234567870], dtype=uint64)
y = array([0, 0], dtype=uint64), err_msg = '', verbose = True
strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 13744632839234567870
E       Max relative difference: inf
E        x: array([13744632839234567870, 13744632839234567870], dtype=uint64)
E        y: array([0, 0], dtype=uint64)

cupy/testing/_array.py:91: AssertionError
_______________ TestArrayElementwiseOp.test_add_array_boolarray ________________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_add_array_boolarray>

    def test_add_array_boolarray(self):
>       self.check_array_boolarray_op(operator.add)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:478: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
_______________ TestArrayElementwiseOp.test_iadd_array_boolarray _______________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_iadd_array_boolarray>

    def test_iadd_array_boolarray(self):
>       self.check_array_boolarray_op(operator.iadd)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:481: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
_________ TestConvolve_param_0_{mode='valid'}.test_convolve_diff_types _________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_1_{mode='same'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_2_{mode='full'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
________ TestCorrelate_param_0_{mode='valid'}.test_correlate_diff_types ________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_1_{mode='full'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_2_{mode='same'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
_ TestHfft2_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(2, 5, 20)}.test_ihfft2 _

self = <<cupyx_tests.scipy_tests.fft_tests.test_fft.TestHfft2_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(2, 5, 20)} testMethod=test_ihfft2>  parameter: {'shape': (2, 5, 20), 's': None, 'axes': (0, 1, 2), 'norm': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int16'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(rtol=1e-4, atol=1e-7, accept_error=ValueError,
                                 contiguous_check=False)
    def test_ihfft2(self, xp, dtype):
        x = testing.shaped_random(self.shape, xp, dtype)
        x_orig = x.copy()
        out = _fft_module(xp).ihfft2(x, s=self.s, axes=self.axes,
                                     norm=self.norm)
>       testing.assert_array_equal(x, x_orig)

tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py:1685: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[ 31133,  18309, -28685,  16433,   7166,  -7192,  23554,  16424,
          -6898,   4488,  31804, -16339, -255...    7,      3,      3,      2,      1,      9,      7,      4,
              2,      2,      0,      4]]], dtype=int16)
y = array([[[5, 7, 6, 5, 4, 6, 4, 8, 9, 3, 7, 5, 5, 9, 0, 0, 0, 8, 7, 8],
        [9, 7, 4, 7, 1, 6, 1, 9, 5, 4, 2, 7, 4, ... 0, 1, 0, 7, 2, 3, 9, 7, 0],
        [1, 6, 5, 2, 9, 6, 5, 5, 7, 3, 3, 2, 1, 9, 7, 4, 2, 2, 0, 4]]],
      dtype=int16)
err_msg = '', verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(self, *args, **kw)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py", line 1685, in test_ihfft2
E           testing.assert_array_equal(x, x_orig)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_array.py", line 91, in assert_array_equal
E           numpy.testing.assert_array_equal(
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 930, in assert_array_equal
E           assert_array_compare(operator.__eq__, x, y, err_msg=err_msg,
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 840, in assert_array_compare
E           raise AssertionError(msg)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 112 / 200 (56%)
E       Max absolute difference: 32278
E       Max relative difference: 20841.
E        x: array([[[ 31133,  18309, -28685,  16433,   7166,  -7192,  23554,  16424,
E                 -6898,   4488,  31804, -16339, -25502,  30644,   5949,  16430,
E                 24906,  13106, -19113, -16311],...
E        y: array([[[5, 7, 6, 5, 4, 6, 4, 8, 9, 3, 7, 5, 5, 9, 0, 0, 0, 8, 7, 8],
E               [9, 7, 4, 7, 1, 6, 1, 9, 5, 4, 2, 7, 4, 5, 0, 6, 6, 6, 9, 6],
E               [3, 4, 6, 0, 6, 6, 2, 1, 3, 3, 5, 4, 9, 1, 2, 1, 6, 2, 4, 2],...

cupy/testing/_array.py:91: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int16'>
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f9366680850>  parameter: {'mode': 'grid-constant', 'order': 4}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([229.76997843, 598.96953239])
desired = array([3.06993892, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 590.96953239
E       Max relative difference: 73.87119155
E        x: array([229.769978, 598.969532])
E        y: array([3.069939, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f9366198820>  parameter: {'mode': 'grid-constant', 'order': 5}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([ 78.42728447, 201.97560613])
desired = array([3.12122783, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 193.97560613
E       Max relative difference: 24.24695077
E        x: array([ 78.427284, 201.975606])
E        y: array([3.121228, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d6f1610>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d5a1310>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d58ba30>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d4bd220>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d5af2e0>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d5b55b0>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d4bd790>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-1.6466675e-04],
        [-3.1765160e-06],
        [-2.8256103e-04],
        [ 1.0465207e-04],
        [-5.02...       [-1.4928388e-06],
        [-5.8970027e-06],
        [-2.4932410e-06],
        [-3.5395026e-06]]], dtype=float32)
desired = array([[[-8.12850668e-17],
        [-9.62678620e-17],
        [-7.64445911e-17],
        [ 6.90388762e-17],
        [-...   [-1.31306278e-18],
        [-2.34584224e-18],
        [-1.16198641e-18],
        [-3.16820747e-19]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 75 / 100 (75%)
E       Max absolute difference: 0.00034115
E       Max relative difference: 2.5044335e+14
E        x: array([[[-1.646668e-04],
E               [-3.176516e-06],
E               [-2.825610e-04],...
E        y: array([[[-8.128507e-17],
E               [-9.626786e-17],
E               [-7.644459e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935cfa0e80>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float32'>}
dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.46576144e-06],
        [-1.07652804e-05],
        [ 1.48250510e-05],
        [-2.88788979e-05],
        [-...   [ 3.59045725e-06],
        [ 3.90473633e-06],
        [ 2.02454498e-06],
        [ 1.08106917e-06]]], dtype=float32)
desired = array([[[-5.28892732e-17],
        [-4.68497761e-17],
        [-1.70810335e-16],
        [-1.91986781e-16],
        [-...   [-3.94138989e-18],
        [-8.65396191e-18],
        [ 1.07858407e-18],
        [-2.29544853e-18]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 40 / 100 (40%)
E       Max absolute difference: 0.00011814
E       Max relative difference: 9.6834375e+13
E        x: array([[[ 1.465761e-06],
E               [-1.076528e-05],
E               [ 1.482505e-05],...
E        y: array([[[-5.288927e-17],
E               [-4.684978e-17],
E               [-1.708103e-16],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935c9aecd0>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.    ... [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[   0.      ],
E               [   0.      ],
E               [   0.      ],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d4713a0>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d463af0>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  48.82195577],
        [  48.82195577],
        [ 290.39318135],
        [ 337.78017528],
        [ 112.1240... [ -53.24969236],
        [ -21.88859247],
        [  44.15090669],
        [  53.29762289],
        [  53.29762289]]])
desired = array([[[ 8.54663183e-03],
        [ 8.54663183e-03],
        [ 5.30645857e-02],
        [ 6.15797757e-02],
        [ ...126e-03],
        [-5.57818230e-04],
        [ 2.89445841e-04],
        [ 8.46143247e-05],
        [ 8.46143247e-05]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.88795612
E        x: array([[[  48.821956],
E               [  48.821956],
E               [ 290.393181],...
E        y: array([[[ 8.546632e-03],
E               [ 8.546632e-03],
E               [ 5.306459e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d14c910>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.71685805e+00],
        [ 4.71685805e+00],
        [ 2.76221015e+01],
        [ 3.32433453e+01],
        [ ...958e+00],
        [-1.62349834e+00],
        [ 1.50933488e+01],
        [ 1.97919669e+01],
        [ 1.97919669e+01]]])
desired = array([[[ 8.60075856e-03],
        [ 8.60075856e-03],
        [ 5.25533883e-02],
        [ 6.23449044e-02],
        [ ...600e-03],
        [-8.00397905e-04],
        [ 4.16976616e-04],
        [ 1.32949066e-04],
        [ 1.32949066e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248854
E        x: array([[[ 4.716858e+00],
E               [ 4.716858e+00],
E               [ 2.762210e+01],...
E        y: array([[[ 8.600759e-03],
E               [ 8.600759e-03],
E               [ 5.255339e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935cfc3850>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  53.29762289],
        [  51.0107262 ],
        [ 303.41199632],
        [ 352.92342892],
        [ 117.1507... [ -50.96485228],
        [ -20.9493958 ],
        [  42.25647769],
        [  51.0107262 ],
        [  48.82195577]]])
desired = array([[[ 8.46143247e-05],
        [ 8.50392545e-04],
        [ 5.27994291e-03],
        [ 6.12720698e-03],
        [ ...636e-02],
        [-5.60619571e-03],
        [ 2.90899427e-03],
        [ 8.50392545e-04],
        [ 8.54663183e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[  53.297623],
E               [  51.010726],
E               [ 303.411996],...
E        y: array([[[ 8.461432e-05],
E               [ 8.503925e-04],
E               [ 5.279943e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d5b5220>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.97919669e+01],
        [ 9.66208561e+00],
        [ 5.65815436e+01],
        [ 6.80961870e+01],
        [ ...577e+00],
        [-7.92562963e-01],
        [ 7.36830399e+00],
        [ 9.66208561e+00],
        [ 4.71685805e+00]]])
desired = array([[[ 1.32949066e-04],
        [ 1.06932821e-03],
        [ 6.53393769e-03],
        [ 7.75131221e-03],
        [ ...718e-02],
        [-6.43771396e-03],
        [ 3.35380211e-03],
        [ 1.06932821e-03],
        [ 8.60075856e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 1.979197e+01],
E               [ 9.662086e+00],
E               [ 5.658154e+01],...
E        y: array([[[ 1.329491e-04],
E               [ 1.069328e-03],
E               [ 6.533938e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d147640>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 5.63055219e+01],
        [-1.22528405e+02],
        [-3.83476709e+02],
        [-3.83476709e+02],
        [-...021e+00],
        [ 4.40535983e+00],
        [-2.69124172e+00],
        [-1.59183812e+00],
        [ 9.72456581e-01]]])
desired = array([[[ 1.27949283e-02],
        [-2.43606830e-02],
        [-7.91692940e-02],
        [-7.91692940e-02],
        [-...333e-03],
        [ 9.13158865e-04],
        [-5.54269262e-04],
        [-3.27391850e-04],
        [ 1.99955080e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2611.23242921
E       Max relative difference: 5747.85704324
E        x: array([[[ 5.630552e+01],
E               [-1.225284e+02],
E               [-3.834767e+02],...
E        y: array([[[ 1.279493e-02],
E               [-2.436068e-02],
E               [-7.916929e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

self = <<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f935d0b6700>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>
args = (), kw = {'dtype': <class 'numpy.float64'>}
dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(self, *args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(self, *args, **kw)

cupy/testing/_helper.py:825: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.16965077e+00],
        [-1.18699209e+01],
        [-3.36177788e+01],
        [-3.36177788e+01],
        [-...671e-01],
        [ 6.07624141e-01],
        [-3.96545295e-01],
        [-2.61764771e-01],
        [ 1.70742628e-01]]])
desired = array([[[ 1.44354197e-02],
        [-2.67893098e-02],
        [-8.45564959e-02],
        [-8.45564959e-02],
        [-...699e-03],
        [ 1.49724992e-03],
        [-9.55056276e-04],
        [-6.25982935e-04],
        [ 4.07383783e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 270.54779997
E       Max relative difference: 678.67662434
E        x: array([[[ 4.169651e+00],
E               [-1.186992e+01],
E               [-3.361778e+01],...
E        y: array([[[ 1.443542e-02],
E               [-2.678931e-02],
E               [-8.455650e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}.test_convolve_fft _
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
cupy/testing/_array.py:24: in assert_allclose
    numpy.testing.assert_allclose(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[-1.4832e+04, -1.9312e+04, -1.6264e+04, -1.4704e+04,
         -1.1432e+04, -1.7440e+04, -1.1800e+04, -2.4080e+...438e+01,  2.5781e+01,  3.9344e+01,
          3.2344e+01,  4.0750e+01,  2.3844e+01, -7.5977e-01]]],
      dtype=float16)
y = array([[[ 30.12 ,  78.5  , 117.3  , 116.1  ,  98.56 ,  98.6  ,  95.75 ,
         119.1  , 143.   , 143.6  ,  85.5  ,  ... ,  68.8  ,  60.4  ,  38.7  ,  61.03 ,  47.47 ,
          68.94 ,  60.25 ,  72.94 ,  56.97 ,   9.93 ]]], dtype=float16)
func = <function assert_array_compare.<locals>.<lambda> at 0x7f934f563dc0>
hasval = '+inf'

    def func_assert_same_pos(x, y, func=isnan, hasval='nan'):
        """Handling nan/inf.
    
        Combine results of running func on x and y, checking that they are True
        at the same locations.
    
        """
        x_id = func(x)
        y_id = func(y)
        # We include work-arounds here to handle three types of slightly
        # pathological ndarray subclasses:
        # (1) all() on `masked` array scalars can return masked arrays, so we
        #     use != True
        # (2) __eq__ on some ndarray subclasses returns Python booleans
        #     instead of element-wise comparisons, so we cast to bool_() and
        #     use isinstance(..., bool) checks
        # (3) subclasses with bare-bones __array_function__ implementations may
        #     not implement np.all(), so favor using the .all() method
        # We are not committed to supporting such subclasses, but it's nice to
        # support them if possible.
        if bool_(x_id == y_id).all() != True:
            msg = build_err_msg([x, y],
                                err_msg + '\nx and y %s location mismatch:'
                                % (hasval), verbose=verbose, header=header,
                                names=('x', 'y'), precision=precision)
>           raise AssertionError(msg)
E           AssertionError: 
E           Not equal to tolerance rtol=0.001, atol=0.001
E           
E           x and y +inf location mismatch:
E            x: array([[[-1.4832e+04, -1.9312e+04, -1.6264e+04, -1.4704e+04,
E                    -1.1432e+04, -1.7440e+04, -1.1800e+04, -2.4080e+04,
E                    -2.6000e+04, -1.0328e+04,  1.2461e+01,  8.4033e-01],...
E            y: array([[[ 30.12 ,  78.5  , 117.3  , 116.1  ,  98.56 ,  98.6  ,  95.75 ,
E                    119.1  , 143.   , 143.6  ,  85.5  ,  23.11 ],
E                   [ 73.4  , 147.9  , 215.4  , 224.8  , 189.5  , 154.   ,  90.2  ,...

/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py:740: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float16'>
_ TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}.test_correlate_fft _
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-2.55733932e+02, -4.12401520e+02, -5.82110535e+02,
         -5.98984436e+02, -4.93566040e+02, -5.58749756e+02..., -5.37425041e+01,  2.76531482e+00,
         -3.85168953e+01,  8.76324463e+01,  1.00348030e+02]]],
      dtype=float32)
desired = array([[[  7.8674293,  45.3722   ,  60.898335 ,  54.842022 ,
          48.07059  ,  42.814228 ,  52.615826 ,  48.42525...42563  , 126.12969  , 119.81335  ,
         143.07594  , 136.70508  ,  97.919945 ,  38.007053 ]]],
      dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 359 / 360 (99.7%)
E       Max absolute difference: 2496.187
E       Max relative difference: 65.76586
E        x: array([[[-2.557339e+02, -4.124015e+02, -5.821105e+02, -5.989844e+02,
E                -4.935660e+02, -5.587498e+02, -4.499715e+02, -7.117944e+02,
E                -7.355955e+02, -6.395404e+02, -4.031465e+02, -1.384108e+02],...
E        y: array([[[  7.867429,  45.3722  ,  60.898335,  54.842022,  48.07059 ,
E                 42.814228,  52.615826,  48.42525 ,  76.05639 ,  77.71094 ,
E                 35.934895,   4.535131],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}.test_fftconvolve _
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 7.95231857e+01,  7.18280716e+01, -1.08831396e+01,
         -2.99680119e+01, -3.25485992e+01,  1.26672630e+01..., -5.21641541e+02, -8.12674072e+02,
         -6.47990906e+02, -5.10732574e+02, -3.22703217e+02]]],
      dtype=float32)
desired = array([[[ 30.11964 ,  78.50114 , 117.31052 , 116.12192 ,  98.5526  ,
          98.59048 ,  95.745415, 119.16964 , 143....          61.03017 ,  47.46052 ,  68.94269 ,  60.25647 ,  72.94773 ,
          56.956516,   9.927667]]], dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 360 / 360 (100%)
E       Max absolute difference: 2190.1472
E       Max relative difference: 51.280254
E        x: array([[[ 7.952319e+01,  7.182807e+01, -1.088314e+01, -2.996801e+01,
E                -3.254860e+01,  1.266726e+01, -1.785283e+01,  3.703740e+01,
E                 4.268585e+01, -9.254364e+01, -1.219189e+02, -3.967020e+01],...
E        y: array([[[ 30.11964 ,  78.50114 , 117.31052 , 116.12192 ,  98.5526  ,
E                 98.59048 ,  95.745415, 119.16964 , 143.04192 , 143.71674 ,
E                 85.50938 ,  23.112478],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestFFTConvolve_param_44_{mode='valid', size1=(3, 4, 10), size2=3}.test_fftconvolve _
cupy/testing/_helper.py:825: in test_func
    impl(self, *args, **kw)
cupy/testing/_helper.py:343: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:495: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[1859.4984 , 1641.9331 , -251.8623 ,  394.3545 , 1795.8146 ,
         1930.7523 , 1313.777  ,  692.71796],
   ...9.5149 , 1250.4918 , 1028.6731 , 1570.8129 , 1373.7471 ,
         1294.2035 , 2302.3933 ,  263.91635]]], dtype=float32)
desired = array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
         714.88525, 728.84973, 808.5652 ],
        [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
         719.43756, 815.77496, 851.23706]]], dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 16 / 16 (100%)
E       Max absolute difference: 1486.6184
E       Max relative difference: 2.130103
E        x: array([[[1859.4984 , 1641.9331 , -251.8623 ,  394.3545 , 1795.8146 ,
E                1930.7523 , 1313.777  ,  692.71796],
E               [ 959.5149 , 1250.4918 , 1028.6731 , 1570.8129 , 1373.7471 ,
E                1294.2035 , 2302.3933 ,  263.91635]]], dtype=float32)
E        y: array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
E                714.88525, 728.84973, 808.5652 ],
E               [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
E                719.43756, 815.77496, 851.23706]]], dtype=float32)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestLsmr_param_24_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_24_{damp=0.0, format='csr', m=30, n=20, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_25_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_25_{damp=0.0, format='csr', m=30, n=20, use_linear_o...=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_26_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_26_{damp=0.0, format='csr', m=30, n=20, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_27_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_27_{damp=0.0, format='csr', m=30, n=20, use_linear_o...d=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_28_{damp=0.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_28_{damp=0.0, format='csr', m=30, n=30, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_30_{damp=0.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_30_{damp=0.0, format='csr', m=30, n=30, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_32_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_32_{damp=0.0, format='csr', m=40, n=20, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_33_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_33_{damp=0.0, format='csr', m=40, n=20, use_linear_o...=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_34_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_34_{damp=0.0, format='csr', m=40, n=20, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_35_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_35_{damp=0.0, format='csr', m=40, n=20, use_linear_o...d=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_36_{damp=0.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_36_{damp=0.0, format='csr', m=40, n=30, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_38_{damp=0.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_38_{damp=0.0, format='csr', m=40, n=30, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_40_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_40_{damp=0.0, format='csr', m=50, n=20, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_41_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_41_{damp=0.0, format='csr', m=50, n=20, use_linear_o...=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_42_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_42_{damp=0.0, format='csr', m=50, n=20, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_43_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_43_{damp=0.0, format='csr', m=50, n=20, use_linear_o...d=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_44_{damp=0.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_44_{damp=0.0, format='csr', m=50, n=30, use_linear_o...od=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_46_{damp=0.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_46_{damp=0.0, format='csr', m=50, n=30, use_linear_o...hod=test_sparse>  parameter: {'damp': 0.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_96_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_96_{damp=1.0, format='csr', m=30, n=20, use_linear_o...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_97_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_97_{damp=1.0, format='csr', m=30, n=20, use_linear_o...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_98_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_98_{damp=1.0, format='csr', m=30, n=20, use_linear_o...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_99_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_99_{damp=1.0, format='csr', m=30, n=20, use_linear_o...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_100_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_100_{damp=1.0, format='csr', m=30, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_101_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_101_{damp=1.0, format='csr', m=30, n=30, use_linear_...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_102_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_102_{damp=1.0, format='csr', m=30, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_103_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_103_{damp=1.0, format='csr', m=30, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_104_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_104_{damp=1.0, format='csr', m=40, n=20, use_linear_...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_105_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_105_{damp=1.0, format='csr', m=40, n=20, use_linear_...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_106_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_106_{damp=1.0, format='csr', m=40, n=20, use_linear_...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_107_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_107_{damp=1.0, format='csr', m=40, n=20, use_linear_...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_108_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_108_{damp=1.0, format='csr', m=40, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_109_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_109_{damp=1.0, format='csr', m=40, n=30, use_linear_...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_110_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_110_{damp=1.0, format='csr', m=40, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_111_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_111_{damp=1.0, format='csr', m=40, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_112_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_112_{damp=1.0, format='csr', m=50, n=20, use_linear_...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_113_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_113_{damp=1.0, format='csr', m=50, n=20, use_linear_...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_114_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_114_{damp=1.0, format='csr', m=50, n=20, use_linear_...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_115_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_115_{damp=1.0, format='csr', m=50, n=20, use_linear_...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_116_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_116_{damp=1.0, format='csr', m=50, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_117_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_117_{damp=1.0, format='csr', m=50, n=30, use_linear_...=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_118_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_118_{damp=1.0, format='csr', m=50, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_119_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_119_{damp=1.0, format='csr', m=50, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 1.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_168_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_168_{damp=2.0, format='csr', m=30, n=20, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_169_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_169_{damp=2.0, format='csr', m=30, n=20, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_170_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_170_{damp=2.0, format='csr', m=30, n=20, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_171_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_171_{damp=2.0, format='csr', m=30, n=20, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_172_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_172_{damp=2.0, format='csr', m=30, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_173_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_173_{damp=2.0, format='csr', m=30, n=30, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_174_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_174_{damp=2.0, format='csr', m=30, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_175_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_175_{damp=2.0, format='csr', m=30, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 30, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INTERNAL_ERROR

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_176_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_176_{damp=2.0, format='csr', m=40, n=20, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_177_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_177_{damp=2.0, format='csr', m=40, n=20, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_178_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_178_{damp=2.0, format='csr', m=40, n=20, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_179_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_179_{damp=2.0, format='csr', m=40, n=20, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_180_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_180_{damp=2.0, format='csr', m=40, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_181_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_181_{damp=2.0, format='csr', m=40, n=30, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_182_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_182_{damp=2.0, format='csr', m=40, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_183_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_183_{damp=2.0, format='csr', m=40, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 40, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_184_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_184_{damp=2.0, format='csr', m=50, n=20, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_185_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_185_{damp=2.0, format='csr', m=50, n=20, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_186_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_186_{damp=2.0, format='csr', m=50, n=20, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_187_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_187_{damp=2.0, format='csr', m=50, n=20, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 20, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_188_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_188_{damp=2.0, format='csr', m=50, n=30, use_linear_...od=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': False, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_189_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=False, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_189_{damp=2.0, format='csr', m=50, n=30, use_linear_...=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': False, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_190_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_190_{damp=2.0, format='csr', m=50, n=30, use_linear_...hod=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': True, 'x0': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
_ TestLsmr_param_191_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=True, x0='ones'}.test_sparse _

self = <<cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLsmr_param_191_{damp=2.0, format='csr', m=50, n=30, use_linear_...d=test_sparse>  parameter: {'damp': 2.0, 'format': 'csr', 'm': 50, 'n': 30, 'use_linear_operator': True, 'x0': 'ones'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-1, atol=1e-1, sp_name='sp')
    def test_sparse(self, xp, sp):
        if runtime.is_hip and self.format == 'csc':
            pytest.xfail('may be buggy')  # trans=True
        if (self.damp == 0 and self.x0 == 'ones' and self.n != 20):
            raise unittest.SkipTest
        a = self._make_matrix(xp)
        a = sp.coo_matrix(a).asformat(self.format)
        if self.use_linear_operator:
            a = sp.linalg.aslinearoperator(a)
>       return self._test_lsmr(xp, sp, a)[0]

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1363: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1351: in _test_lsmr
    return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
cupyx/scipy/sparse/linalg/_solve.py:190: in lsmr
    v = rmatvec(u)
cupyx/scipy/sparse/linalg/_interface.py:109: in rmatvec
    y = self._rmatvec(x)
cupyx/scipy/sparse/linalg/_interface.py:128: in _rmatvec
    return self.H.matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:89: in matvec
    y = self._matvec(x)
cupyx/scipy/sparse/linalg/_interface.py:78: in _matvec
    return self.matmat(x.reshape(-1, 1))
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupyx/scipy/sparse/base.py:334: in dot
    return self * other
cupyx/scipy/sparse/csc.py:142: in __mul__
    return csrmm(self.T, cupy.asfortranarray(other), transa=True)
cupy/cusparse.py:1454: in spmm
    buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
cupy_backends/cuda/libs/cusparse.pyx:4815: in cupy_backends.cuda.libs.cusparse.spMM
    cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
cupy_backends/cuda/libs/cusparse.pyx:4823: in cupy_backends.cuda.libs.cusparse.spMM
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CuSparseError(status)
E   AssertionError: Only cupy raises error
E   
E   Traceback (most recent call last):
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/testing/_helper.py", line 47, in _call_func
E       result = impl(self, *args, **kw)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1363, in test_sparse
E       return self._test_lsmr(xp, sp, a)[0]
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 1351, in _test_lsmr
E       return sp.linalg.lsmr(a, b, x0=x0, damp=self.damp)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py", line 190, in lsmr
E       v = rmatvec(u)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 109, in rmatvec
E       y = self._rmatvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 128, in _rmatvec
E       return self.H.matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 89, in matvec
E       y = self._matvec(x)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 78, in _matvec
E       return self.matmat(x.reshape(-1, 1))
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E       Y = self._matmat(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E       return self.A.dot(X)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/base.py", line 334, in dot
E       return self * other
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/csc.py", line 142, in __mul__
E       return csrmm(self.T, cupy.asfortranarray(other), transa=True)
E     File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupy/cusparse.py", line 1454, in spmm
E       buff_size = _cusparse.spMM(handle, op_a, op_b, alpha.data, desc_a.desc,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4815, in cupy_backends.cuda.libs.cusparse.spMM
E       cpdef spMM(intptr_t handle, Operation opA, Operation opB, intptr_t alpha,
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 4823, in cupy_backends.cuda.libs.cusparse.spMM
E       check_status(status)
E     File "cupy_backends/cuda/libs/cusparse.pyx", line 1512, in cupy_backends.cuda.libs.cusparse.check_status
E       raise CuSparseError(status)
E   cupy_backends.cuda.libs.cusparse.CuSparseError: HIPSPARSE_STATUS_INVALID_VALUE

cupy_backends/cuda/libs/cusparse.pyx:1512: AssertionError
____________________ TestCustomStruct.test_builtin_vectors _____________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_builtin_vectors>

    def test_builtin_vectors(self):
>       output = example_test.run_example('custom_struct/builtin_vectors.py')

tests/example_tests/test_custom_struct.py:10: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f9342a60490>
stdout = b'Traceback (most recent call last):\n  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/te...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py", line 48, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py", line 40, in main
    kernel((1,), (N,), args)
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

_____________________ TestCustomStruct.test_complex_struct _____________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_complex_struct>

    def test_complex_struct(self):
>       output = example_test.run_example('custom_struct/complex_struct.py')

tests/example_tests/test_custom_struct.py:25: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f9342a58550>
stdout = b'Overall structure itemsize: 80 bytes\nStructure members itemsize: [16  1 16  2 24]\nStructure members offsets: [ 0 1...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Overall structure itemsize: 80 bytes
Structure members itemsize: [16  1 16  2 24]
Structure members offsets: [ 0 16 24 40 48]
Complex structure value:
  [((0, 1, 2, 3), (4,), (5., 6.), (7,), (8, 9, 10))]
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py", line 132, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py", line 122, in main
    kernel((1,), (N,), (s, out))
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

_____________________ TestCustomStruct.test_packed_matrix ______________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_packed_matrix>

    def test_packed_matrix(self):
>       output = example_test.run_example('custom_struct/packed_matrix.py')

tests/example_tests/test_custom_struct.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f9341f66b20>
stdout = b'Traceback (most recent call last):\n  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/te...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py", line 91, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py", line 81, in main
    kernel((1,), (N,), args)
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

=============================== warnings summary ===============================
tests/cupy_tests/core_tests/fusion_tests/test_array.py: 1 warning
tests/cupy_tests/math_tests/test_sumprod.py: 19 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: overflow encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/core_tests/fusion_tests/test_routines.py::TestFusionNumericalReduction_param_1_{func='prod'}::test_reduction
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}::test_nansum_all
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}::test_nansum_axis_transposed
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}::test_nansum_all
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}::test_nansum_axis_transposed
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: overflow encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_0_{type_l='poly1d', type_r='ndarray'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_3_{type_l='ndarray', type_r='ndarray'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_array
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in multiply
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_1_{type_l='poly1d', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_4_{type_l='ndarray', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in half_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_1_{type_l='poly1d', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_4_{type_l='ndarray', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in byte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_1_{type_l='poly1d', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_4_{type_l='ndarray', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in short_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_1_{type_l='poly1d', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_4_{type_l='ndarray', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ubyte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_1_{type_l='poly1d', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval_param_4_{type_l='ndarray', type_r='numpy_scalar'}::test_polyval
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ushort_scalars
    y = y * x + p[i]

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in power
    absx **= ord

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in reciprocal
    absx **= ord

tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf
tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf_nan
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/numeric.py:2276: RuntimeWarning: overflow encountered in absolute
    return less_equal(abs(x-y), atol + rtol * abs(y))

tests/cupy_tests/math_tests/test_sumprod.py: 15 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: invalid value encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}::test_nansum_all
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}::test_nansum_axis_transposed
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}::test_nansum_all
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}::test_nansum_axis_transposed
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: invalid value encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/math_tests/test_sumprod.py: 32 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupy_tests/math_tests/test_sumprod.py:800: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all_transposed2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes4
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axis_transposed2
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_2_{op='variance'}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_3_{op='standard_deviation'}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:47: RuntimeWarning: overflow encountered in reduce
    return umr_sum(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/statistics_tests/test_meanvar.py: 32 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupy_tests/statistics_tests/test_meanvar.py:114: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_4_{axis=0, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_5_{axis=0, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_6_{axis=0, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_7_{axis=0, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_8_{axis=1, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_9_{axis=1, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_10_{axis=1, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}::test_nanmedian
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian_param_11_{axis=1, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}::test_nanmedian
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/nanfunctions.py:1113: RuntimeWarning: All-NaN slice encountered
    r, k = function_base._ureduce(a, func=_nanmedian, axis=axis, out=out,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_1_{func='mean', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_2_{func='mean', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_3_{func='mean', params=((0, 0), 1)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_4_{func='mean', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_5_{func='mean', params=((0, 0, 0), (0, 2))}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
    return _methods._mean(a, axis=axis, dtype=dtype,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_1_{func='mean', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_2_{func='mean', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_4_{func='mean', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_1_{func='mean', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_2_{func='mean', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_4_{func='mean', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_1_{func='mean', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_2_{func='mean', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_4_{func='mean', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:168: RuntimeWarning: invalid value encountered in true_divide
    ret = arr.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_7_{func='std', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_8_{func='std', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_9_{func='std', params=((0, 0), 1)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_10_{func='std', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_11_{func='std', params=((0, 0, 0), (0, 2))}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:233: RuntimeWarning: Degrees of freedom <= 0 for slice
    ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_7_{func='std', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_8_{func='std', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_10_{func='std', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_13_{func='var', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_14_{func='var', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_16_{func='var', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:194: RuntimeWarning: invalid value encountered in true_divide
    arrmean = um.true_divide(

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_7_{func='std', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_8_{func='std', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_10_{func='std', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_13_{func='var', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_14_{func='var', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_16_{func='var', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_7_{func='std', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_8_{func='std', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_10_{func='std', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_13_{func='var', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_14_{func='var', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_16_{func='var', params=((0, 0, 0), None)}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_13_{func='var', params=((0,), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_14_{func='var', params=((0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_15_{func='var', params=((0, 0), 1)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_16_{func='var', params=((0, 0, 0), None)}::test_external_mean_zero_len
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength_param_17_{func='var', params=((0, 0, 0), (0, 2))}::test_external_mean_zero_len
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3621: RuntimeWarning: Degrees of freedom <= 0 for slice
    return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupyx_tests/jit_tests/test_raw.py: 21 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/jit/_builtin_funcs.py:334: RuntimeWarning: mask 4294967295 is ignored on HIP
    warnings.warn(f'mask {mask} is ignored on HIP', RuntimeWarning)

tests/cupyx_tests/jit_tests/test_raw.py::TestRaw::test_syncwarp_mask
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/jit/_builtin_funcs.py:131: RuntimeWarning: mask <Data code = "m", type = int> is ignored on HIP
    warnings.warn(f'mask {mask} is ignored on HIP', RuntimeWarning)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_217_{cval=nan, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_220_{cval=nan, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_223_{cval=nan, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_226_{cval=inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_229_{cval=inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_232_{cval=inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_235_{cval=-inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_238_{cval=-inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_241_{cval=-inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:670: RuntimeWarning: invalid value encountered in remainder
    float_out = self._shift(xp, scp, a.astype(xp.float64)) % 1

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:684: RuntimeWarning: invalid value encountered in true_divide
    return sum / numpy.asanyarray(count).astype(numpy.float64)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py: 28 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:736: RuntimeWarning: invalid value encountered in true_divide
    return sum_c_sq / np.asanyarray(count).astype(float)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_0_{im=(10,), mysize=3, noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_1_{im=(10,), mysize=3, noise=True}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_2_{im=(10,), mysize=4, noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_3_{im=(10,), mysize=4, noise=True}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}::test_wiener
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: divide by zero encountered in true_divide
    res *= (1 - noise / lVar)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_0_{im=(10,), mysize=3, noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_1_{im=(10,), mysize=3, noise=True}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_2_{im=(10,), mysize=4, noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_3_{im=(10,), mysize=4, noise=True}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}::test_wiener
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}::test_wiener
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: invalid value encountered in multiply
    res *= (1 - noise / lVar)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 28 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/base.py:595: RuntimeWarning: divide by zero encountered in true_divide
    return np.true_divide(self.todense(), other)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 32 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/base.py:595: RuntimeWarning: invalid value encountered in true_divide
    return np.true_divide(self.todense(), other)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 96 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py:1882: SparseEfficiencyWarning: Taking maximum (minimum) with > 0 (< 0) number results to a dense matrix.
    return getattr(a, self.opt)(0.5)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 96 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py:1887: SparseEfficiencyWarning: Taking maximum (minimum) with > 0 (< 0) number results to a dense matrix.
    return getattr(a, self.opt)(-0.5)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in less
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in greater
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in less_equal
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in greater_equal
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 6 warnings
tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 368 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:125: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:116: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray_sparse(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 12 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:82: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_intXint(row, col, x.flat[0])

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 368 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:125: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:116: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray_sparse(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 12 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:82: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_intXint(row, col, x.flat[0])

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:318: SparseEfficiencyWarning: splu requires CSC matrix format
    warn('splu requires CSC matrix format', SparseEfficiencyWarning)

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:407: SparseEfficiencyWarning: splu requires CSC matrix format
    warn('splu requires CSC matrix format', SparseEfficiencyWarning)

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 48 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:553: SparseEfficiencyWarning: CSR matrix format is required. Converting to CSR matrix.
    warn('CSR matrix format is required. Converting to CSR matrix.',

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/cupyx/scipy/sparse/linalg/_solve.py:435: SparseEfficiencyWarning: CSR or CSC format is required. Converting to CSR format.
    warnings.warn('CSR or CSC format is required. Converting to CSR '

-- Docs: https://docs.pytest.org/en/stable/warnings.html
- generated html file: file:///home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.DLYBtVxuid/cupy/_output/report.html -
=========================== short test summary info ============================
FAILED tests/cupy_tests/core_tests/test_ndarray.py::TestNdarrayCopy::test_copy_multi_device_with_stream
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_add_array_boolarray
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_iadd_array_boolarray
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_0_{mode='valid'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_1_{mode='same'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_2_{mode='full'}::test_convolve_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_0_{mode='valid'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_1_{mode='full'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_2_{mode='same'}::test_correlate_diff_types
FAILED tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py::TestHfft2_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(2, 5, 20)}::test_ihfft2
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}::test_convolve_fft
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}::test_correlate_fft
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve_param_12_{mode='full', size1=(3, 4, 10), size2=3}::test_fftconvolve
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve_param_44_{mode='valid', size1=(3, 4, 10), size2=3}::test_fftconvolve
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_24_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_25_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_26_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_27_{damp=0.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_28_{damp=0.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_30_{damp=0.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_32_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_33_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_34_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_35_{damp=0.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_36_{damp=0.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_38_{damp=0.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_40_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_41_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_42_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_43_{damp=0.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_44_{damp=0.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_46_{damp=0.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_96_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_97_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_98_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_99_{damp=1.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_100_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_101_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_102_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_103_{damp=1.0, format='csr', m=30, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_104_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_105_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_106_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_107_{damp=1.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_108_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_109_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_110_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_111_{damp=1.0, format='csr', m=40, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_112_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_113_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_114_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_115_{damp=1.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_116_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_117_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_118_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_119_{damp=1.0, format='csr', m=50, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_168_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_169_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_170_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_171_{damp=2.0, format='csr', m=30, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_172_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_173_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_174_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_175_{damp=2.0, format='csr', m=30, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_176_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_177_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_178_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_179_{damp=2.0, format='csr', m=40, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_180_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_181_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_182_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_183_{damp=2.0, format='csr', m=40, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_184_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_185_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_186_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_187_{damp=2.0, format='csr', m=50, n=20, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_188_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=False, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_189_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=False, x0='ones'}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_190_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=True, x0=None}::test_sparse
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLsmr_param_191_{damp=2.0, format='csr', m=50, n=30, use_linear_operator=True, x0='ones'}::test_sparse
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_builtin_vectors
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_complex_struct
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_packed_matrix
= 101 failed, 83756 passed, 8857 skipped, 647 deselected, 4431 xfailed, 1532 warnings in 29652.76s (8:14:12) =
