master: 05d9044 Merge pull request #5828 from takagi/from-big-endian
OS                        : Linux-5.4.0-65-generic-x86_64-with-glibc2.27
Python Version            : 3.8.7
CuPy Version              : 10.0.0b3
CuPy Platform             : AMD ROCm
NumPy Version             : 1.19.5
SciPy Version             : 1.6.1
Cython Build Version      : 0.29.22
Cython Runtime Version    : 0.29.22
CUDA Root                 : /opt/rocm
hipcc PATH                : /opt/rocm/bin/hipcc
CUDA Build Version        : 40321300
CUDA Driver Version       : 330500
CUDA Runtime Version      : 40321300
cuBLAS Version            : 23900
cuFFT Version             : 100
cuRAND Version            : 201009
cuSOLVER Version          : (3, 13, 0)
cuSPARSE Version          : 101007
NVRTC Version             : (9, 0)
Thrust Version            : 101100
CUB Build Version         : 201009
Jitify Build Version      : None
cuDNN Build Version       : None
cuDNN Version             : None
NCCL Build Version        : 2804
NCCL Runtime Version      : 2804
cuTENSOR Version          : None
cuSPARSELt Build Version  : None
Device 0 Name             : Device 738c
Device 0 Arch             : gfx908:sramecc+:xnack-
Device 0 PCI Bus ID       : 0000:63:00.0
Device 1 Name             : Device 738c
Device 1 Arch             : gfx908:sramecc+:xnack-
Device 1 PCI Bus ID       : 0000:43:00.0
Device 2 Name             : Device 738c
Device 2 Arch             : gfx908:sramecc+:xnack-
Device 2 PCI Bus ID       : 0000:26:00.0
Device 3 Name             : Device 738c
Device 3 Arch             : gfx908:sramecc+:xnack-
Device 3 PCI Bus ID       : 0000:03:00.0
============================= test session starts ==============================
platform linux -- Python 3.8.7, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
rootdir: /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy, configfile: setup.cfg
plugins: html-3.1.1, metadata-1.11.0
collected 97957 items / 661 deselected / 2 skipped / 97294 selected

tests/cupy_tests/test_cublas.py ........................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  0%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  1%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
........................................................................ [  2%]
.................................................x.x....x.x............. [  2%]
....................                                                     [  2%]
tests/cupy_tests/test_cudnn.py sssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  2%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  3%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss             [  4%]
tests/cupy_tests/test_cusolver.py ssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssss................................ssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  4%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  5%]
ssssssssssssssssssssssssssssssssss                                       [  5%]
tests/cupy_tests/test_cusparse.py ..x.x.x.x..x..x..x..x................. [  5%]
.......xxx.xxx....................x.x.x.xssssssssssssssss.....x.xx.x..x. [  5%]
x.x.xx.x..x.x.x.xx.x..x.x.x.xx.x..x.x.x.xx.x..x.x.x.xx.x..x.x.x.xx.x..x. [  5%]
x.x.xx.x..x.x...xxxx....xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx.... [  5%]
xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx.... [  5%]
xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx....xx..xxxx....xx.....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx... [  5%]
.xx....xx....xx....xx....xx....xx....xx....xx....xx....xx....xx......... [  6%]
.................xxxxxxxxxxxxxxxxxx..................                    [  6%]
tests/cupy_tests/test_cutensor.py ssssssssssssssssssssssssssssssssssssss [  6%]
ssssssssssssssssssssssssssssssssssssssss                                 [  6%]
tests/cupy_tests/test_init.py ..s........                                [  6%]
tests/cupy_tests/test_ndim.py ............                               [  6%]
tests/cupy_tests/test_numpy_interop.py ..x......                         [  6%]
tests/cupy_tests/test_type_routines.py ................................. [  6%]
.                                                                        [  6%]
tests/cupy_tests/array_api_tests/test_array_object.py ...                [  6%]
tests/cupy_tests/array_api_tests/test_creation_functions.py ............ [  6%]
.                                                                        [  6%]
tests/cupy_tests/array_api_tests/test_elementwise_functions.py ..        [  6%]
tests/cupy_tests/binary_tests/test_elementwise.py ......                 [  6%]
tests/cupy_tests/binary_tests/test_packing.py .........                  [  6%]
tests/cupy_tests/core_tests/test_array_function.py .....                 [  6%]
tests/cupy_tests/core_tests/test_carray.py .....                         [  6%]
tests/cupy_tests/core_tests/test_core.py ......                          [  6%]
tests/cupy_tests/core_tests/test_cub_reduction.py ...................... [  6%]
...                                                                      [  6%]
tests/cupy_tests/core_tests/test_dlpack.py ..ss....                      [  6%]
tests/cupy_tests/core_tests/test_elementwise.py ................         [  6%]
tests/cupy_tests/core_tests/test_flags.py .............................  [  6%]
tests/cupy_tests/core_tests/test_function.py .....                       [  6%]
tests/cupy_tests/core_tests/test_gufuncs.py ............................ [  6%]
................................                                         [  6%]
tests/cupy_tests/core_tests/test_internal.py ........................... [  6%]
...............................................................          [  6%]
tests/cupy_tests/core_tests/test_iter.py ............                    [  6%]
tests/cupy_tests/core_tests/test_ndarray.py ..........................ss [  6%]
ssss.................................................................... [  6%]
.......................F....sss...............                           [  6%]
tests/cupy_tests/core_tests/test_ndarray_adv_indexing.py ............... [  6%]
........................................................................ [  6%]
........................................................................ [  6%]
........................................................................ [  6%]
.............................................                            [  6%]
tests/cupy_tests/core_tests/test_ndarray_complex_ops.py ................ [  7%]
.....                                                                    [  7%]
tests/cupy_tests/core_tests/test_ndarray_contiguity.py .                 [  7%]
tests/cupy_tests/core_tests/test_ndarray_conversion.py .......xx..       [  7%]
tests/cupy_tests/core_tests/test_ndarray_copy_and_view.py .............. [  7%]
.......................F..sssssss                                        [  7%]
tests/cupy_tests/core_tests/test_ndarray_cuda_array_interface.py sssssss [  7%]
sssssssssssssssssssssssssssssssssssssssssssssssss                        [  7%]
tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py .F........... [  7%]
........................................F............................... [  7%]
...................................................................      [  7%]
tests/cupy_tests/core_tests/test_ndarray_get.py ............             [  7%]
tests/cupy_tests/core_tests/test_ndarray_indexing.py xxxx..........x...x [  7%]
........x..........x.............................                        [  7%]
tests/cupy_tests/core_tests/test_ndarray_math.py ......................s [  7%]
sssssssssss                                                              [  7%]
tests/cupy_tests/core_tests/test_ndarray_owndata.py ...                  [  7%]
tests/cupy_tests/core_tests/test_ndarray_reduction.py .................. [  7%]
........................................................................ [  7%]
........................................................................ [  7%]
................................                                         [  7%]
tests/cupy_tests/core_tests/test_ndarray_scatter.py .................... [  7%]
........................................................................ [  7%]
...............................................................          [  7%]
tests/cupy_tests/core_tests/test_ndarray_ufunc.py .........              [  7%]
tests/cupy_tests/core_tests/test_ndarray_unary_op.py ..................s [  7%]
....                                                                     [  7%]
tests/cupy_tests/core_tests/test_raw.py .ss.........sss..s.s.s........ss [  7%]
.........sss..s.s.s........ss.........sss..s.s.s......ssssssssssssssssss [  7%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s [  7%]
s.......sssss....s.s......sssssssssssssssssssssssssssss                  [  8%]
tests/cupy_tests/core_tests/test_reduction.py .......................    [  8%]
tests/cupy_tests/core_tests/test_scan.py ....                            [  8%]
tests/cupy_tests/core_tests/test_syncdetect.py ....                      [  8%]
tests/cupy_tests/core_tests/test_userkernel.py ....sss.............      [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_array.py ................. [  8%]
........................................................................ [  8%]
....................................................                     [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_indexing.py .............. [  8%]
.................s                                                       [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_kernel_cache.py ....       [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_misc.py .......s.......... [  8%]
........                                                                 [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_optimization.py .......... [  8%]
....                                                                     [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_reduction.py ............. [  8%]
........................................................................ [  8%]
.........................................................s.s.s.s.s.s.s.s [  8%]
.s.ssssssssssssssssss.sss                                                [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_routines.py .............. [  8%]
........................................................................ [  8%]
..............                                                           [  8%]
tests/cupy_tests/core_tests/fusion_tests/test_ufunc.py ................. [  8%]
......................................................                   [  8%]
tests/cupy_tests/creation_tests/test_basic.py .......................... [  8%]
...........................................................s............ [  8%]
....s.                                                                   [  8%]
tests/cupy_tests/creation_tests/test_from_data.py ssssssssssssssssssssss [  8%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss. [  8%]
........................................................................ [  8%]
............                                                             [  8%]
tests/cupy_tests/creation_tests/test_matrix.py ......................... [  8%]
.................................                                        [  9%]
tests/cupy_tests/creation_tests/test_ranges.py ......................... [  9%]
..............................................................           [  9%]
tests/cupy_tests/cuda_tests/test_compiler.py sssssss........             [  9%]
tests/cupy_tests/cuda_tests/test_cublas.py .                             [  9%]
tests/cupy_tests/cuda_tests/test_cudnn.py s                              [  9%]
tests/cupy_tests/cuda_tests/test_cufft.py ssssssssssssssss.              [  9%]
tests/cupy_tests/cuda_tests/test_curand.py .....                         [  9%]
tests/cupy_tests/cuda_tests/test_cusolver.py .                           [  9%]
tests/cupy_tests/cuda_tests/test_cusparse.py .                           [  9%]
tests/cupy_tests/cuda_tests/test_cutensor.py s                           [  9%]
tests/cupy_tests/cuda_tests/test_device.py ....................          [  9%]
tests/cupy_tests/cuda_tests/test_driver.py ss.                           [  9%]
tests/cupy_tests/cuda_tests/test_memory.py ....ssssssss................. [  9%]
.................s.............................................sssssssss [  9%]
ssssssssssss                                                             [  9%]
tests/cupy_tests/cuda_tests/test_memory_hook.py .                        [  9%]
tests/cupy_tests/cuda_tests/test_nccl.py ........                        [  9%]
tests/cupy_tests/cuda_tests/test_nvrtc.py .                              [  9%]
tests/cupy_tests/cuda_tests/test_nvtx.py ....                            [  9%]
tests/cupy_tests/cuda_tests/test_pinned_memory.py ............           [  9%]
tests/cupy_tests/cuda_tests/test_profile.py ..                           [  9%]
tests/cupy_tests/cuda_tests/test_runtime.py .                            [  9%]
tests/cupy_tests/cuda_tests/test_stream.py ..s..s......ssssssssssss.s    [  9%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_debug_print.py .     [  9%]
tests/cupy_tests/cuda_tests/memory_hooks_tests/test_line_profile.py ..   [  9%]
tests/cupy_tests/fft_tests/test_cache.py ..sss.....s..                   [  9%]
tests/cupy_tests/fft_tests/test_callback.py ssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [  9%]
ssssssssssssssssssssssssssssssssssssssssssssssssssss                     [  9%]
tests/cupy_tests/fft_tests/test_fft.py ....ssss....ssss........ssss....s [ 10%]
sss........ssss....ssss........ssss....ssss........ssss....ssss........s [ 10%]
sss....ssss........ssss....ssss........ssss....ssss........ssss....ssss. [ 10%]
.......ssss....ssss....................................................s [ 10%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 10%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss. [ 10%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 10%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 10%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.. [ 10%]
s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s. [ 10%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 10%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 10%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 10%]
.s.s.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 10%]
.sssss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.sss [ 11%]
ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s [ 11%]
.sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s...ss..ss....ss..ss....ss..ss....ss [ 11%]
..ss....ss..ss....ss..ss....ss..ss....ss..ss...s.s.s.s.s.s.s.s.s.s.s.s.s [ 11%]
.s.s.s.s.s.s.s.s.s.s.s.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s......s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s [ 11%]
.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s [ 11%]
..s.s..s.s..s.s..s.s..s.s..s.s..s.s.sssss.s.s..s.s.sssssssssssssssssssss [ 11%]
ssssssssssssssssssssssssssssssssssssssssssss.s.s..s.s..s.s..s.s..s.s..s. [ 11%]
s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s..s.s. [ 11%]
.s.s..s.s..s.s..s.s..s.s..s.s.......ss..ss....ss..ss....ss..ss....ss..ss [ 12%]
....ss..ss....ss..ss....ss..ss....ss..ss........................         [ 12%]
tests/cupy_tests/functional_tests/test_piecewise.py .............        [ 12%]
tests/cupy_tests/functional_tests/test_vectorize.py .................... [ 12%]
..................................                                       [ 12%]
tests/cupy_tests/indexing_tests/test_generate.py ....................... [ 12%]
...............                                                          [ 12%]
tests/cupy_tests/indexing_tests/test_indexing.py ....................... [ 12%]
.........................                                                [ 12%]
tests/cupy_tests/indexing_tests/test_insert.py ......................... [ 12%]
........................................................................ [ 12%]
........................................................................ [ 12%]
.........................................................                [ 12%]
tests/cupy_tests/indexing_tests/test_iterate.py ........................ [ 12%]
...............................................                          [ 12%]
tests/cupy_tests/io_tests/test_base_n.py ............................    [ 12%]
tests/cupy_tests/io_tests/test_formatting.py ..                          [ 12%]
tests/cupy_tests/io_tests/test_npz.py .......                            [ 12%]
tests/cupy_tests/lib_tests/test_polynomial.py ..............ssss........ [ 12%]
..........sssssssssssssss........ssssssssssssssssssssssssssssssssssssxxx [ 12%]
xxxxxxxxxxxxxxxxx...ssssssssssssssssssssssssssssssssssssssssssssssss.... [ 12%]
ssssssssssssssssssssssssssssssssssssssssssssssss......xxxxxxxxxxxx...... [ 12%]
..........................................xxxxxxxxxxxx.................. [ 12%]
..............................xxxxxxxx........xxxxxxxx.................. [ 13%]
..................................................x...x................. [ 13%]
..                                                                       [ 13%]
tests/cupy_tests/lib_tests/test_shape_base.py ......................     [ 13%]
tests/cupy_tests/lib_tests/test_strided_tricks.py ..                     [ 13%]
tests/cupy_tests/linalg_tests/test_decomposition.py .s....s....s....s... [ 13%]
...................................                                      [ 13%]
tests/cupy_tests/linalg_tests/test_eigenvalue.py ..................      [ 13%]
tests/cupy_tests/linalg_tests/test_einsum.py ........................... [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
........................................................................ [ 13%]
..........                                                               [ 13%]
tests/cupy_tests/linalg_tests/test_norms.py ............................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
.................................................................        [ 14%]
tests/cupy_tests/linalg_tests/test_product.py F.F.F.F.........F.F.F.F... [ 14%]
......F.F.F.F.F.F.F.F.F.F.F.F.F.F.F.F.F.F.F.F........................... [ 14%]
..............................F.F.F.F.F.F.F.F........................... [ 14%]
.....FF.FFFF.F.FF.FFF.FF.F.FFF....FF....FF......                         [ 14%]
tests/cupy_tests/linalg_tests/test_solve.py ......................F..... [ 14%]
....................................                                     [ 14%]
tests/cupy_tests/logic_tests/test_comparison.py ........................ [ 14%]
.....                                                                    [ 14%]
tests/cupy_tests/logic_tests/test_content.py ...                         [ 14%]
tests/cupy_tests/logic_tests/test_ops.py ....                            [ 14%]
tests/cupy_tests/logic_tests/test_truth.py ............................. [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 14%]
........................................................................ [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
........................................................................ [ 15%]
...........................................                              [ 15%]
tests/cupy_tests/logic_tests/test_type_test.py ......................... [ 15%]
.......                                                                  [ 15%]
tests/cupy_tests/manipulation_tests/test_add_remove.py ................. [ 15%]
............................                                             [ 15%]
tests/cupy_tests/manipulation_tests/test_basic.py ........F............. [ 15%]
........................................................................ [ 15%]
.                                                                        [ 15%]
tests/cupy_tests/manipulation_tests/test_dims.py .....x.x............... [ 15%]
................................................                         [ 15%]
tests/cupy_tests/manipulation_tests/test_join.py ....................... [ 15%]
.sssssss..........................                                       [ 15%]
tests/cupy_tests/manipulation_tests/test_kind.py ...........             [ 15%]
tests/cupy_tests/manipulation_tests/test_rearrange.py .................. [ 15%]
.......................................................                  [ 15%]
tests/cupy_tests/manipulation_tests/test_shape.py ...................... [ 15%]
........................................                                 [ 15%]
tests/cupy_tests/manipulation_tests/test_split.py ..................     [ 15%]
tests/cupy_tests/manipulation_tests/test_tiling.py ..................... [ 15%]
...........                                                              [ 15%]
tests/cupy_tests/manipulation_tests/test_transpose.py .................. [ 15%]
..........                                                               [ 15%]
tests/cupy_tests/math_tests/test_arithmetic.py ......................... [ 15%]
........................................................................ [ 15%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 16%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 17%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 18%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 19%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 20%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 21%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 22%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 23%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
....................ss...xxsssssxxxxxxxxxxx........                      [ 24%]
tests/cupy_tests/math_tests/test_explog.py .........                     [ 24%]
tests/cupy_tests/math_tests/test_floating.py .......                     [ 24%]
tests/cupy_tests/math_tests/test_hyperbolic.py ......                    [ 24%]
tests/cupy_tests/math_tests/test_matmul.py FF......FF..FF............... [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
........................................................................ [ 24%]
................................................                         [ 24%]
tests/cupy_tests/math_tests/test_misc.py ............................... [ 24%]
............................................F..F..F..................... [ 24%]
................................                                         [ 24%]
tests/cupy_tests/math_tests/test_rational.py ....                        [ 24%]
tests/cupy_tests/math_tests/test_rounding.py ........................... [ 24%]
..........................................                               [ 24%]
tests/cupy_tests/math_tests/test_special.py ...                          [ 24%]
tests/cupy_tests/math_tests/test_sumprod.py ............................ [ 24%]
........................................................................ [ 24%]
.......ssssssssssssssss................................................. [ 24%]
........................................................................ [ 24%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
..............................................................           [ 25%]
tests/cupy_tests/math_tests/test_trigonometric.py ..........sssssssss    [ 25%]
tests/cupy_tests/math_tests/test_window.py ............................. [ 25%]
.....                                                                    [ 25%]
tests/cupy_tests/misc_tests/test_memory_ranges.py ................       [ 25%]
tests/cupy_tests/misc_tests/test_who.py ......                           [ 25%]
tests/cupy_tests/padding_tests/test_pad.py ............................. [ 25%]
..............................................                           [ 25%]
tests/cupy_tests/polynomial_tests/test_polynomial.py ................... [ 25%]
                                                                         [ 25%]
tests/cupy_tests/polynomial_tests/test_polyutils.py .................... [ 25%]
................                                                         [ 25%]
tests/cupy_tests/prof_tests/test_range.py ........                       [ 25%]
tests/cupy_tests/random_tests/test_bit_generator.py ssssssssssss         [ 25%]
tests/cupy_tests/random_tests/test_distributions.py .................... [ 25%]
........................................................................ [ 25%]
........................................................................ [ 25%]
.............xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....................... [ 25%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
........................................................................ [ 26%]
.....xxxxxxx..................................xxxxxxx................... [ 26%]
........................................................................ [ 26%]
.............................................                            [ 26%]
tests/cupy_tests/random_tests/test_generator.py .......s.s.s..........s. [ 27%]
..................s..................................s.......s.s........ [ 27%]
..........................s............................................. [ 27%]
..................................s.s.s......................s.s........ [ 27%]
...................................................................x.... [ 27%]
...........................                                              [ 27%]
tests/cupy_tests/random_tests/test_generator_api.py ssssssssssssssssssss [ 27%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 27%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 27%]
ssssssssss                                                               [ 27%]
tests/cupy_tests/random_tests/test_init.py .                             [ 27%]
tests/cupy_tests/random_tests/test_permutations.py ...x...x............. [ 27%]
........................................................................ [ 27%]
........................................................................ [ 27%]
.............                                                            [ 27%]
tests/cupy_tests/random_tests/test_random.py .                           [ 27%]
tests/cupy_tests/random_tests/test_sample.py ...............x........x.. [ 27%]
............                                                             [ 27%]
tests/cupy_tests/sorting_tests/test_count.py ....                        [ 27%]
tests/cupy_tests/sorting_tests/test_search.py ........................ss [ 27%]
ss....ssss....................ssss....ssss.............................. [ 27%]
........................................................................ [ 27%]
....................................................................     [ 27%]
tests/cupy_tests/sorting_tests/test_sort.py ............................ [ 28%]
........................................................................ [ 28%]
..........................................................x...........   [ 28%]
tests/cupy_tests/statistics_tests/test_correlation.py .................. [ 28%]
..............................F..F.xF...................                 [ 28%]
tests/cupy_tests/statistics_tests/test_histogram.py .................... [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
........................................................                 [ 28%]
tests/cupy_tests/statistics_tests/test_meanvar.py ...................... [ 28%]
........................................................................ [ 28%]
........................................................................ [ 28%]
......                                                                   [ 28%]
tests/cupy_tests/statistics_tests/test_order.py sssss................... [ 28%]
.........................                                                [ 28%]
tests/cupy_tests/testing_tests/test_array.py ........................... [ 28%]
...............................................                          [ 28%]
tests/cupy_tests/testing_tests/test_condition.py ................        [ 28%]
tests/cupy_tests/testing_tests/test_helper.py .......................... [ 28%]
........................................................................ [ 29%]
.....sssss..sssssss..ssxxxxxxxx................x..x.................     [ 29%]
tests/cupy_tests/testing_tests/test_parameterized.py ............s.s.s.s [ 29%]
....ssss......                                                           [ 29%]
tests/cupyx_tests/test_cupyx.py ..                                       [ 29%]
tests/cupyx_tests/test_lapack.py .s.s.s.s.....s.s.s.s.....s.s.s.s.....s. [ 29%]
s.s.s.............sssssssssssss                                          [ 29%]
tests/cupyx_tests/test_optimize.py sssssssss                             [ 29%]
tests/cupyx_tests/test_pinned_array.py ................................. [ 29%]
.......................................                                  [ 29%]
tests/cupyx_tests/test_rsqrt.py .                                        [ 29%]
tests/cupyx_tests/test_runtime.py s.                                     [ 29%]
tests/cupyx_tests/test_scatter.py ...                                    [ 29%]
tests/cupyx_tests/test_time.py .........                                 [ 29%]
tests/cupyx_tests/fallback_mode_tests/test_fallback.py ................. [ 29%]
........................................................................ [ 29%]
.........                                                                [ 29%]
tests/cupyx_tests/fallback_mode_tests/test_notifications.py .........    [ 29%]
tests/cupyx_tests/jit_tests/test_raw.py ................................ [ 29%]
...........                                                              [ 29%]
tests/cupyx_tests/linalg_tests/test_solve.py xxxxxxxxxxxxxxxx....ssss    [ 29%]
tests/cupyx_tests/scipy_tests/test_get_array_module.py ..                [ 29%]
tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py .................... [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 29%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 30%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 31%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 32%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 33%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 34%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 35%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 36%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
........................................................................ [ 37%]
......................................................................ss [ 37%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 37%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 37%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss........ [ 37%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
..............................................ssssssssssssssssssssssssss [ 38%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 38%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 38%]
ssssssssssssssssssssssssssssssssssssssss................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 38%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
..............................................................F......... [ 39%]
........................................................................ [ 39%]
........................................................................ [ 39%]
......FF..............................................................   [ 39%]
tests/cupyx_tests/scipy_tests/fft_tests/test_helper.py .                 [ 39%]
tests/cupyx_tests/scipy_tests/fftpack_tests/test_fftpack.py ............ [ 39%]
........................................................................ [ 39%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
........................................................................ [ 40%]
.........................                                                [ 40%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_decomp_lu.py ........... [ 40%]
...................................................                      [ 40%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_solve_triangular.py .... [ 40%]
........................................................................ [ 40%]
........................................................................ [ 41%]
........................................................................ [ 41%]
....................................................................     [ 41%]
tests/cupyx_tests/scipy_tests/linalg_tests/test_special_matrices.py .... [ 41%]
........................................................................ [ 41%]
.................................................                        [ 41%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_filters.py ...sss...... [ 41%]
sss......sss......sss......sss......sss.........sss......sss......sss... [ 41%]
...sss......sss......sss................................................ [ 41%]
...........................................................sss......sss. [ 41%]
.....sss......sss......sss......sss.........sss......sss......sss......s [ 41%]
ss......sss......sss.................................................... [ 41%]
.......................................................sss......sss..... [ 41%]
.sss......sss......sss......sss.........sss......sss......sss......sss.. [ 41%]
....sss......sss........................................................ [ 41%]
...................................................sss......sss......sss [ 41%]
......sss......sss......sss.........sss......sss......sss......sss...... [ 42%]
sss......sss............................................................ [ 42%]
...............................................sss......sss......sss.... [ 42%]
..sss......sss......sss.........sss......sss......sss......sss......sss. [ 42%]
.....sss................................................................ [ 42%]
...........................................sss......sss......sss......ss [ 42%]
s......sss......sss.........sss......sss......sss......sss......sss..... [ 42%]
.sss.................................................................... [ 42%]
.......................................sss......sss......sss......sss... [ 42%]
...sss......sss.........sss......sss......sss......sss......sss......sss [ 42%]
........................................................................ [ 42%]
...................................sss......sss......sss......sss......s [ 42%]
ss......sss.........sss......sss......sss......sss......sss......sss.... [ 42%]
........................................................................ [ 42%]
...............................sss......sss......sss......sss......sss.. [ 43%]
....sss.........sss......sss......sss......sss......sss......sss........ [ 43%]
........................................................................ [ 43%]
...........................sss......sss......sss......sss......sss...... [ 43%]
sss.........sss......sss......sss......sss......sss......sss............ [ 43%]
........................................................................ [ 43%]
.......................sss......sss......sss......sss......sss......sss. [ 43%]
........sss......sss......sss......sss......sss......sss................ [ 43%]
........................................................................ [ 43%]
...................sss......sss......sss......sss......sss......sss..... [ 43%]
....sss......sss......sss......sss......sss......sss.................... [ 43%]
........................................................................ [ 43%]
...............sss......sss......sss......sss......sss......sss......... [ 43%]
sss......sss......sss......sss......sss......sss........................ [ 44%]
........................................................................ [ 44%]
...........sss......sss......sss......sss......sss......sss.........sss. [ 44%]
.....sss......sss......sss......sss......sss............................ [ 44%]
........................................................................ [ 44%]
xxx....sss......sss......sss......sss......sss......sss....x..x.sss.x..x [ 44%]
.sss.x..x.sss......sss......sss......sss................................ [ 44%]
.....................................................x..x.............x. [ 44%]
......................................x.....x....x.....x......x.....x... [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 44%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 45%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................................................................ [ 46%]
........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 46%]
........................................................................ [ 46%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 46%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 46%]
.............................................................s.s.s.s.s.s [ 46%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 46%]
........................................................................ [ 47%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 47%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 47%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 47%]
........................................................................ [ 47%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 47%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 47%]
.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............. [ 47%]
........................................................................ [ 47%]
.........................s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.ss.s.s.s.s.s. [ 47%]
s.s.s.s.s.s.s.s.s.s.s.s................................................. [ 47%]
.............................................................s.s.s.s.s.s [ 48%]
.s.s.s.s.s.s.s.s.s.s.s.ssss..sss..sss............sss..sss..sss.......... [ 48%]
..sss..sss..sss............sss..sss..sss............sss..sss..sss....... [ 48%]
.....sss..sss..sss............sss..sss..sss............sss..sss..sss.... [ 48%]
........sss..sss..sss............sss..sss..sss............sss..sss..sss. [ 48%]
...........sss..sss..sss................................................ [ 48%]
........................................................................ [ 48%]
....................................                                     [ 48%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_fourier.py ............ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 48%]
........................................................................ [ 49%]
........................................                                 [ 49%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py ...... [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 49%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
................FF...................................................... [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 50%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 51%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 52%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 53%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 54%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 55%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 56%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
........................................................................ [ 57%]
...............................x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 57%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x.............x...x.x...x.x...x.x...x.............x...x [ 58%]
.x...x.x...x.x...x...................................................... [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 58%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
........................................................................ [ 59%]
.....................sssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 59%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 60%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 60%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 60%]
sssssssssssssssssssssssssssssssssssssssssssssss......................... [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
..................................................x.....x.....x.....x... [ 60%]
..x.....x.....x.....x.....x.....x.....x.....x.......x........x..x..x.... [ 60%]
....s................................................................... [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 60%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
................................x.....x....................x.....x...... [ 61%]
..............x.....x....................x.....x....................x... [ 61%]
..x....................x.....x....................x.....x............... [ 61%]
.....x.....x............................................................ [ 61%]
........................................................................ [ 61%]
........................................................................ [ 61%]
.................................................................s...... [ 61%]
........................................................................ [ 61%]
........................................................................ [ 62%]
........................................................................ [ 62%]
......................................FF..........FF....FF.............. [ 62%]
........FF....FF..........FF....FF......................FFss............ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 62%]
........................................................................ [ 63%]
....................................ssssssssssssssssssssssssssssssssssss [ 63%]
ssssssssssss                                                             [ 63%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py ....... [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 63%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 64%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
........................................................................ [ 65%]
...................xx..........xx..........xx..........xx..........xx... [ 65%]
...................xx..................................xx............... [ 65%]
...................xx..........xx..........xx..........xx..........xx... [ 66%]
...................xx..................................xx............... [ 66%]
........................................................................ [ 66%]
........................................................................ [ 66%]
.................                                                        [ 66%]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_morphology.py ......... [ 66%]
......................s....s....s..s....s....s.......................... [ 66%]
..........s....s....s..s....s....s....................................s. [ 66%]
...s....s..s....s....s....................................s....s....s..s [ 66%]
....s....s....................................s....s....s..s....s....s.. [ 66%]
..................................s....s....s..s....s....s.............. [ 66%]
......................s....s....s..s....s....s.......................... [ 66%]
..........s....s....s..s....s....s....................................s. [ 66%]
...s....s..s....s....s....................................s....s....s..s [ 66%]
....s....s....................................s....s....s..s....s....s.. [ 66%]
..................................s....s....s..s....s....s.............. [ 67%]
......................s....s....s..s....s....s.......................... [ 67%]
..........s....s....s..s....s....s....................................s. [ 67%]
...s....s..s....s....s....................................s....s....s..s [ 67%]
....s....s....................................s....s....s..s....s....s.. [ 67%]
..................................s....s....s..s....s....s.............. [ 67%]
......................s....s....s..s....s....s.......................... [ 67%]
..........s....s....s..s....s....s....................................s. [ 67%]
...s....s..s....s....s....................................s....s....s..s [ 67%]
....s....s....................................s....s....s..s....s....s.. [ 67%]
..................................s....s....s..s....s....s.............. [ 67%]
........................................................................ [ 67%]
........................................................................ [ 67%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
........................................................................ [ 68%]
.......................................................................s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 68%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 69%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............s [ 70%]
.s.s.............s.s.s.............s.s.s.............s.s.s.............. [ 71%]
........................................................................ [ 71%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 71%]
..........................................s....s....s....s....s....s.... [ 71%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 71%]
s....s....s....s........................................................ [ 71%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 71%]
..........................................s....s....s....s....s....s.... [ 71%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 71%]
s....s....s....s........................................................ [ 71%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 71%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 72%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 72%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 72%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 72%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 72%]
..........................................s....s....s....s....s....s.... [ 72%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 72%]
s....s....s....s........................................................ [ 72%]
......s....s....s....s....s....s....s....s....s....s....s....s......s... [ 73%]
.s....s....s....s....s....s....s....s....s....s....s.................... [ 73%]
..........................................s....s....s....s....s....s.... [ 73%]
s....s....s....s....s....s......s....s....s....s....s....s....s....s.... [ 73%]
s....s....s....s........................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................ssssssss........ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 73%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
........................................................................ [ 74%]
                                                                         [ 74%]
tests/cupyx_tests/scipy_tests/signal_tests/test_bsplines.py ............ [ 74%]
                                                                         [ 74%]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py ......... [ 74%]
........................................................................ [ 74%]
...........................Fxxx............xxxx............F..x......... [ 75%]
...Fxxx............xxxx............F..x.............xxx............xxxx. [ 75%]
..............x....................................x.x..x.x..x.x..x.x..x [ 75%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x................................... [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
........................................................................ [ 75%]
....................................................ssssssssssssssssss   [ 75%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_base.py .......          [ 75%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_construct.py ........... [ 75%]
........................................................................ [ 75%]
................................................................s.s.s.s. [ 75%]
s.s..................................................................... [ 75%]
..............xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 75%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................. [ 76%]
..xxxxxxxxxxxxxxxxxxxxxxxx.............................................. [ 76%]
......................................xxxxxxxxxxxx...................... [ 76%]
..............xxxxxxxxxxxxxxxxxxxxxxxx.................................. [ 76%]
..................................................xxxxxxxxxxxx.......... [ 76%]
..........................xxxxxxxxxxxxxxxxxxxxxxxx...................... [ 76%]
..............................................................xxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 76%]
xxxxxxxxxxxxxxxxxxxxxxxxxx....................................xxxxxxxxxx [ 76%]
xxxxxxxxxxxxxx.......................................................... [ 76%]
..........................xxxxxxxxxxxx.................................. [ 77%]
..xxxxxxxxxxxxxxxxxxxxxxxx.............................................. [ 77%]
......................................xxxxxxxxxxxx...................... [ 77%]
..............xxxxxxxxxxxxxxxxxxxxxxxx.................................. [ 77%]
..................................................xxxxxxxxxxxx.......... [ 77%]
..........................xxxxxxxxxxxxxxxxxxxxxxxx...................... [ 77%]
..............................................................xxxxxxxxxx [ 77%]
xx....................................xxxxxxxxxxxxxxxxxxxxxxxx.......... [ 77%]
........................................................................ [ 77%]
..xxxxxxxxxxxx....................................xxxxxxxxxxxxxxxxxxxxxx [ 77%]
xx...................................................................... [ 77%]
..............xxxxxxxxxxxx....................................xxxxxxxxxx [ 77%]
xxxxxxxxxxxxxx.......................................................... [ 77%]
..........................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 78%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.......... [ 78%]
........................................................................ [ 78%]
..xxxxxxxxxxxx.......................................................... [ 78%]
..........................xxxxxxxxxxxx.................................. [ 78%]
..................................................xxxxxxxxxxxx.......... [ 78%]
........................................................................ [ 78%]
..xxxxxxxxxxxx.......................................................... [ 78%]
..........................xxxxxxxxxxxx.................................. [ 78%]
..................................................xxxxxxxxxxxx.......... [ 78%]
........................................................................ [ 78%]
..                                                                       [ 78%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_coo.py ................. [ 78%]
........................................................................ [ 78%]
........................................................................ [ 78%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 79%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
........................................................................ [ 80%]
.............................................                            [ 80%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_csc.py ................. [ 80%]
...................xxxx................................................. [ 80%]
........................................................................ [ 80%]
.............x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 80%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 81%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 81%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 81%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 81%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.xxxxxxxxxxxxxxxxxxxxxx [ 81%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..x.x..x.x..x.x..x.x..x.x..x.x..x [ 81%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 81%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 81%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 81%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 81%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 81%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 81%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 81%]
xxx..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 81%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 82%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 82%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 82%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 82%]
x.x..x.x..x.x..x.x..x.xssssssssssssssssssss..x.x..x.x..x.x..x.x..x.x..x. [ 82%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 82%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 82%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 82%]
..x.x..x.x..x.xxxxxxx......xxxxxxxxxxxx......xxxxxx......xxxxxxxxxxxx... [ 82%]
...................................................ss........ss......... [ 82%]
...........................xxxx....xxxxxxxx............................. [ 82%]
........................................................................ [ 82%]
.................................................................        [ 82%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py ................. [ 82%]
...................xxxx................................................. [ 83%]
........................................................................ [ 83%]
.............x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 83%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 83%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 83%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 83%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 83%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 83%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 83%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 83%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 83%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 83%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 83%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 83%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 84%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 84%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 84%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 84%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 84%]
.x..x.x..x.x..x.x..x.x..x.xxxxxxxxxxxxxxxxxxxxx..x.x..x.x..x.x..x.x..x.x [ 84%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 84%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 84%]
x..x.x..x.x..x.x..x.x..x.x..x.xssssssssssssssssssss..x.x..x.x..x.x..x.x. [ 84%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 84%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 84%]
..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x.. [ 84%]
x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x. [ 84%]
x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x. [ 85%]
.x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x [ 85%]
.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x..x.x [ 85%]
..x.x..x.x..x.x......................................xxxxxx............x [ 85%]
xxxxx......xxxxxx............xxxxxx......xxxxxx............xxxxxx......x [ 85%]
xxxxx............xxxxxx................................................s [ 85%]
s........ss........................................xxxx........xxxx..... [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
.ssssssssssss........................................................... [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 85%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 86%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 87%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 88%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
.....................ssss........ssss........ssss........ssss........sss [ 89%]
s........ssss........ssss........ssss........ssss........ssss........sss [ 89%]
s........ssss........ssss........ssss........ssss........ssss........... [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
........................................................................ [ 89%]
.........................                                                [ 89%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_dia.py ................. [ 89%]
........................................................................ [ 89%]
......xxxxxxxxxxxxxxx...............xxxxxxxxxxxxxxx...............xxxxxx [ 89%]
xxxxxxxxx...............xxxxxxxxxxxxxxx............xxxxxxxxxxxx......... [ 90%]
...............xxxxxxxxxxxx..                                            [ 90%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_extract.py ............. [ 90%]
........................................................................ [ 90%]
.......................                                                  [ 90%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py ............... [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 90%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 91%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
........................................................................ [ 92%]
....................................x...x.....................x...x..... [ 92%]
......x...x........................x...x.........xx..xx................. [ 93%]
.................................x...x.................................. [ 93%]
...............x...x.....................x...x.x.........x...x.x........ [ 93%]
..............x...x.........x...x.....................................x. [ 93%]
..x.........x...x.........x...x.........x...x........................... [ 93%]
........................................................................ [ 93%]
........................................................................ [ 93%]
........................................................................ [ 93%]
........................................................................ [ 93%]
........................................................................ [ 93%]
..................................................x...x...........x...x. [ 93%]
.......................x...x.........xx..xx............................. [ 93%]
.....................x...x.............................................. [ 93%]
.............................x...x.x.........x...x.x.................... [ 94%]
..x...x.........x...x.....................................x...x......... [ 94%]
x...x.........x...x.........x...x....................................... [ 94%]
........................................................................ [ 94%]
........................................................................ [ 94%]
........................................................................ [ 94%]
........................................................................ [ 94%]
........................................................................ [ 94%]
......................................x...x...........x...x............. [ 94%]
...........x...x.........xx..xx......................................... [ 94%]
.........x...x.......................................................... [ 94%]
.................x...x.x.........x...x.x......................x...x..... [ 94%]
....x...x.....................................x...x.........x...x....... [ 94%]
..x...x.........x...x................................................... [ 94%]
........................................................................ [ 95%]
........................................................................ [ 95%]
.................................                                        [ 95%]
tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py ssssssss.x.x.x [ 95%]
..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x.. [ 95%]
x..x.x.x..x..x.x.x..x..x.x.x..x..x.x.x..x.xx..xxxxxxxxxx....xx..xxxxxxxx [ 95%]
xx....xx..xxxxxxxxxx....xx..xxxxxxxxxx.................................. [ 95%]
..........................................xx..xxxxxxxxxx....xx..xxxxxxxx [ 95%]
xx....xx..xxxxxxxxxx....xx..xxxxxxxxxx.................................. [ 95%]
..................................................................xxxxxx [ 95%]
xxxxxxxxxxxxxxxxxx................................................xxxxxx [ 95%]
xxxxxxxxxxxxxxxxxxss..ss..ss..ss..ss..ss..xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 95%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.............................. [ 95%]
..........................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 95%]
xxxxxxs.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s.s............................... [ 95%]
..................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...... [ 96%]
........................................................................ [ 96%]
...................sss.sssssssssssssssssssssssssss...................... [ 96%]
........................................................................ [ 96%]
..................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [ 96%]
xxxxxxxxxxxxxxxxxxxxxxxxxx.............................................. [ 96%]
........................................................................ [ 96%]
........................................................................ [ 96%]
...sssssss.sssssssssssssssssssssssssssssssssssssssssssssssssssssss....xx [ 96%]
.............xx.............xx.............xx.............xx............ [ 96%]
.xx.............xx.............xx.............xx.............xx......... [ 96%]
....xx.............xx.............xx.............xx.............xx...... [ 96%]
.......xx.............xx.............xx.............xx.............xx... [ 96%]
..........xx.............xx.............xx.............xx.............xx [ 97%]
.............xx.............xx.............xx.............xx............ [ 97%]
.xx.............xx.............xx............x..............x........... [ 97%]
...x..............x..............x..............x..............x........ [ 97%]
......x..............x..............x..............x..............x..... [ 97%]
.........x..............x..............x..............x..............x.. [ 97%]
............x..............x..............x..............x.............. [ 97%]
x..............x..............x..............x..............x........... [ 97%]
...x..............x..............x..............x..............x........ [ 97%]
......x...............xx.............xx.............xx.............xx... [ 97%]
..........xx.............xx.............xx.............xx.............xx [ 97%]
.............xx.............xx.............xx.............xx............ [ 97%]
.xx.............xx.............xx.............xx.............xx......... [ 97%]
....xx.............xx.............xx.............xx.............xx...... [ 97%]
.......xx.............xx.............xx.............xx.............xx... [ 98%]
..........xx.............xx.............xx.............xx............... [ 98%]
..................................................................ssssss [ 98%]
ss.sssssssssssssssssssssss.F............F............................... [ 98%]
..............................................s.s.....s.s.....s.sxxxxxxx [ 98%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx........................xxxxxxx [ 98%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx........................xxxxxxx [ 98%]
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.....s.s.....s.s.....s.s.....s. [ 98%]
s.....s.s.....s.s.....s.s.....s.s.....s.s............................... [ 98%]
........................................................................ [ 98%]
..........................................sss.sss.sss.sss.sss.sss.sss.ss [ 98%]
s.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.ss [ 98%]
s.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.ss [ 98%]
s.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss............................... [ 99%]
.................................xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx....... [ 99%]
........................................................................ [ 99%]
..................sss.sssssssssssssssssssssssssss....................... [ 99%]
.........xxxxxxxxxxxxxxxx................................xxxxxxxxxxxxxxx [ 99%]
x....................................................................... [ 99%]
..........................sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.sss.ss [ 99%]
sssssssssssssssssssssssssssssssssssssssssssssssss.sss.sss.sss.sss.sss.ss [ 99%]
s.sss.sss.sss.sss.sss.ssssssssssssssssssssssssssssssssssssssssssssssssss [ 99%]
s                                                                        [ 99%]
tests/cupyx_tests/scipy_tests/sparse_tests/csgraph_tests/test_traversal.py s [ 99%]
ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss [ 99%]
sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_bessel.py ............  [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_convex_analysis.py .... [ 99%]
.                                                                        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_digamma.py .....        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_erf.py ............     [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gamma.py ....           [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_gammaln.py ....         [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_polygamma.py ....       [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_statistics.py ..        [ 99%]
tests/cupyx_tests/scipy_tests/special_tests/test_zeta.py ....            [ 99%]
tests/cupyx_tests/scipy_tests/stats_tests/test_distributions.py ........ [ 99%]
........................................................................ [ 99%]
........................................................................ [ 99%]
                                                                         [ 99%]
tests/cupyx_tests/tools_tests/test_install_library.py ......             [ 99%]
tests/example_tests/test_custom_struct.py FFF                            [ 99%]
tests/example_tests/test_finance.py ...                                  [ 99%]
tests/example_tests/test_gemm.py .                                       [ 99%]
tests/example_tests/test_gmm.py ss                                       [ 99%]
tests/example_tests/test_kmeans.py sss                                   [ 99%]
tests/install_tests/test_build.py sx.                                    [ 99%]
tests/install_tests/test_utils.py ..                                     [ 99%]
tests/install_tests/test_cupy_builder/test_context.py ....               [100%]

=================================== FAILURES ===================================
______________ TestNdarrayCopy.test_copy_multi_device_with_stream ______________

self = <cupy_tests.core_tests.test_ndarray.TestNdarrayCopy testMethod=test_copy_multi_device_with_stream>

    @testing.multi_gpu(2)
    def test_copy_multi_device_with_stream(self):
        # Kernel that takes long enough then finally writes values.
        kern = cupy.RawKernel(
            _test_copy_multi_device_with_stream_src, 'wait_and_write')
    
        # Allocates a memory and launches the kernel on a device with its
        # stream.
        with cuda.Device(0):
            # Keep this stream alive over the D2D copy below for HIP
            with cuda.Stream() as s1:  # NOQA
                a = cupy.zeros((2,), dtype=numpy.uint64)
                kern((1,), (1,), a)
    
        # D2D copy to another device with another stream should get the
        # original values of the memory before the kernel on the first device
        # finally makes the write.
        with cuda.Device(1):
            with cuda.Stream():
                b = a.copy()
>               testing.assert_array_equal(
                    b, numpy.array([0, 0], dtype=numpy.uint64))

tests/cupy_tests/core_tests/test_ndarray.py:224: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([13744632839234567870, 13744632839234567870], dtype=uint64)
y = array([0, 0], dtype=uint64), err_msg = '', verbose = True
strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 13744632839234567870
E       Max relative difference: inf
E        x: array([13744632839234567870, 13744632839234567870], dtype=uint64)
E        y: array([0, 0], dtype=uint64)

cupy/testing/_array.py:91: AssertionError
________________ TestArrayCopyAndView.test_astype_boolean_view _________________

args = (<cupy_tests.core_tests.test_ndarray_copy_and_view.TestArrayCopyAndView object at 0x7f3517c53220>,)
kw = {}, cupy_result = (array([0, 1, 2], dtype=int8),), cupy_error = None
numpy_result = (array([0, 1, 1], dtype=int8),), numpy_error = None
cupy_numpy_result_ndarrays = [(array([0, 1, 2], dtype=int8), array([0, 1, 1], dtype=int8))]
cupy_r = array([0, 1, 2], dtype=int8), numpy_r = array([0, 1, 1], dtype=int8)
masks = [None]

            @_wraps_partial_xp(impl, name, sp_name, scipy_name)
            def test_func(*args, **kw):
                # Run cupy and numpy
                (
                    cupy_result, cupy_error,
                    numpy_result, numpy_error) = (
                        _call_func_numpy_cupy(
                            impl, args, kw, name, sp_name, scipy_name))
                assert cupy_result is not None or cupy_error is not None
                assert numpy_result is not None or numpy_error is not None
    
                # Check errors raised
                if cupy_error or numpy_error:
                    _check_cupy_numpy_error(cupy_error,
                                            numpy_error,
                                            accept_error=accept_error)
                    return
    
                # Check returned arrays
    
                if not isinstance(cupy_result, (tuple, list)):
                    cupy_result = cupy_result,
                if not isinstance(numpy_result, (tuple, list)):
                    numpy_result = numpy_result,
    
                assert len(cupy_result) == len(numpy_result)
    
                # Check types
                cupy_numpy_result_ndarrays = [
                    _convert_output_to_ndarray(
                        cupy_r, numpy_r, sp_name, check_sparse_format)
                    for cupy_r, numpy_r in zip(cupy_result, numpy_result)]
    
                # Check dtypes
                if type_check:
                    for cupy_r, numpy_r in cupy_numpy_result_ndarrays:
                        if cupy_r.dtype != numpy_r.dtype:
                            raise AssertionError(
                                '''ndarrays of different dtypes are returned.
    cupy: {}
    numpy: {}'''.format(cupy_r.dtype, numpy_r.dtype))
    
                # Check contiguities
                if contiguous_check:
                    for cupy_r, numpy_r in zip(cupy_result, numpy_result):
                        if isinstance(numpy_r, numpy.ndarray):
                            if (numpy_r.flags.c_contiguous
                                    and not cupy_r.flags.c_contiguous):
                                raise AssertionError(
                                    'The state of c_contiguous flag is false. '
                                    '(cupy_result:{} numpy_result:{})'.format(
                                        cupy_r.flags.c_contiguous,
                                        numpy_r.flags.c_contiguous))
                            if (numpy_r.flags.f_contiguous
                                    and not cupy_r.flags.f_contiguous):
                                raise AssertionError(
                                    'The state of f_contiguous flag is false. '
                                    '(cupy_result:{} numpy_result:{})'.format(
                                        cupy_r.flags.f_contiguous,
                                        numpy_r.flags.f_contiguous))
    
                # Check shapes
                for cupy_r, numpy_r in cupy_numpy_result_ndarrays:
                    assert cupy_r.shape == numpy_r.shape
    
                masks = [None] * len(cupy_result)
                if _contains_signed_and_unsigned(kw):
                    needs_mask = [
                        cupy_r.dtype in _unsigned_dtypes
                        for cupy_r in cupy_result]
                    if any(needs_mask):
                        masks = _make_positive_masks(
                            impl, args, kw, name, sp_name, scipy_name)
                        for i, flag in enumerate(needs_mask):
                            if not flag:
                                masks[i] = None
    
                # Check item values
                for (cupy_r, numpy_r), mask in zip(
                        cupy_numpy_result_ndarrays, masks):
                    # Behavior of assigning a negative value to an unsigned integer
                    # variable is undefined.
                    # nVidia GPUs and Intel CPUs behave differently.
                    # To avoid this difference, we need to ignore dimensions whose
                    # values are negative.
    
                    skip = False
                    if mask is not None:
                        if cupy_r.shape == ():
                            skip = (mask == 0).all()
                        else:
                            cupy_r = cupy_r[mask].get()
                            numpy_r = numpy_r[mask]
    
                    if not skip:
>                       check_func(cupy_r, numpy_r)

cupy/testing/_helper.py:355: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:660: in check_func
    _array.assert_array_equal(x, y, err_msg, verbose, strides_check)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([0, 1, 2], dtype=int8), y = array([0, 1, 1], dtype=int8), err_msg = ''
verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 1 / 3 (33.3%)
E       Max absolute difference: 1
E       Max relative difference: 1.
E        x: array([0, 1, 2], dtype=int8)
E        y: array([0, 1, 1], dtype=int8)

cupy/testing/_array.py:91: AssertionError
_______________ TestArrayElementwiseOp.test_add_array_boolarray ________________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_add_array_boolarray>

    def test_add_array_boolarray(self):
>       self.check_array_boolarray_op(operator.add)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:478: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
_______________ TestArrayElementwiseOp.test_iadd_array_boolarray _______________

self = <cupy_tests.core_tests.test_ndarray_elementwise_op.TestArrayElementwiseOp testMethod=test_iadd_array_boolarray>

    def test_iadd_array_boolarray(self):
>       self.check_array_boolarray_op(operator.iadd)

tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py:481: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[  5.,   8.,   5.],
       [263., 253., 255.]])
desired = array([[3., 8., 2.],
       [9., 3., 9.]]), rtol = 1e-07, atol = 0
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0
E       
E       Mismatched elements: 5 / 6 (83.3%)
E       Max absolute difference: 254.
E       Max relative difference: 83.33333333
E        x: array([[  5.,   8.,   5.],
E              [263., 253., 255.]])
E        y: array([[3., 8., 2.],
E              [9., 3., 9.]])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
x_type is <class 'numpy.float64'>
_ TestDot_param_0_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_0_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3, 4), (3, 4, 2)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fda44190>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-d8d5dc/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-d8d5dc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_1_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_1_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3, 4), (3, 4, 2)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37b64850a0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-990c7b/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-990c7b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_2_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_2_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3, 4), (3, 4, 2)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34eb20ac70>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-cd70e7/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-cd70e7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_3_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_3_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3, 4), (3, 4, 2)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fdf5ceb0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-c96536/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-c96536/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_8_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_8_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((1, 1), (1, 2)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f38d421d250>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-c91e9c/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-c91e9c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_9_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_9_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((1, 1), (1, 2)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ffa152b0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-6b4dc1/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-6b4dc1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_10_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_10_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((1, 1), (1, 2)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34f2755bb0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-a386c9/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-a386c9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_11_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_11_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((1, 1), (1, 2)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e7357ac0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-f125d6/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-f125d6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_16_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_16_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 1)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37a7edc310>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-e5389b/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-e5389b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_17_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_17_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 1)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fba80940>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-96d88f/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-96d88f/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_18_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_18_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 1)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34f26a6a30>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-2e0034/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-2e0034/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_19_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_19_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 1)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72f3400>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-eea758/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-eea758/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_20_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_20_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((1, 2), (2, 3)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fda52490>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-b20d00/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-b20d00/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_21_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_21_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((1, 2), (2, 3)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72c45e0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-89f67a/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-89f67a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_22_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_22_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((1, 2), (2, 3)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fde5cc10>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-73b25b/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-73b25b/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_23_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_23_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((1, 2), (2, 3)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72ef4f0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-43acca/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-43acca/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_24_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_24_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 3)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ff97c8e0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-f35661/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-f35661/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_25_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_25_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 3)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e76c3c10>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-9c1dfc/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-9c1dfc/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_26_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_26_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 3)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34eb213a30>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-07afb0/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-07afb0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_27_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_27_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 1), (1, 3)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fa363b80>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-6f6fb8/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-6f6fb8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_28_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_28_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 1)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37b6592910>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-4f7461/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-4f7461/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_29_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_29_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 1)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72f5c70>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-00d6f4/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-00d6f4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_30_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_30_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 1)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fdf21eb0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-ab2ea9/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-ab2ea9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_31_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_31_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 1)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72ced00>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-e75e82/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-e75e82/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_32_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_32_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 4)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37b7418a00>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-232ce4/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-232ce4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_33_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_33_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 4)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72e3d00>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-41f284/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-41f284/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_34_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_34_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 4)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f38d6be02b0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-0a12d3/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-0a12d3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_35_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_35_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2, 3), (3, 4)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e7347c40>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-d86195/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-d86195/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_64_{shape=((2,), (2, 4)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_64_{shape=((2,), (2, 4)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2,), (2, 4)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37a73c6820>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-e94e35/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-e94e35/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_65_{shape=((2,), (2, 4)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_65_{shape=((2,), (2, 4)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2,), (2, 4)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fa375910>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-6fa370/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-6fa370/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_66_{shape=((2,), (2, 4)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_66_{shape=((2,), (2, 4)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((2,), (2, 4)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f38d6b68a60>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-08ef22/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-08ef22/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_67_{shape=((2,), (2, 4)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_67_{shape=((2,), (2, 4)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((2,), (2, 4)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fa34f970>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-08067a/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-08067a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_68_{shape=((4, 2), (2,)), trans_a=True, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_68_{shape=((4, 2), (2,)), trans_a=True, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((4, 2), (2,)), 'trans_a': True, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ddbbf640>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-f55fe3/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-f55fe3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_69_{shape=((4, 2), (2,)), trans_a=True, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_69_{shape=((4, 2), (2,)), trans_a=True, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((4, 2), (2,)), 'trans_a': True, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ddb9dfd0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-c9dc1d/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-c9dc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_70_{shape=((4, 2), (2,)), trans_a=False, trans_b=True}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_70_{shape=((4, 2), (2,)), trans_a=False, trans_b=True} testMethod=test_dot>  parameter: {'shape': ((4, 2), (2,)), 'trans_a': False, 'trans_b': True}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ef309a60>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-018f7e/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-018f7e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_ TestDot_param_71_{shape=((4, 2), (2,)), trans_a=False, trans_b=False}.test_dot _

self = <<cupy_tests.linalg_tests.test_product.TestDot_param_71_{shape=((4, 2), (2,)), trans_a=False, trans_b=False} testMethod=test_dot>  parameter: {'shape': ((4, 2), (2,)), 'trans_a': False, 'trans_b': False}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype_a = <class 'numpy.ulonglong'>, dtype_b = <class 'numpy.bool_'>

    @testing.for_all_dtypes_combination(['dtype_a', 'dtype_b'])
    @testing.numpy_cupy_allclose()
    def test_dot(self, xp, dtype_a, dtype_b):
        shape_a, shape_b = self.shape
        if self.trans_a:
            a = testing.shaped_arange(shape_a[::-1], xp, dtype_a).T
        else:
            a = testing.shaped_arange(shape_a, xp, dtype_a)
        if self.trans_b:
            b = testing.shaped_arange(shape_b[::-1], xp, dtype_b).T
        else:
            b = testing.shaped_arange(shape_b, xp, dtype_b)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72c8c40>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 49, in test_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-346fd3/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-346fd3/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
{'dtype_a': <class 'numpy.ulonglong'>, 'dtype_b': <class 'numpy.bool_'>}
_________________ TestProduct.test_dot_with_single_elem_array1 _________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_dot_with_single_elem_array1>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_dot_with_single_elem_array1(self, xp, dtype):
        a = testing.shaped_arange((3, 1), xp, dtype)
        b = xp.array([[2]], dtype=dtype)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:189: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e6393130>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 189, in test_dot_with_single_elem_array1
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-3832d7/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-3832d7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_________________ TestProduct.test_dot_with_single_elem_array2 _________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_dot_with_single_elem_array2>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_dot_with_single_elem_array2(self, xp, dtype):
        a = xp.array([[2]], dtype=dtype)
        b = testing.shaped_arange((1, 3), xp, dtype)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:196: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e76f6190>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 196, in test_dot_with_single_elem_array2
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-16a410/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-16a410/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
____________________________ TestProduct.test_kron _____________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_kron>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_kron(self, xp, dtype):
        a = testing.shaped_arange((4,), xp, dtype)
        b = testing.shaped_arange((5,), xp, dtype)
>       return xp.kron(a, b)

tests/cupy_tests/linalg_tests/test_product.py:361: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:426: in kron
    out = _core.tensordot_core(
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ef32b670>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 361, in test_kron
E               return xp.kron(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 426, in kron
E               out = _core.tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-b6eef1/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-b6eef1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_______________________ TestProduct.test_multidim_inner ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_multidim_inner>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_multidim_inner(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype)
        b = testing.shaped_arange((3, 2, 4), xp, dtype)
>       return xp.inner(a, b)

tests/cupy_tests/linalg_tests/test_product.py:246: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:251: in inner
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e73860d0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 246, in test_multidim_inner
E               return xp.inner(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 251, in inner
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-3574b1/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-3574b1/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
________________________ TestProduct.test_multidim_kron ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_multidim_kron>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_multidim_kron(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype)
        b = testing.shaped_arange((4, 2, 3), xp, dtype)
>       return xp.kron(a, b)

tests/cupy_tests/linalg_tests/test_product.py:375: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:426: in kron
    out = _core.tensordot_core(
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e76f3ac0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 375, in test_multidim_kron
E               return xp.kron(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 426, in kron
E               out = _core.tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-3bbf19/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-3bbf19/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_______________________ TestProduct.test_multidim_outer ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_multidim_outer>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_multidim_outer(self, xp, dtype):
        a = testing.shaped_arange((2, 3), xp, dtype)
        b = testing.shaped_arange((4, 5), xp, dtype)
>       return xp.outer(a, b)

tests/cupy_tests/linalg_tests/test_product.py:274: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:276: in outer
    return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e653db50>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 274, in test_multidim_outer
E               return xp.outer(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 276, in outer
E               return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-920c77/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-920c77/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
____________________________ TestProduct.test_outer ____________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_outer>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_outer(self, xp, dtype):
        a = testing.shaped_arange((5,), xp, dtype)
        b = testing.shaped_arange((4,), xp, dtype)
>       return xp.outer(a, b)

tests/cupy_tests/linalg_tests/test_product.py:260: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:276: in outer
    return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e65032b0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 260, in test_outer
E               return xp.outer(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 276, in outer
E               return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-1a5450/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-1a5450/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
________________________ TestProduct.test_reversed_kron ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_reversed_kron>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_reversed_kron(self, xp, dtype):
        a = testing.shaped_arange((4,), xp, dtype)
        b = testing.shaped_arange((5,), xp, dtype)
>       return xp.kron(a[::-1], b[::-1])

tests/cupy_tests/linalg_tests/test_product.py:368: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:426: in kron
    out = _core.tensordot_core(
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e76d0070>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 368, in test_reversed_kron
E               return xp.kron(a[::-1], b[::-1])
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 426, in kron
E               out = _core.tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-8693b7/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-8693b7/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_______________________ TestProduct.test_reversed_outer ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_reversed_outer>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_reversed_outer(self, xp, dtype):
        a = testing.shaped_arange((5,), xp, dtype)
        b = testing.shaped_arange((4,), xp, dtype)
>       return xp.outer(a[::-1], b[::-1])

tests/cupy_tests/linalg_tests/test_product.py:267: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:276: in outer
    return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37b653fc40>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 267, in test_reversed_outer
E               return xp.outer(a[::-1], b[::-1])
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 276, in outer
E               return _core.tensordot_core(a, b, None, n, m, 1, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-dc99cd/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-dc99cd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
__________________________ TestProduct.test_tensordot __________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_tensordot>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_tensordot(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype)
        b = testing.shaped_arange((3, 4, 5), xp, dtype)
>       return xp.tensordot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:281: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e739c130>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 281, in test_tensordot
E               return xp.tensordot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-636117/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-636117/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
___________________ TestProduct.test_tensordot_with_int_axes ___________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_tensordot_with_int_axes>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_tensordot_with_int_axes(self, xp, dtype):
        if dtype in (numpy.uint8, numpy.int8, numpy.uint16, numpy.int16):
            a = testing.shaped_arange((1, 2, 3), xp, dtype)
            b = testing.shaped_arange((2, 3, 1), xp, dtype)
            return xp.tensordot(a, b, axes=2)
        else:
            a = testing.shaped_arange((2, 3, 4, 5), xp, dtype)
            b = testing.shaped_arange((3, 4, 5, 2), xp, dtype)
>           return xp.tensordot(a, b, axes=3)

tests/cupy_tests/linalg_tests/test_product.py:300: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ff9e2910>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 300, in test_tensordot_with_int_axes
E               return xp.tensordot(a, b, axes=3)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-4969e0/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-4969e0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
__________________ TestProduct.test_tensordot_with_list_axes ___________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_tensordot_with_list_axes>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_tensordot_with_list_axes(self, xp, dtype):
        if dtype in (numpy.uint8, numpy.int8, numpy.uint16, numpy.int16):
            # Avoid overflow
            a = testing.shaped_arange((1, 2, 3), xp, dtype)
            b = testing.shaped_arange((3, 1, 2), xp, dtype)
            return xp.tensordot(a, b, axes=([2, 1], [0, 2]))
        else:
            a = testing.shaped_arange((2, 3, 4, 5), xp, dtype)
            b = testing.shaped_arange((3, 5, 4, 2), xp, dtype)
>           return xp.tensordot(a, b, axes=([3, 2, 1], [1, 2, 0]))

tests/cupy_tests/linalg_tests/test_product.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e72f5f70>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 330, in test_tensordot_with_list_axes
E               return xp.tensordot(a, b, axes=([3, 2, 1], [1, 2, 0]))
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-7a3eda/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-7a3eda/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_______________________ TestProduct.test_transposed_dot ________________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_dot>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_dot(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype).transpose(1, 0, 2)
        b = testing.shaped_arange((2, 3, 4), xp, dtype).transpose(0, 2, 1)
>       return xp.dot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:163: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ff826a00>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 163, in test_transposed_dot
E               return xp.dot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-e9d324/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-e9d324/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
___________________ TestProduct.test_transposed_dot_with_out ___________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_dot_with_out>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_dot_with_out(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype).transpose(1, 0, 2)
        b = testing.shaped_arange((4, 2, 3), xp, dtype).transpose(2, 0, 1)
        c = xp.ndarray((3, 2, 3, 2), dtype=dtype)
>       xp.dot(a, b, out=c)

tests/cupy_tests/linalg_tests/test_product.py:171: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:65: in dot
    return a.dot(b, out)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fa34f040>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 171, in test_transposed_dot_with_out
E               xp.dot(a, b, out=c)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 65, in dot
E               return a.dot(b, out)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-51acbe/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-51acbe/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
________________ TestProduct.test_transposed_higher_order_inner ________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_higher_order_inner>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_higher_order_inner(self, xp, dtype):
        a = testing.shaped_arange((2, 4, 3), xp, dtype).transpose(2, 0, 1)
        b = testing.shaped_arange((4, 2, 3), xp, dtype).transpose(1, 2, 0)
>       return xp.inner(a, b)

tests/cupy_tests/linalg_tests/test_product.py:253: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:251: in inner
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f38d4371f40>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 253, in test_transposed_higher_order_inner
E               return xp.inner(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 251, in inner
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-d8fc1d/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-d8fc1d/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
____________________ TestProduct.test_transposed_tensordot _____________________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_tensordot>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_tensordot(self, xp, dtype):
        a = testing.shaped_arange((2, 3, 4), xp, dtype).transpose(1, 0, 2)
        b = testing.shaped_arange((4, 3, 2), xp, dtype).transpose(2, 0, 1)
>       return xp.tensordot(a, b)

tests/cupy_tests/linalg_tests/test_product.py:288: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e653d250>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 288, in test_transposed_tensordot
E               return xp.tensordot(a, b)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-d7428e/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-d7428e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_____________ TestProduct.test_transposed_tensordot_with_int_axes ______________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_tensordot_with_int_axes>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_tensordot_with_int_axes(self, xp, dtype):
        if dtype in (numpy.uint8, numpy.int8, numpy.uint16, numpy.int16):
            # Avoid overflow
            a = testing.shaped_arange(
                (1, 2, 3), xp, dtype).transpose(2, 0, 1)
            b = testing.shaped_arange(
                (3, 2, 1), xp, dtype).transpose(2, 1, 0)
>           return xp.tensordot(a, b, axes=2)

tests/cupy_tests/linalg_tests/test_product.py:311: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f37a73d4c40>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 311, in test_transposed_tensordot_with_int_axes
E               return xp.tensordot(a, b, axes=2)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-d66be6/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-d66be6/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_____________ TestProduct.test_transposed_tensordot_with_list_axes _____________

self = <cupy_tests.linalg_tests.test_product.TestProduct testMethod=test_transposed_tensordot_with_list_axes>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int32'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_transposed_tensordot_with_list_axes(self, xp, dtype):
        if dtype in (numpy.uint8, numpy.int8, numpy.uint16, numpy.int16):
            # Avoid overflow
            a = testing.shaped_arange(
                (1, 2, 3), xp, dtype).transpose(2, 0, 1)
            b = testing.shaped_arange(
                (2, 3, 1), xp, dtype).transpose(0, 2, 1)
            return xp.tensordot(a, b, axes=([2, 0], [0, 2]))
        else:
            a = testing.shaped_arange(
                (2, 3, 4, 5), xp, dtype).transpose(2, 0, 3, 1)
            b = testing.shaped_arange(
                (3, 5, 4, 2), xp, dtype).transpose(3, 0, 2, 1)
>           return xp.tensordot(a, b, axes=([2, 0, 3], [3, 2, 1]))

tests/cupy_tests/linalg_tests/test_product.py:347: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:349: in tensordot
    return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:430: in cupy._core._routines_linalg.tensordot_core
    cpdef ndarray tensordot_core(
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34eb213d90>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 347, in test_transposed_tensordot_with_list_axes
E               return xp.tensordot(a, b, axes=([2, 0, 3], [3, 2, 1]))
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 349, in tensordot
E               return _core.tensordot_core(a, b, None, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 430, in cupy._core._routines_linalg.tensordot_core
E               cpdef ndarray tensordot_core(
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-995609/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-995609/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int32'>
_____________________ TestMatrixPower.test_matrix_power_2 ______________________

self = <cupy_tests.linalg_tests.test_product.TestMatrixPower testMethod=test_matrix_power_2>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_matrix_power_2(self, xp, dtype):
        a = testing.shaped_arange((3, 3), xp, dtype)
>       return xp.linalg.matrix_power(a, 2)

tests/cupy_tests/linalg_tests/test_product.py:423: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:382: in matrix_power
    return cupy.matmul(M, M)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ff9f9940>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 423, in test_matrix_power_2
E               return xp.linalg.matrix_power(a, 2)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 382, in matrix_power
E               return cupy.matmul(M, M)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-92769e/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-92769e/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
_____________________ TestMatrixPower.test_matrix_power_3 ______________________

self = <cupy_tests.linalg_tests.test_product.TestMatrixPower testMethod=test_matrix_power_3>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_matrix_power_3(self, xp, dtype):
        a = testing.shaped_arange((3, 3), xp, dtype)
>       return xp.linalg.matrix_power(a, 3)

tests/cupy_tests/linalg_tests/test_product.py:429: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:384: in matrix_power
    return cupy.matmul(cupy.matmul(M, M), M)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34eb200580>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 429, in test_matrix_power_3
E               return xp.linalg.matrix_power(a, 3)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 384, in matrix_power
E               return cupy.matmul(cupy.matmul(M, M), M)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-bf449a/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-bf449a/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
___________________ TestMatrixPower.test_matrix_power_large ____________________

self = <cupy_tests.linalg_tests.test_product.TestMatrixPower testMethod=test_matrix_power_large>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_matrix_power_large(self, xp, dtype):
        a = xp.eye(23, k=17, dtype=dtype) + xp.eye(23, k=-6, dtype=dtype)
>       return xp.linalg.matrix_power(a, 123456789123456789)

tests/cupy_tests/linalg_tests/test_product.py:462: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:390: in matrix_power
    Z = M if Z is None else cupy.matmul(Z, Z)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34fa375d60>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 462, in test_matrix_power_large
E               return xp.linalg.matrix_power(a, 123456789123456789)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 390, in matrix_power
E               Z = M if Z is None else cupy.matmul(Z, Z)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-0849ab/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-0849ab/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
___________________ TestMatrixPower.test_matrix_power_of_two ___________________

self = <cupy_tests.linalg_tests.test_product.TestMatrixPower testMethod=test_matrix_power_of_two>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int8'>

    @testing.for_all_dtypes()
    @testing.numpy_cupy_allclose()
    def test_matrix_power_of_two(self, xp, dtype):
        a = xp.eye(23, k=17, dtype=dtype) + xp.eye(23, k=-6, dtype=dtype)
>       return xp.linalg.matrix_power(a, 1 << 50)

tests/cupy_tests/linalg_tests/test_product.py:456: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:390: in matrix_power
    Z = M if Z is None else cupy.matmul(Z, Z)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f3a10fbe460>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_product.py", line 456, in test_matrix_power_of_two
E               return xp.linalg.matrix_power(a, 1 << 50)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 390, in matrix_power
E               Z = M if Z is None else cupy.matmul(Z, Z)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-48ef72/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-48ef72/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int8'>
________________________ TestLstsq.test_lstsq_solutions ________________________

self = <cupy_tests.linalg_tests.test_solve.TestLstsq object at 0x7f34e7086bb0>

    def test_lstsq_solutions(self):
        # Comapres numpy.linalg.lstsq and cupy.linalg.lstsq solutions for:
        #   a shapes range from (3, 3) to (5, 3) and (3, 5)
        #   b shapes range from (i, 3) to (i, )
        #   sets a random seed for deterministic testing
        for i in range(3, 6):
            for j in range(3, 6):
                for k in range(2, 4):
                    seed = i + j + k
                    # check when b has shape (i, k)
                    self.check_lstsq_solution((i, j), (i, k), seed,
                                              rcond=-1)
                    self.check_lstsq_solution((i, j), (i, k), seed,
                                              rcond=None)
                    self.check_lstsq_solution((i, j), (i, k), seed,
                                              rcond=0.5)
>                   self.check_lstsq_solution((i, j), (i, k), seed,
                                              rcond=1e-6, singular=True)

tests/cupy_tests/linalg_tests/test_solve.py:242: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:837: in test_func
    impl(*args, **kw)
cupy/testing/_helper.py:273: in test_func
    _check_cupy_numpy_error(cupy_error,
cupy/testing/_helper.py:179: in _check_cupy_numpy_error
    _fail_test_with_unexpected_errors(
cupy/testing/_helper.py:134: in _fail_test_with_unexpected_errors
    raise AssertionError(msg).with_traceback(tb)
cupy/testing/_helper.py:47: in _call_func
    result = impl(*args, **kw)
tests/cupy_tests/linalg_tests/test_solve.py:203: in check_lstsq_solution
    a = xp.matmul(
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34ff8061c0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/linalg_tests/test_solve.py", line 203, in check_lstsq_solution
E               a = xp.matmul(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-283183/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-283183/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is i
________________ TestBasic.test_copyto_where_multigpu_raises_6 _________________

self = <cupy_tests.manipulation_tests.test_basic.TestBasic object at 0x7f38d4606910>
dtype = <class 'numpy.float64'>

    @testing.multi_gpu(6)
    @testing.for_all_dtypes()
    def test_copyto_where_multigpu_raises_6(self, dtype):
>       self._check_copyto_where_multigpu_raises(dtype, 6)

tests/cupy_tests/manipulation_tests/test_basic.py:102: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/cupy_tests/manipulation_tests/test_basic.py:77: in _check_copyto_where_multigpu_raises
    with cuda.Device(dev4):
cupy/cuda/device.pyx:182: in cupy.cuda.device.Device.__enter__
    runtime.setDevice(self.id)
cupy_backends/cuda/api/runtime.pyx:355: in cupy_backends.cuda.api.runtime.setDevice
    check_status(status)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   raise CUDARuntimeError(status)
E   cupy_backends.cuda.api.runtime.CUDARuntimeError: hipErrorInvalidDevice: hipErrorInvalidDevice

cupy_backends/cuda/api/runtime.pyx:132: CUDARuntimeError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
______ TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))}.test_cupy_matmul _______

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))} testMethod=test_cupy_matmul>  parameter: {'shape_pair': ((3, 2), (2, 4))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_cupy_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return xp.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:75: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e678eee0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 75, in test_cupy_matmul
E               return xp.matmul(x1, x2)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-ee8405/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-ee8405/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
____ TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))}.test_operator_matmul _____

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))} testMethod=test_operator_matmul>  parameter: {'shape_pair': ((3, 2), (2, 4))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_operator_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return operator.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1182: in cupy._core.core.ndarray.__matmul__
    return cupy.linalg._product.matmul(x, y)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e61a3700>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 67, in test_operator_matmul
E               return operator.matmul(x1, x2)
E             File "cupy/_core/core.pyx", line 1182, in cupy._core.core.ndarray.__matmul__
E               return cupy.linalg._product.matmul(x, y)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-cd92dd/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-cd92dd/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
_______ TestMatmul_param_4_{shape_pair=((2,), (2, 4))}.test_cupy_matmul ________

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_4_{shape_pair=((2,), (2, 4))} testMethod=test_cupy_matmul>  parameter: {'shape_pair': ((2,), (2, 4))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_cupy_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return xp.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:75: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e64988b0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 75, in test_cupy_matmul
E               return xp.matmul(x1, x2)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-bcc9a4/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-bcc9a4/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
_____ TestMatmul_param_4_{shape_pair=((2,), (2, 4))}.test_operator_matmul ______

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_4_{shape_pair=((2,), (2, 4))} testMethod=test_operator_matmul>  parameter: {'shape_pair': ((2,), (2, 4))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_operator_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return operator.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1182: in cupy._core.core.ndarray.__matmul__
    return cupy.linalg._product.matmul(x, y)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e67687c0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 67, in test_operator_matmul
E               return operator.matmul(x1, x2)
E             File "cupy/_core/core.pyx", line 1182, in cupy._core.core.ndarray.__matmul__
E               return cupy.linalg._product.matmul(x, y)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-4270f0/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-4270f0/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
_______ TestMatmul_param_6_{shape_pair=((3, 2), (2,))}.test_cupy_matmul ________

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_6_{shape_pair=((3, 2), (2,))} testMethod=test_cupy_matmul>  parameter: {'shape_pair': ((3, 2), (2,))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_cupy_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return xp.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:75: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e625e5e0>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 75, in test_cupy_matmul
E               return xp.matmul(x1, x2)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-11ccd8/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-11ccd8/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
_____ TestMatmul_param_6_{shape_pair=((3, 2), (2,))}.test_operator_matmul ______

self = <<cupy_tests.math_tests.test_matmul.TestMatmul_param_6_{shape_pair=((3, 2), (2,))} testMethod=test_operator_matmul>  parameter: {'shape_pair': ((3, 2), (2,))}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype1 = <class 'numpy.int8'>, dtype2 = <class 'numpy.int8'>

    @testing.for_all_dtypes(name='dtype1')
    @testing.for_all_dtypes(name='dtype2')
    @testing.numpy_cupy_allclose(rtol=1e-3, atol=1e-3)  # required for uint8
    def test_operator_matmul(self, xp, dtype1, dtype2):
        x1 = testing.shaped_arange(self.shape_pair[0], xp, dtype1)
        x2 = testing.shaped_arange(self.shape_pair[1], xp, dtype2)
>       return operator.matmul(x1, x2)

tests/cupy_tests/math_tests/test_matmul.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/_core/core.pyx:1182: in cupy._core.core.ndarray.__matmul__
    return cupy.linalg._product.matmul(x, y)
cupy/linalg/_product.py:42: in matmul
    return _gu_func_matmul(x1, x2, out=out, axes=axes)
cupy/_core/_gufuncs.py:676: in __call__
    self._apply_func_to_inputs(
cupy/_core/_gufuncs.py:393: in _apply_func_to_inputs
    fouts = func(*args)
cupy/_core/_routines_linalg.pyx:691: in cupy._core._routines_linalg.matmul
    cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
cupy/_core/_routines_linalg.pyx:732: in cupy._core._routines_linalg.matmul
    return dot(a, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f34e6497910>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_matmul.py", line 67, in test_operator_matmul
E               return operator.matmul(x1, x2)
E             File "cupy/_core/core.pyx", line 1182, in cupy._core.core.ndarray.__matmul__
E               return cupy.linalg._product.matmul(x, y)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/linalg/_product.py", line 42, in matmul
E               return _gu_func_matmul(x1, x2, out=out, axes=axes)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 676, in __call__
E               self._apply_func_to_inputs(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/_gufuncs.py", line 393, in _apply_func_to_inputs
E               fouts = func(*args)
E             File "cupy/_core/_routines_linalg.pyx", line 691, in cupy._core._routines_linalg.matmul
E               cpdef ndarray matmul(ndarray a, ndarray b, ndarray out=None):
E             File "cupy/_core/_routines_linalg.pyx", line 732, in cupy._core._routines_linalg.matmul
E               return dot(a, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-fd13f9/input/CompileSource:203:27: error: redeclaration of '__hiprtc_16' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:204:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:205:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:206:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:207:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:208:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:209:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:210:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:211:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:212:27: error: redefinition of '__hiprtc_16'
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-fd13f9/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_16 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype2 is <class 'numpy.int8'>
dtype1 is <class 'numpy.int8'>
_________ TestConvolve_param_0_{mode='valid'}.test_convolve_diff_types _________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_1_{mode='same'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
_________ TestConvolve_param_2_{mode='full'}.test_convolve_diff_types __________
[XPASS(strict)] HIP/ROCm may have a bug with larger `b`
________ TestCorrelate_param_0_{mode='valid'}.test_correlate_diff_types ________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_1_{mode='full'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
________ TestCorrelate_param_2_{mode='same'}.test_correlate_diff_types _________
[XPASS(strict)] ROCm/HIP may have a bug
_ TestHfft2.test_ihfft2[_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(2, 5, 20)}] _

self = <<cupyx_tests.scipy_tests.fft_tests.test_fft.TestHfft2 object at 0x7f346b7d90d0>  parameter: {'shape': (2, 5, 20), 's': None, 'axes': (0, 1, 2), 'norm': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(rtol=1e-4, atol=1e-7, accept_error=ValueError,
                                 contiguous_check=False)
    def test_ihfft2(self, xp, dtype):
        x = testing.shaped_random(self.shape, xp, dtype)
        x_orig = x.copy()
        out = _fft_module(xp).ihfft2(x, s=self.s, axes=self.axes,
                                     norm=self.norm)
>       testing.assert_array_equal(x, x_orig)

tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py:1688: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[ 1.53584180e+01,  1.23072261e+01, -1.07849155e+01,
          1.82243668e+01, -5.14160201e+01,  4.14770234e+01...39550795e+00,
          4.90458809e+00,  2.27414628e+00,  2.54356482e+00,
          5.80291603e-01,  4.34416626e+00]]])
y = array([[[5.48813504, 7.15189366, 6.02763376, 5.44883183, 4.23654799,
         6.45894113, 4.37587211, 8.91773001, 9.63...2.09843749, 1.86193006, 9.4437239 , 7.39550795,
         4.90458809, 2.27414628, 2.54356482, 0.5802916 , 4.34416626]]])
err_msg = '', verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py", line 1688, in test_ihfft2
E           testing.assert_array_equal(x, x_orig)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_array.py", line 91, in assert_array_equal
E           numpy.testing.assert_array_equal(
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 930, in assert_array_equal
E           assert_array_compare(operator.__eq__, x, y, err_msg=err_msg,
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 840, in assert_array_compare
E           raise AssertionError(msg)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 28 / 200 (14%)
E       Max absolute difference: 75.12240265
E       Max relative difference: 136.76389466
E        x: array([[[ 1.535842e+01,  1.230723e+01, -1.078492e+01,  1.822437e+01,
E                -5.141602e+01,  4.147702e+01,  3.419159e+01,  2.456682e+00,
E                 5.845193e+00,  5.883421e+00,  4.122912e+01, -4.282756e+01,...
E        y: array([[[5.488135, 7.151894, 6.027634, 5.448832, 4.236548, 6.458941,
E                4.375872, 8.91773 , 9.636628, 3.834415, 7.91725 , 5.288949,
E                5.680446, 9.255966, 0.710361, 0.871293, 0.202184, 8.326198,...

cupy/testing/_array.py:91: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHfftn.test_ihfftn[_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(3, 5, 20)}] _

self = <<cupyx_tests.scipy_tests.fft_tests.test_fft.TestHfftn object at 0x7f346c6a44c0>  parameter: {'shape': (3, 5, 20), 's': None, 'axes': (0, 1, 2), 'norm': None}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.float64'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(rtol=1e-4, atol=1e-7, accept_error=ValueError,
                                 contiguous_check=False)
    def test_ihfftn(self, xp, dtype):
        x = testing.shaped_random(self.shape, xp, dtype)
        x_orig = x.copy()
        out = _fft_module(xp).ihfftn(x, s=self.s, axes=self.axes,
                                     norm=self.norm)
>       testing.assert_array_equal(x, x_orig)

tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py:1764: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[ 3.39460184e+01, -3.07111677e+01,  3.31491728e+01,
          1.54800553e+01, -5.91485636e+01, -3.63377748e+01...11318983e+00,
          2.24317029e+00,  9.78444845e-01,  8.62191517e+00,
          9.72919489e+00,  9.60834658e+00]]])
y = array([[[5.48813504, 7.15189366, 6.02763376, 5.44883183, 4.23654799,
         6.45894113, 4.37587211, 8.91773001, 9.63...1.36900272, 8.22117733, 1.89847912, 5.11318983,
         2.24317029, 0.97844484, 8.62191517, 9.72919489, 9.60834658]]])
err_msg = '', verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py", line 1764, in test_ihfftn
E           testing.assert_array_equal(x, x_orig)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_array.py", line 91, in assert_array_equal
E           numpy.testing.assert_array_equal(
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 930, in assert_array_equal
E           assert_array_compare(operator.__eq__, x, y, err_msg=err_msg,
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 840, in assert_array_compare
E           raise AssertionError(msg)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 10 / 300 (3.33%)
E       Max absolute difference: 101.69820799
E       Max relative difference: 23.24067189
E        x: array([[[ 3.394602e+01, -3.071117e+01,  3.314917e+01,  1.548006e+01,
E                -5.914856e+01, -3.633777e+01, -9.732234e+01, -3.423628e+01,
E                -4.661360e+01, -2.827489e+01,  7.917250e+00,  5.288949e+00,...
E        y: array([[[5.488135, 7.151894, 6.027634, 5.448832, 4.236548, 6.458941,
E                4.375872, 8.91773 , 9.636628, 3.834415, 7.91725 , 5.288949,
E                5.680446, 9.255966, 0.710361, 0.871293, 0.202184, 8.326198,...

cupy/testing/_array.py:91: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestHfftn.test_ihfftn[_param_25_{axes=(0, 1, 2), norm='backward', s=None, shape=(3, 5, 20)}] _

self = <<cupyx_tests.scipy_tests.fft_tests.test_fft.TestHfftn object at 0x7f34694ea4c0>  parameter: {'shape': (3, 5, 20), 's': None, 'axes': (0, 1, 2), 'norm': 'backward'}>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
dtype = <class 'numpy.int16'>

    @testing.for_all_dtypes(no_complex=True)
    @testing.numpy_cupy_allclose(rtol=1e-4, atol=1e-7, accept_error=ValueError,
                                 contiguous_check=False)
    def test_ihfftn(self, xp, dtype):
        x = testing.shaped_random(self.shape, xp, dtype)
        x_orig = x.copy()
        out = _fft_module(xp).ihfftn(x, s=self.s, axes=self.axes,
                                     norm=self.norm)
>       testing.assert_array_equal(x, x_orig)

tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py:1764: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

x = array([[[ 25288,  18426,  22099, -16314, -20876,  -3998,  -4846,  16442,
          20522, -21466, -13184, -16298, -166...28764, -24040, -30730, -16324,  22296, -12042,  27063, -16367,
         -20267, -30385,  14704,  16427]]], dtype=int16)
y = array([[[5, 7, 6, 5, 4, 6, 4, 8, 9, 3, 7, 5, 5, 9, 0, 0, 0, 8, 7, 8],
        [9, 7, 4, 7, 1, 6, 1, 9, 5, 4, 2, 7, 4, ... 8, 3, 9, 2, 9, 9, 7, 6, 8],
        [2, 8, 6, 0, 3, 1, 9, 4, 4, 6, 3, 1, 8, 1, 5, 2, 0, 8, 9, 9]]],
      dtype=int16)
err_msg = '', verbose = True, strides_check = False

    def assert_array_equal(x, y, err_msg='', verbose=True, strides_check=False):
        """Raises an AssertionError if two array_like objects are not equal.
    
        Args:
             x(numpy.ndarray or cupy.ndarray): The actual object to check.
             y(numpy.ndarray or cupy.ndarray): The desired, expected object.
             strides_check(bool): If ``True``, consistency of strides is also
                 checked.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting values
                 are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_array_equal`
        """
>       numpy.testing.assert_array_equal(
            cupy.asnumpy(x), cupy.asnumpy(y), err_msg=err_msg,
            verbose=verbose)
E       AssertionError: Only cupy raises error
E       
E       Traceback (most recent call last):
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E           result = impl(*args, **kw)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py", line 1764, in test_ihfftn
E           testing.assert_array_equal(x, x_orig)
E         File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_array.py", line 91, in assert_array_equal
E           numpy.testing.assert_array_equal(
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 930, in assert_array_equal
E           assert_array_compare(operator.__eq__, x, y, err_msg=err_msg,
E         File "/home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/testing/_private/utils.py", line 840, in assert_array_compare
E           raise AssertionError(msg)
E       AssertionError: 
E       Arrays are not equal
E       
E       Mismatched elements: 300 / 300 (100%)
E       Max absolute difference: 32652
E       Max relative difference: 31094.
E        x: array([[[ 25288,  18426,  22099, -16314, -20876,  -3998,  -4846,  16442,
E                 20522, -21466, -13184, -16298, -16697, -32159, -10997,  16449,
E                 -8420,  22567, -14907,  16449],...
E        y: array([[[5, 7, 6, 5, 4, 6, 4, 8, 9, 3, 7, 5, 5, 9, 0, 0, 0, 8, 7, 8],
E               [9, 7, 4, 7, 1, 6, 1, 9, 5, 4, 2, 7, 4, 5, 0, 6, 6, 6, 9, 6],
E               [3, 4, 6, 0, 6, 6, 2, 1, 3, 3, 5, 4, 9, 1, 2, 1, 6, 2, 4, 2],...

cupy/testing/_array.py:91: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.int16'>
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f33fc9ec670>  parameter: {'mode': 'grid-constant', 'order': 4}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([229.76997843, 598.96953239])
desired = array([3.06993892, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 590.96953239
E       Max relative difference: 73.87119155
E        x: array([229.769978, 598.969532])
E        y: array([3.069939, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestMapCoordinatesHalfInteger.test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestMapCoordinatesHalfInteger object at 0x7f33fc7aa190>  parameter: {'mode': 'grid-constant', 'order': 5}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([ 78.42728447, 201.97560613])
desired = array([3.12122783, 8.        ]), rtol = 1e-07, atol = 0.0001
err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=0.0001
E       
E       Mismatched elements: 2 / 2 (100%)
E       Max absolute difference: 193.97560613
E       Max relative difference: 24.24695077
E        x: array([ 78.427284, 201.975606])
E        y: array([3.121228, 8.      ])

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3f05160>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3f2e280>  parameter: {'grid_mode': False, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3dead00>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3f15340>  parameter: {'grid_mode': False, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3db8e20>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-9.26215027e-04],
        [-7.12910551e-05],
        [-1.04548770e-03],
        [ 6.02170185e-04],
        [ ...   [-1.58413204e-05],
        [-2.26292832e-05],
        [-1.52809316e-05],
        [-2.62873400e-05]]], dtype=float32)
desired = array([[[-1.91677706e-16],
        [ 6.02007280e-16],
        [ 7.39644969e-18],
        [ 9.42839520e-17],
        [-...   [ 2.49078413e-18],
        [-6.86374620e-18],
        [-2.01807717e-17],
        [-1.36889723e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 95 / 100 (95%)
E       Max absolute difference: 0.00124037
E       Max relative difference: 1.6367563e+14
E        x: array([[[-9.262150e-04],
E               [-7.129106e-05],
E               [-1.045488e-03],...
E        y: array([[[-1.916777e-16],
E               [ 6.020073e-16],
E               [ 7.396450e-18],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3f25340>  parameter: {'grid_mode': False, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-6.23873319e-04],
        [-6.52701594e-04],
        [-5.34185849e-04],
        [-7.05319864e-04],
        [-...   [-2.50156190e-05],
        [ 9.55036171e-07],
        [-1.27298597e-06],
        [-4.17136789e-06]]], dtype=float32)
desired = array([[[ 2.1000416e-16],
        [-7.7505151e-16],
        [-6.6172874e-17],
        [-6.5140899e-16],
        [ 7.95...       [-1.5922411e-17],
        [ 3.1236140e-17],
        [-5.3157008e-17],
        [-1.3124647e-17]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 85 / 100 (85%)
E       Max absolute difference: 0.00084527
E       Max relative difference: 1.881553e+13
E        x: array([[[-6.238733e-04],
E               [-6.527016e-04],
E               [-5.341858e-04],...
E        y: array([[[ 2.100042e-16],
E               [-7.750515e-16],
E               [-6.617287e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3d6b040>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[-1.6466675e-04],
        [-3.1765160e-06],
        [-2.8256103e-04],
        [ 1.0465207e-04],
        [-5.02...       [-1.4928388e-06],
        [-5.8970027e-06],
        [-2.4932410e-06],
        [-3.5395026e-06]]], dtype=float32)
desired = array([[[-8.12850668e-17],
        [-9.62678620e-17],
        [-7.64445911e-17],
        [ 6.90388762e-17],
        [-...   [-1.31306278e-18],
        [-2.34584224e-18],
        [-1.16198641e-18],
        [-3.16820747e-19]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 75 / 100 (75%)
E       Max absolute difference: 0.00034115
E       Max relative difference: 2.5044335e+14
E        x: array([[[-1.646668e-04],
E               [-3.176516e-06],
E               [-2.825610e-04],...
E        y: array([[[-8.128507e-17],
E               [-9.626786e-17],
E               [-7.644459e-17],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3c841f0>  parameter: {'grid_mode': False, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.46576144e-06],
        [-1.07652804e-05],
        [ 1.48250510e-05],
        [-2.88788979e-05],
        [-...   [ 3.59045725e-06],
        [ 3.90473633e-06],
        [ 2.02454498e-06],
        [ 1.08106917e-06]]], dtype=float32)
desired = array([[[-5.28892732e-17],
        [-4.68497761e-17],
        [-1.70810335e-16],
        [-1.91986781e-16],
        [-...   [-3.94138989e-18],
        [-8.65396191e-18],
        [ 1.07858407e-18],
        [-2.29544853e-18]]], dtype=float32)
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 40 / 100 (40%)
E       Max absolute difference: 0.00011814
E       Max relative difference: 9.6834375e+13
E        x: array([[[ 1.465761e-06],
E               [-1.076528e-05],
E               [ 1.482505e-05],...
E        y: array([[[-5.288927e-17],
E               [-4.684978e-17],
E               [-1.708103e-16],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3da8a00>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.    ... [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ],
        [   0.        ]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[   0.      ],
E               [   0.      ],
E               [   0.      ],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f38ea8e0>  parameter: {'grid_mode': True, 'mode': 'constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
desired = array([[[ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ ...000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00],
        [ 0.00000000e+00]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 64 / 100 (64%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...
E        y: array([[[ 0.000000e+00],
E               [ 0.000000e+00],
E               [ 0.000000e+00],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3f25820>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  48.82195577],
        [  48.82195577],
        [ 290.39318135],
        [ 337.78017528],
        [ 112.1240... [ -53.24969236],
        [ -21.88859247],
        [  44.15090669],
        [  53.29762289],
        [  53.29762289]]])
desired = array([[[ 8.54663183e-03],
        [ 8.54663183e-03],
        [ 5.30645857e-02],
        [ 6.15797757e-02],
        [ ...126e-03],
        [-5.57818230e-04],
        [ 2.89445841e-04],
        [ 8.46143247e-05],
        [ 8.46143247e-05]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.88795612
E        x: array([[[  48.821956],
E               [  48.821956],
E               [ 290.393181],...
E        y: array([[[ 8.546632e-03],
E               [ 8.546632e-03],
E               [ 5.306459e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3cb9220>  parameter: {'grid_mode': True, 'mode': 'mirror', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.71685805e+00],
        [ 4.71685805e+00],
        [ 2.76221015e+01],
        [ 3.32433453e+01],
        [ ...958e+00],
        [-1.62349834e+00],
        [ 1.50933488e+01],
        [ 1.97919669e+01],
        [ 1.97919669e+01]]])
desired = array([[[ 8.60075856e-03],
        [ 8.60075856e-03],
        [ 5.25533883e-02],
        [ 6.23449044e-02],
        [ ...600e-03],
        [-8.00397905e-04],
        [ 4.16976616e-04],
        [ 1.32949066e-04],
        [ 1.32949066e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248854
E        x: array([[[ 4.716858e+00],
E               [ 4.716858e+00],
E               [ 2.762210e+01],...
E        y: array([[[ 8.600759e-03],
E               [ 8.600759e-03],
E               [ 5.255339e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f37c6130>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[  53.29762289],
        [  51.0107262 ],
        [ 303.41199632],
        [ 352.92342892],
        [ 117.1507... [ -50.96485228],
        [ -20.9493958 ],
        [  42.25647769],
        [  51.0107262 ],
        [  48.82195577]]])
desired = array([[[ 8.46143247e-05],
        [ 8.50392545e-04],
        [ 5.27994291e-03],
        [ 6.12720698e-03],
        [ ...636e-02],
        [-5.60619571e-03],
        [ 2.90899427e-03],
        [ 8.50392545e-04],
        [ 8.54663183e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2336.52632552
E       Max relative difference: 629887.8879561
E        x: array([[[  53.297623],
E               [  51.010726],
E               [ 303.411996],...
E        y: array([[[ 8.461432e-05],
E               [ 8.503925e-04],
E               [ 5.279943e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3da8a90>  parameter: {'grid_mode': True, 'mode': 'wrap', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.97919669e+01],
        [ 9.66208561e+00],
        [ 5.65815436e+01],
        [ 6.80961870e+01],
        [ ...577e+00],
        [-7.92562963e-01],
        [ 7.36830399e+00],
        [ 9.66208561e+00],
        [ 4.71685805e+00]]])
desired = array([[[ 1.32949066e-04],
        [ 1.06932821e-03],
        [ 6.53393769e-03],
        [ 7.75131221e-03],
        [ ...718e-02],
        [-6.43771396e-03],
        [ 3.35380211e-03],
        [ 1.06932821e-03],
        [ 8.60075856e-03]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 233.83963068
E       Max relative difference: 148867.79248851
E        x: array([[[ 1.979197e+01],
E               [ 9.662086e+00],
E               [ 5.658154e+01],...
E        y: array([[[ 1.329491e-04],
E               [ 1.069328e-03],
E               [ 6.533938e-03],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f3c86850>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 4, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 5.63055219e+01],
        [-1.22528405e+02],
        [-3.83476709e+02],
        [-3.83476709e+02],
        [-...021e+00],
        [ 4.40535983e+00],
        [-2.69124172e+00],
        [-1.59183812e+00],
        [ 9.72456581e-01]]])
desired = array([[[ 1.27949283e-02],
        [-2.43606830e-02],
        [-7.91692940e-02],
        [-7.91692940e-02],
        [-...333e-03],
        [ 9.13158865e-04],
        [-5.54269262e-04],
        [-3.27391850e-04],
        [ 1.99955080e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 2611.23242921
E       Max relative difference: 5747.85704324
E        x: array([[[ 5.630552e+01],
E               [-1.225284e+02],
E               [-3.834767e+02],...
E        y: array([[[ 1.279493e-02],
E               [-2.436068e-02],
E               [-7.916929e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestZoomOutputSize1.test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}] _

args = (<<cupyx_tests.scipy_tests.ndimage_tests.test_interpolation.TestZoomOutputSize1 object at 0x7f33f37f4ca0>  parameter: {'grid_mode': True, 'mode': 'grid-constant', 'order': 5, 'shape': (5, 5, 2), 'zoom': (2, 2, 0.5)}>,)
kw = {'dtype': <class 'numpy.float64'>}, dtype = <class 'numpy.float64'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 4.16965077e+00],
        [-1.18699209e+01],
        [-3.36177788e+01],
        [-3.36177788e+01],
        [-...671e-01],
        [ 6.07624141e-01],
        [-3.96545295e-01],
        [-2.61764771e-01],
        [ 1.70742628e-01]]])
desired = array([[[ 1.44354197e-02],
        [-2.67893098e-02],
        [-8.45564959e-02],
        [-8.45564959e-02],
        [-...699e-03],
        [ 1.49724992e-03],
        [-9.55056276e-04],
        [-6.25982935e-04],
        [ 4.07383783e-04]]])
rtol = 1e-07, atol = 1e-05, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=1e-07, atol=1e-05
E       
E       Mismatched elements: 100 / 100 (100%)
E       Max absolute difference: 270.54779997
E       Max relative difference: 678.67662434
E        x: array([[[ 4.169651e+00],
E               [-1.186992e+01],
E               [-3.361778e+01],...
E        y: array([[[ 1.443542e-02],
E               [-2.678931e-02],
E               [-8.455650e-02],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float64'>
_ TestFFTConvolve.test_fftconvolve[_param_12_{mode='full', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f33e56adfa0>  parameter: {'mode': 'full', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float16'>}, dtype = <class 'numpy.float16'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ -34.612274  ,   -3.0418015 ,  -27.98261   ,  -29.675184  ,
           35.042538  ,    3.4613445 ,  -56.22182...3.77458   ,  -39.426136  ,
          -41.15338   ,  -19.600595  ,  -46.21518   ,  -24.944464  ]]],
      dtype=float32)
desired = array([[[ 30.12124  ,  78.50814  , 117.31553  , 116.12611  ,
          98.56445  ,  98.59596  ,  95.73972  , 119.13314...040585 ,  47.460995 ,  68.94418  ,
          60.25552  ,  72.959526 ,  56.95892  ,   9.928768 ]]],
      dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 360 / 360 (100%)
E       Max absolute difference: 753.6503
E       Max relative difference: 3.7981677
E        x: array([[[ -34.612274,   -3.041801,  -27.98261 ,  -29.675184,
E                  35.042538,    3.461344,  -56.22182 ,  -67.22405 ,
E                 -50.98412 ,  -67.73701 , -102.06183 ,  -44.994675],...
E        y: array([[[ 30.12124 ,  78.50814 , 117.31553 , 116.12611 ,  98.56445 ,
E                 98.59596 ,  95.73972 , 119.13314 , 142.99367 , 143.66728 ,
E                 85.48225 ,  23.10874 ],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float16'>
_ TestFFTConvolve.test_fftconvolve[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f33e53936a0>  parameter: {'mode': 'valid', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[118.274254, 174.06413 , 166.02187 ,  95.01542 ,  74.11646 ,
         118.749565,  80.258766,  86.69617 ],
   ....6223  , 190.65385 , 179.1765  , 149.10751 ,  81.22314 ,
         113.108116,  85.41631 ,  97.64045 ]]], dtype=float32)
desired = array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
         714.88525, 728.84973, 808.5652 ],
        [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
         719.43756, 815.77496, 851.23706]]], dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 16 / 16 (100%)
E       Max absolute difference: 753.5966
E       Max relative difference: 0.89529425
E        x: array([[[118.274254, 174.06413 , 166.02187 ,  95.01542 ,  74.11646 ,
E                118.749565,  80.258766,  86.69617 ],
E               [161.6223  , 190.65385 , 179.1765  , 149.10751 ,  81.22314 ,
E                113.108116,  85.41631 ,  97.64045 ]]], dtype=float32)
E        y: array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
E                714.88525, 728.84973, 808.5652 ],
E               [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
E                719.43756, 815.77496, 851.23706]]], dtype=float32)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestFFTConvolve.test_convolve_fft[_param_12_{mode='full', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f33e56cecd0>  parameter: {'mode': 'full', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[ 1.47312670e+01, -3.66314278e+01, -1.18559837e+02,
         -1.63726257e+02, -1.75171310e+02, -1.60101852e+02..., -1.51125381e+02, -1.75012436e+02,
         -1.62156921e+02, -1.39059891e+02, -8.29051056e+01]]],
      dtype=float32)
desired = array([[[ 30.11964 ,  78.50114 , 117.31052 , 116.12192 ,  98.5526  ,
          98.59048 ,  95.745415, 119.16964 , 143....          61.03017 ,  47.46052 ,  68.94269 ,  60.25647 ,  72.94773 ,
          56.956516,   9.927667]]], dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 360 / 360 (100%)
E       Max absolute difference: 438.47577
E       Max relative difference: 10.518294
E        x: array([[[ 1.473127e+01, -3.663143e+01, -1.185598e+02, -1.637263e+02,
E                -1.751713e+02, -1.601019e+02, -1.175476e+02, -8.483935e+01,
E                -8.497591e+01, -1.405985e+02, -1.610410e+02, -6.330575e+01],...
E        y: array([[[ 30.11964 ,  78.50114 , 117.31052 , 116.12192 ,  98.5526  ,
E                 98.59048 ,  95.745415, 119.16964 , 143.04192 , 143.71674 ,
E                 85.50938 ,  23.112478],...

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_ TestFFTConvolve.test_convolve_fft[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}] _

args = (<<test_signaltools.TestFFTConvolve object at 0x7f33e532c8b0>  parameter: {'mode': 'valid', 'size1': (3, 4, 10), 'size2': 3}>,)
kw = {'dtype': <class 'numpy.float32'>}, dtype = <class 'numpy.float32'>

    @_wraps_partial(impl, name)
    def test_func(*args, **kw):
        for dtype in dtypes:
            try:
                kw[name] = numpy.dtype(dtype).type
>               impl(*args, **kw)

cupy/testing/_helper.py:837: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupy/testing/_helper.py:355: in test_func
    check_func(cupy_r, numpy_r)
cupy/testing/_helper.py:507: in check_func
    _array.assert_allclose(c, n, rtol1, atol1, err_msg, verbose)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

actual = array([[[178.17073, 274.36148, 172.0985 , 186.27112, 108.93734,
         160.82693, 168.74333, 231.49675],
        [236.45097, 276.96222, 190.01935, 205.55153, 138.89583,
         221.15894, 202.55327, 242.2877 ]]], dtype=float32)
desired = array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
         714.88525, 728.84973, 808.5652 ],
        [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
         719.43756, 815.77496, 851.23706]]], dtype=float32)
rtol = 0.001, atol = 0.001, err_msg = '', verbose = True

    def assert_allclose(actual, desired, rtol=1e-7, atol=0, err_msg='',
                        verbose=True):
        """Raises an AssertionError if objects are not equal up to desired tolerance.
    
        Args:
             actual(numpy.ndarray or cupy.ndarray): The actual object to check.
             desired(numpy.ndarray or cupy.ndarray): The desired, expected object.
             rtol(float): Relative tolerance.
             atol(float): Absolute tolerance.
             err_msg(str): The error message to be printed in case of failure.
             verbose(bool): If ``True``, the conflicting
                 values are appended to the error message.
    
        .. seealso:: :func:`numpy.testing.assert_allclose`
    
        """  # NOQA
>       numpy.testing.assert_allclose(
            cupy.asnumpy(actual), cupy.asnumpy(desired),
            rtol=rtol, atol=atol, err_msg=err_msg, verbose=verbose)
E       AssertionError: 
E       Not equal to tolerance rtol=0.001, atol=0.001
E       
E       Mismatched elements: 16 / 16 (100%)
E       Max absolute difference: 643.5523
E       Max relative difference: 0.8101223
E        x: array([[[178.17073, 274.36148, 172.0985 , 186.27112, 108.93734,
E                160.82693, 168.74333, 231.49675],
E               [236.45097, 276.96222, 190.01935, 205.55153, 138.89583,
E                221.15894, 202.55327, 242.2877 ]]], dtype=float32)
E        y: array([[[800.5107 , 862.97485, 683.19934, 644.7456 , 573.72375,
E                714.88525, 728.84973, 808.5652 ],
E               [879.7415 , 920.5145 , 785.2407 , 688.98376, 587.2645 ,
E                719.43756, 815.77496, 851.23706]]], dtype=float32)

cupy/testing/_array.py:24: AssertionError
----------------------------- Captured stdout call -----------------------------
dtype is <class 'numpy.float32'>
_____________ TestLOBPCG.test_small_generate_input_for_mikota_pair _____________

self = <cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLOBPCG object at 0x7f33d7cd7730>
xp = <module 'cupy' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/__init__.py'>
sp = <module 'cupyx.scipy.sparse' from '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/__init__.py'>

    @testing.numpy_cupy_allclose(rtol=1e-5, atol=1e-5, sp_name='sp',
                                 contiguous_check=False)
    def test_small_generate_input_for_mikota_pair(self, xp, sp):
        A, B = self._generate_input_for_mikota_pair(10, xp)
        n = A.shape[0]
        X = self._generate_random_initial_ortho_eigvec(n, 10, xp)
>       eigvals, eigvecs = sp.linalg.lobpcg(A,
                                            X, B=B,
                                            tol=1e-5, maxiter=30,
                                            largest=False)

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:964: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cupyx/scipy/sparse/linalg/_lobpcg.py:298: in lobpcg
    A_dense = A(cupy.eye(n, dtype=A.dtype))
cupyx/scipy/sparse/linalg/_interface.py:170: in __call__
    return self*x
cupyx/scipy/sparse/linalg/_interface.py:173: in __mul__
    return self.dot(x)
cupyx/scipy/sparse/linalg/_interface.py:186: in dot
    return self.matmat(x)
cupyx/scipy/sparse/linalg/_interface.py:142: in matmat
    Y = self._matmat(X)
cupyx/scipy/sparse/linalg/_interface.py:489: in _matmat
    return self.A.dot(X)
cupy/_core/core.pyx:1618: in cupy._core.core.ndarray.dot
    return _linalg.dot(self, b, out)
cupy/_core/_routines_linalg.pyx:427: in cupy._core._routines_linalg.dot
    return tensordot_core(a, b, out, n, m, k, ret_shape)
cupy/_core/_routines_linalg.pyx:501: in cupy._core._routines_linalg.tensordot_core
    return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
cupy/_core/_routines_linalg.pyx:327: in cupy._core._routines_linalg._integral_tensordot_core
    kern = _tensordot_core_int_kernel(config, dtype)
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/_routines_linalg.pyx:302: in cupy._core._routines_linalg._tensordot_core_int_kernel
    ker = mod.get_function(
cupy/_core/raw.pyx:470: in cupy._core.raw.RawModule.get_function
    mangled_name = self.module.mapping.get(name)
cupy/_core/raw.pyx:394: in cupy._core.raw.RawModule.module.__get__
    return self._module()
cupy/_core/raw.pyx:402: in cupy._core.raw.RawModule._module
    mod = _get_raw_module(
cupy/_util.pyx:67: in cupy._util.memoize.decorator.ret
    result = f(*args, **kwargs)
cupy/_core/raw.pyx:547: in cupy._core.raw._get_raw_module
    mod = cupy._core.core.compile_with_cache(
cupy/_core/core.pyx:2026: in cupy._core.core.compile_with_cache
    cpdef function.Module compile_with_cache(
cupy/_core/core.pyx:2089: in cupy._core.core.compile_with_cache
    return cuda.compiler._compile_module_with_cache(
cupy/cuda/compiler.py:467: in _compile_module_with_cache
    return _compile_with_cache_hip(
cupy/cuda/compiler.py:867: in _compile_with_cache_hip
    binary, mapping = compile_using_nvrtc(
cupy/cuda/compiler.py:300: in compile_using_nvrtc
    return _compile(source, options, cu_path,
cupy/cuda/compiler.py:284: in _compile
    compiled_obj, mapping = prog.compile(options, log_stream)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <cupy.cuda.compiler._NVRTCProgram object at 0x7f33d81d7430>
options = ('--std=c++11', '-I/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/_core/include', '-I/opt/rocm/include', '-fcuda-flush-denormals-to-zero')
log_stream = None

    def compile(self, options=(), log_stream=None):
        try:
            if self.name_expressions:
                for ker in self.name_expressions:
                    nvrtc.addAddNameExpression(self.ptr, ker)
            nvrtc.compileProgram(self.ptr, options)
            mapping = None
            if self.name_expressions:
                mapping = {}
                for ker in self.name_expressions:
                    mapping[ker] = nvrtc.getLoweredName(self.ptr, ker)
            if log_stream is not None:
                log_stream.write(nvrtc.getProgramLog(self.ptr))
            # This is to ensure backwards compatibility with nvrtc
            if self.method == 'cubin':
                return nvrtc.getCUBIN(self.ptr), mapping
            elif self.method == 'ptx':
                return nvrtc.getPTX(self.ptr), mapping
            else:
                raise RuntimeError('Unknown NVRTC compile method')
        except nvrtc.NVRTCError:
            log = nvrtc.getProgramLog(self.ptr)
>           raise CompileException(log, self.src, self.name, options,
                                   'nvrtc' if not runtime.is_hip else 'hiprtc')
E           AssertionError: Only cupy raises error
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 664, in compile
E               nvrtc.compileProgram(self.ptr, options)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 139, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               cpdef compileProgram(intptr_t prog, options):
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 151, in cupy_backends.cuda.libs.nvrtc.compileProgram
E               check_status(status)
E             File "cupy_backends/cuda/libs/nvrtc.pyx", line 67, in cupy_backends.cuda.libs.nvrtc.check_status
E               raise NVRTCError(status)
E           cupy_backends.cuda.libs.nvrtc.NVRTCError: HIPRTC_ERROR_COMPILATION (6)
E           
E           During handling of the above exception, another exception occurred:
E           
E           Traceback (most recent call last):
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/testing/_helper.py", line 47, in _call_func
E               result = impl(*args, **kw)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py", line 964, in test_small_generate_input_for_mikota_pair
E               eigvals, eigvecs = sp.linalg.lobpcg(A,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_lobpcg.py", line 298, in lobpcg
E               A_dense = A(cupy.eye(n, dtype=A.dtype))
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 170, in __call__
E               return self*x
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 173, in __mul__
E               return self.dot(x)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 186, in dot
E               return self.matmat(x)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 142, in matmat
E               Y = self._matmat(X)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_interface.py", line 489, in _matmat
E               return self.A.dot(X)
E             File "cupy/_core/core.pyx", line 1618, in cupy._core.core.ndarray.dot
E               return _linalg.dot(self, b, out)
E             File "cupy/_core/_routines_linalg.pyx", line 427, in cupy._core._routines_linalg.dot
E               return tensordot_core(a, b, out, n, m, k, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 501, in cupy._core._routines_linalg.tensordot_core
E               return _integral_tensordot_core(b, a, out, m, n, k, dtype, ret_shape)
E             File "cupy/_core/_routines_linalg.pyx", line 327, in cupy._core._routines_linalg._integral_tensordot_core
E               kern = _tensordot_core_int_kernel(config, dtype)
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/_routines_linalg.pyx", line 302, in cupy._core._routines_linalg._tensordot_core_int_kernel
E               ker = mod.get_function(
E             File "cupy/_core/raw.pyx", line 470, in cupy._core.raw.RawModule.get_function
E               mangled_name = self.module.mapping.get(name)
E             File "cupy/_core/raw.pyx", line 394, in cupy._core.raw.RawModule.module.__get__
E               return self._module()
E             File "cupy/_core/raw.pyx", line 402, in cupy._core.raw.RawModule._module
E               mod = _get_raw_module(
E             File "cupy/_util.pyx", line 67, in cupy._util.memoize.decorator.ret
E               result = f(*args, **kwargs)
E             File "cupy/_core/raw.pyx", line 547, in cupy._core.raw._get_raw_module
E               mod = cupy._core.core.compile_with_cache(
E             File "cupy/_core/core.pyx", line 2026, in cupy._core.core.compile_with_cache
E               cpdef function.Module compile_with_cache(
E             File "cupy/_core/core.pyx", line 2089, in cupy._core.core.compile_with_cache
E               return cuda.compiler._compile_module_with_cache(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 467, in _compile_module_with_cache
E               return _compile_with_cache_hip(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 867, in _compile_with_cache_hip
E               binary, mapping = compile_using_nvrtc(
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 300, in compile_using_nvrtc
E               return _compile(source, options, cu_path,
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 284, in _compile
E               compiled_obj, mapping = prog.compile(options, log_stream)
E             File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupy/cuda/compiler.py", line 681, in compile
E               raise CompileException(log, self.src, self.name, options,
E           cupy.cuda.compiler.CompileException: /tmp/comgr-f4e70c/input/CompileSource:203:27: error: redeclaration of '__hiprtc_24' with a different type: 'void (*const)(int, int, int, const signed char *, const signed char *, signed char *)' vs 'void (*const)(int, int, int, const bool *, const bool *, bool *)'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<signed char>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:204:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<unsigned char>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:205:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<short>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:206:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<unsigned short>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:207:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<int>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:208:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<unsigned int>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:209:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<long>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:210:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<unsigned long>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:211:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<long long>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:212:27: error: redefinition of '__hiprtc_24'
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<unsigned long long>;
E                                     ^
E           /tmp/comgr-f4e70c/input/CompileSource:202:27: note: previous definition is here
E           extern "C" constexpr auto __hiprtc_24 = _tensordot_core_int_kernel<bool>;
E                                     ^
E           10 errors generated when compiling for gfx908.
E           Error: Failed to compile opencl source (from CL or HIP source to LLVM IR).

cupy/cuda/compiler.py:681: AssertionError
__________________________ TestLOBPCG.test_maxit_None __________________________

self = <cupyx_tests.scipy_tests.sparse_tests.test_linalg.TestLOBPCG object at 0x7f33d80a5880>

    def test_maxit_None(self):
        """Check lobpcg if maxit=None runs 20 iterations (the default)
        by checking the size of the iteration history output, which should
        be the number of iterations plus 2 (initial and final values).
        """
        n = 50
        m = 4
        vals = -cupy.arange(1, n + 1)
        A = sparse.diags([vals], [0], (n, n))
        A = A.astype(cupy.float32)
        X = testing.shaped_random((n, m), xp=cupy, seed=1566950023)
        _, _, l_h = sparse.linalg.lobpcg(A, X, tol=1e-8, maxiter=None,
                                         retLambdaHistory=True)
>       assert len(l_h) == 22
E       assert 20 == 22
E        +  where 20 = len([array([-18.735699, -23.57251 , -27.328299, -33.428257], dtype=float32), array([ -7.7822046, -10.007652 , -13.157776 ,..., -4.689918 , -5.93529  ], dtype=float32), array([-1.1894418, -3.1553519, -3.572582 , -4.400922 ], dtype=float32), ...])

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1186: AssertionError
____________________ TestCustomStruct.test_builtin_vectors _____________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_builtin_vectors>

    def test_builtin_vectors(self):
>       output = example_test.run_example('custom_struct/builtin_vectors.py')

tests/example_tests/test_custom_struct.py:10: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f33d70b7760>
stdout = b'Traceback (most recent call last):\n  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/te...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py", line 48, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/builtin_vectors.py", line 40, in main
    kernel((1,), (N,), args)
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

_____________________ TestCustomStruct.test_complex_struct _____________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_complex_struct>

    def test_complex_struct(self):
>       output = example_test.run_example('custom_struct/complex_struct.py')

tests/example_tests/test_custom_struct.py:25: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f364735c160>
stdout = b'Overall structure itemsize: 80 bytes\nStructure members itemsize: [16  1 16  2 24]\nStructure members offsets: [ 0 1...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Overall structure itemsize: 80 bytes
Structure members itemsize: [16  1 16  2 24]
Structure members offsets: [ 0 16 24 40 48]
Complex structure value:
  [((0, 1, 2, 3), (4,), (5., 6.), (7,), (8, 9, 10))]
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py", line 132, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/complex_struct.py", line 122, in main
    kernel((1,), (N,), (s, out))
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

_____________________ TestCustomStruct.test_packed_matrix ______________________

self = <example_tests.test_custom_struct.TestCustomStruct testMethod=test_packed_matrix>

    def test_packed_matrix(self):
>       output = example_test.run_example('custom_struct/packed_matrix.py')

tests/example_tests/test_custom_struct.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/example_tests/example_test.py:12: in run_example
    return subprocess.check_output(
/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:411: in check_output
    return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

input = None, capture_output = False, timeout = None, check = True
popenargs = (('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py'),)
kwargs = {'stderr': -2, 'stdout': -1}
process = <subprocess.Popen object at 0x7f33d7e25910>
stdout = b'Traceback (most recent call last):\n  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/te...e. Here we allow only arrays of size one so that users do not\nTypeError: Unsupported type <class \'numpy.ndarray\'>\n'
stderr = None, retcode = 1

    def run(*popenargs,
            input=None, capture_output=False, timeout=None, check=False, **kwargs):
        """Run command with arguments and return a CompletedProcess instance.
    
        The returned instance will have attributes args, returncode, stdout and
        stderr. By default, stdout and stderr are not captured, and those attributes
        will be None. Pass stdout=PIPE and/or stderr=PIPE in order to capture them.
    
        If check is True and the exit code was non-zero, it raises a
        CalledProcessError. The CalledProcessError object will have the return code
        in the returncode attribute, and output & stderr attributes if those streams
        were captured.
    
        If timeout is given, and the process takes too long, a TimeoutExpired
        exception will be raised.
    
        There is an optional argument "input", allowing you to
        pass bytes or a string to the subprocess's stdin.  If you use this argument
        you may not also use the Popen constructor's "stdin" argument, as
        it will be used internally.
    
        By default, all communication is in bytes, and therefore any "input" should
        be bytes, and the stdout and stderr will be bytes. If in text mode, any
        "input" should be a string, and stdout and stderr will be strings decoded
        according to locale encoding, or by "encoding" if set. Text mode is
        triggered by setting any of text, encoding, errors or universal_newlines.
    
        The other arguments are the same as for the Popen constructor.
        """
        if input is not None:
            if kwargs.get('stdin') is not None:
                raise ValueError('stdin and input arguments may not both be used.')
            kwargs['stdin'] = PIPE
    
        if capture_output:
            if kwargs.get('stdout') is not None or kwargs.get('stderr') is not None:
                raise ValueError('stdout and stderr arguments may not be used '
                                 'with capture_output.')
            kwargs['stdout'] = PIPE
            kwargs['stderr'] = PIPE
    
        with Popen(*popenargs, **kwargs) as process:
            try:
                stdout, stderr = process.communicate(input, timeout=timeout)
            except TimeoutExpired as exc:
                process.kill()
                if _mswindows:
                    # Windows accumulates the output in a single blocking
                    # read() call run on child threads, with the timeout
                    # being done in a join() on those threads.  communicate()
                    # _after_ kill() is required to collect that and add it
                    # to the exception.
                    exc.stdout, exc.stderr = process.communicate()
                else:
                    # POSIX _communicate already populated the output so
                    # far into the TimeoutExpired exception.
                    process.wait()
                raise
            except:  # Including KeyboardInterrupt, communicate handled that.
                process.kill()
                # We don't call process.wait() as .__exit__ does that for us.
                raise
            retcode = process.poll()
            if check and retcode:
>               raise CalledProcessError(retcode, process.args,
                                         output=stdout, stderr=stderr)
E               subprocess.CalledProcessError: Command '('/home/kmaeh/.pyenv/versions/rocm-ci/bin/python', '/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py')' returned non-zero exit status 1.

/home/kmaeh/.pyenv/versions/3.8.7/lib/python3.8/subprocess.py:512: CalledProcessError
----------------------------- Captured stdout call -----------------------------
Original error message:
Traceback (most recent call last):
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py", line 91, in <module>
    sys.exit(main())
  File "/home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/example_tests/../../examples/custom_struct/packed_matrix.py", line 81, in main
    kernel((1,), (N,), args)
  File "cupy/_core/raw.pyx", line 89, in cupy._core.raw.RawKernel.__call__
    self.kernel(
  File "cupy/cuda/function.pyx", line 201, in cupy.cuda.function.Function.__call__
    format(grid0, grid1, grid2, max_grid_size))
  File "cupy/cuda/function.pyx", line 155, in cupy.cuda.function._launch
    if itemsize == 8:
  File "cupy/cuda/function.pyx", line 123, in cupy.cuda.function._pointer
    # value. Here we allow only arrays of size one so that users do not
TypeError: Unsupported type <class 'numpy.ndarray'>

=============================== warnings summary ===============================
tests/cupy_tests/core_tests/fusion_tests/test_array.py: 1 warning
tests/cupy_tests/math_tests/test_sumprod.py: 19 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: overflow encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/core_tests/fusion_tests/test_routines.py::TestFusionNumericalReduction_param_1_{func='prod'}::test_reduction
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: overflow encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_0_{type_l='poly1d', type_r='ndarray'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_3_{type_l='ndarray', type_r='ndarray'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_array
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in multiply
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in half_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in byte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in short_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ubyte_scalars
    y = y * x + p[i]

tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_1_{type_l='poly1d', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyval::test_polyval[_param_4_{type_l='ndarray', type_r='numpy_scalar'}]
tests/cupy_tests/lib_tests/test_polynomial.py::TestPolyvalDtypesCombination::test_polyval_diff_types_array_scalar
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/polynomial.py:734: RuntimeWarning: overflow encountered in ushort_scalars
    y = y * x + p[i]

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in power
    absx **= ord

tests/cupy_tests/linalg_tests/test_norms.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/linalg/linalg.py:2568: RuntimeWarning: divide by zero encountered in reciprocal
    absx **= ord

tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf
tests/cupy_tests/math_tests/test_misc.py::TestMisc::test_nan_to_num_inf_nan
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/numeric.py:2276: RuntimeWarning: overflow encountered in absolute
    return less_equal(abs(x-y), atol + rtol * abs(y))

tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_all_transposed2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axis_transposed2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes2
tests/cupy_tests/math_tests/test_sumprod.py::TestSumprod::test_sum_axes4
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_2_{op='variance'}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py::TestStats::test_only_input[_param_3_{op='standard_deviation'}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:47: RuntimeWarning: overflow encountered in reduce
    return umr_sum(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/math_tests/test_sumprod.py: 15 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:51: RuntimeWarning: invalid value encountered in reduce
    return umr_prod(a, axis, dtype, out, keepdims, initial, where)

tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_all[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_11_{axis=0, func='nanprod', keepdims=True, shape=(20, 30, 40), transpose_axes=False}]
tests/cupy_tests/math_tests/test_sumprod.py::TestNansumNanprodLong::test_nansum_axis_transposed[_param_15_{axis=0, func='nanprod', keepdims=False, shape=(20, 30, 40), transpose_axes=False}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:87: RuntimeWarning: invalid value encountered in reduce
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

tests/cupy_tests/math_tests/test_sumprod.py: 32 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/math_tests/test_sumprod.py:803: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/statistics_tests/test_meanvar.py: 32 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupy_tests/statistics_tests/test_meanvar.py:113: RuntimeWarning: invalid value encountered in true_divide
    a = a / a

tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_4_{axis=0, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_5_{axis=0, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_6_{axis=0, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_7_{axis=0, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_8_{axis=1, keepdims=True, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_9_{axis=1, keepdims=True, overwrite_input=False, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_10_{axis=1, keepdims=False, overwrite_input=True, shape=(3, 4, 5)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestNanMedian::test_nanmedian[_param_11_{axis=1, keepdims=False, overwrite_input=False, shape=(3, 4, 5)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/lib/nanfunctions.py:1113: RuntimeWarning: All-NaN slice encountered
    r, k = function_base._ureduce(a, func=_nanmedian, axis=axis, out=out,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_3_{func='mean', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_5_{func='mean', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3372: RuntimeWarning: Mean of empty slice.
    return _methods._mean(a, axis=axis, dtype=dtype,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:170: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_1_{func='mean', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_2_{func='mean', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_4_{func='mean', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:168: RuntimeWarning: invalid value encountered in true_divide
    ret = arr.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_9_{func='std', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_11_{func='std', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:233: RuntimeWarning: Degrees of freedom <= 0 for slice
    ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:194: RuntimeWarning: invalid value encountered in true_divide
    arrmean = um.true_divide(

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in double_scalars
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_7_{func='std', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_8_{func='std', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_10_{func='std', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/_methods.py:226: RuntimeWarning: invalid value encountered in true_divide
    ret = ret.dtype.type(ret / rcount)

tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_13_{func='var', params=((0,), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_14_{func='var', params=((0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_15_{func='var', params=((0, 0), 1)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_16_{func='var', params=((0, 0, 0), None)}]
tests/cupy_tests/statistics_tests/test_meanvar.py::TestProductZeroLength::test_external_mean_zero_len[_param_17_{func='var', params=((0, 0, 0), (0, 2))}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3621: RuntimeWarning: Degrees of freedom <= 0 for slice
    return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/cupyx_tests/jit_tests/test_raw.py: 21 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/jit/_builtin_funcs.py:334: RuntimeWarning: mask 4294967295 is ignored on HIP
    warnings.warn(f'mask {mask} is ignored on HIP', RuntimeWarning)

tests/cupyx_tests/jit_tests/test_raw.py::TestRaw::test_syncwarp_mask
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/jit/_builtin_funcs.py:131: RuntimeWarning: mask <Data code = "m", type = int> is ignored on HIP
    warnings.warn(f'mask {mask} is ignored on HIP', RuntimeWarning)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_217_{cval=nan, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_220_{cval=nan, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_223_{cval=nan, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_226_{cval=inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_229_{cval=inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_232_{cval=inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_235_{cval=-inf, mode='constant', order=0, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_238_{cval=-inf, mode='constant', order=1, output=float64, prefilter=True, shift=0.1}]
tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestShift::test_shift_int[_param_241_{cval=-inf, mode='constant', order=3, output=float64, prefilter=True, shift=0.1}]
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py:670: RuntimeWarning: invalid value encountered in remainder
    float_out = self._shift(xp, scp, a.astype(xp.float64)) % 1

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py: 14 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:684: RuntimeWarning: invalid value encountered in true_divide
    return sum / numpy.asanyarray(count).astype(numpy.float64)

tests/cupyx_tests/scipy_tests/ndimage_tests/test_measurements.py: 28 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/ndimage/measurements.py:736: RuntimeWarning: invalid value encountered in true_divide
    return sum_c_sq / np.asanyarray(count).astype(float)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_0_{im=(10,), mysize=3, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_1_{im=(10,), mysize=3, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_2_{im=(10,), mysize=4, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_3_{im=(10,), mysize=4, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: divide by zero encountered in true_divide
    res *= (1 - noise / lVar)

tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_0_{im=(10,), mysize=3, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_1_{im=(10,), mysize=3, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_2_{im=(10,), mysize=4, noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_3_{im=(10,), mysize=4, noise=True}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_4_{im=(10,), mysize=(3, 4, 5), noise=False}]
tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestWiener::test_wiener[_param_5_{im=(10,), mysize=(3, 4, 5), noise=True}]
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/signal/signaltools.py:1598: RuntimeWarning: invalid value encountered in multiply
    res *= (1 - noise / lVar)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 32 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/base.py:595: RuntimeWarning: invalid value encountered in true_divide
    return np.true_divide(self.todense(), other)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 28 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/base.py:595: RuntimeWarning: divide by zero encountered in true_divide
    return np.true_divide(self.todense(), other)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 96 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py:1888: SparseEfficiencyWarning: Taking maximum (minimum) with > 0 (< 0) number results to a dense matrix.
    return getattr(a, self.opt)(0.5)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 96 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py:1893: SparseEfficiencyWarning: Taking maximum (minimum) with > 0 (< 0) number results to a dense matrix.
    return getattr(a, self.opt)(-0.5)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in less
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in greater
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in less_equal
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/compressed.py:211: RuntimeWarning: invalid value encountered in greater_equal
    res = self._with_data(op(self.data, other), copy=True)

tests/cupyx_tests/scipy_tests/sparse_tests/test_csr.py: 6 warnings
tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 368 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:125: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:116: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray_sparse(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 16 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:116: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray_sparse(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 368 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:125: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_arrayXarray(i, j, x)

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 12 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:82: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
    self._set_intXint(row, col, x.flat[0])

tests/cupyx_tests/scipy_tests/sparse_tests/test_index.py: 12 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/_index.py:82: SparseEfficiencyWarning: Changing the sparsity structure of a csc_matrix is expensive. lil_matrix is more efficient.
    self._set_intXint(row, col, x.flat[0])

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 48 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:553: SparseEfficiencyWarning: CSR matrix format is required. Converting to CSR matrix.
    warn('CSR matrix format is required. Converting to CSR matrix.',

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/cupyx/scipy/sparse/linalg/_solve.py:437: SparseEfficiencyWarning: CSR or CSC format is required. Converting to CSR format.
    warnings.warn('CSR or CSC format is required. Converting to CSR '

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:318: SparseEfficiencyWarning: splu requires CSC matrix format
    warn('splu requires CSC matrix format', SparseEfficiencyWarning)

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 24 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/dsolve/linsolve.py:407: SparseEfficiencyWarning: splu requires CSC matrix format
    warn('splu requires CSC matrix format', SparseEfficiencyWarning)

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 80 warnings
  /home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py:1572: RuntimeWarning: divide by zero encountered in true_divide
    M = xp.diag(1.0 / xp.diag(a))

tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py: 80 warnings
  /home/kmaeh/.pyenv/versions/rocm-ci/lib/python3.8/site-packages/scipy/sparse/linalg/isolve/minres.py:190: RuntimeWarning: invalid value encountered in multiply
    v = s*y

-- Docs: https://docs.pytest.org/en/stable/warnings.html
- generated html file: file:///home/kmaeh/Development/cupy-rocm-ci-report/tools/tmp.eWTJXdevl7/cupy/_output/report.html -
=========================== short test summary info ============================
FAILED tests/cupy_tests/core_tests/test_ndarray.py::TestNdarrayCopy::test_copy_multi_device_with_stream
FAILED tests/cupy_tests/core_tests/test_ndarray_copy_and_view.py::TestArrayCopyAndView::test_astype_boolean_view
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_add_array_boolarray
FAILED tests/cupy_tests/core_tests/test_ndarray_elementwise_op.py::TestArrayElementwiseOp::test_iadd_array_boolarray
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_0_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_1_{shape=((2, 3, 4), (3, 4, 2)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_2_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_3_{shape=((2, 3, 4), (3, 4, 2)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_8_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_9_{shape=((1, 1), (1, 2)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_10_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_11_{shape=((1, 1), (1, 2)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_16_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_17_{shape=((2, 1), (1, 1)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_18_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_19_{shape=((2, 1), (1, 1)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_20_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_21_{shape=((1, 2), (2, 3)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_22_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_23_{shape=((1, 2), (2, 3)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_24_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_25_{shape=((2, 1), (1, 3)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_26_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_27_{shape=((2, 1), (1, 3)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_28_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_29_{shape=((2, 3), (3, 1)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_30_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_31_{shape=((2, 3), (3, 1)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_32_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_33_{shape=((2, 3), (3, 4)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_34_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_35_{shape=((2, 3), (3, 4)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_64_{shape=((2,), (2, 4)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_65_{shape=((2,), (2, 4)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_66_{shape=((2,), (2, 4)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_67_{shape=((2,), (2, 4)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_68_{shape=((4, 2), (2,)), trans_a=True, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_69_{shape=((4, 2), (2,)), trans_a=True, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_70_{shape=((4, 2), (2,)), trans_a=False, trans_b=True}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestDot_param_71_{shape=((4, 2), (2,)), trans_a=False, trans_b=False}::test_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_dot_with_single_elem_array1
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_dot_with_single_elem_array2
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_kron
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_multidim_inner
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_multidim_kron
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_multidim_outer
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_outer
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_reversed_kron
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_reversed_outer
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_tensordot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_tensordot_with_int_axes
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_tensordot_with_list_axes
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_dot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_dot_with_out
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_higher_order_inner
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_tensordot
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_tensordot_with_int_axes
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestProduct::test_transposed_tensordot_with_list_axes
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestMatrixPower::test_matrix_power_2
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestMatrixPower::test_matrix_power_3
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestMatrixPower::test_matrix_power_large
FAILED tests/cupy_tests/linalg_tests/test_product.py::TestMatrixPower::test_matrix_power_of_two
FAILED tests/cupy_tests/linalg_tests/test_solve.py::TestLstsq::test_lstsq_solutions
FAILED tests/cupy_tests/manipulation_tests/test_basic.py::TestBasic::test_copyto_where_multigpu_raises_6
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))}::test_cupy_matmul
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_0_{shape_pair=((3, 2), (2, 4))}::test_operator_matmul
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_4_{shape_pair=((2,), (2, 4))}::test_cupy_matmul
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_4_{shape_pair=((2,), (2, 4))}::test_operator_matmul
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_6_{shape_pair=((3, 2), (2,))}::test_cupy_matmul
FAILED tests/cupy_tests/math_tests/test_matmul.py::TestMatmul_param_6_{shape_pair=((3, 2), (2,))}::test_operator_matmul
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_0_{mode='valid'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_1_{mode='same'}::test_convolve_diff_types
FAILED tests/cupy_tests/math_tests/test_misc.py::TestConvolve_param_2_{mode='full'}::test_convolve_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_0_{mode='valid'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_1_{mode='full'}::test_correlate_diff_types
FAILED tests/cupy_tests/statistics_tests/test_correlation.py::TestCorrelate_param_2_{mode='same'}::test_correlate_diff_types
FAILED tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py::TestHfft2::test_ihfft2[_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(2, 5, 20)}]
FAILED tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py::TestHfftn::test_ihfftn[_param_24_{axes=(0, 1, 2), norm=None, s=None, shape=(3, 5, 20)}]
FAILED tests/cupyx_tests/scipy_tests/fft_tests/test_fft.py::TestHfftn::test_ihfftn[_param_25_{axes=(0, 1, 2), norm='backward', s=None, shape=(3, 5, 20)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_46_{mode='grid-constant', order=4}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestMapCoordinatesHalfInteger::test_map_coordinates_float[_param_47_{mode='grid-constant', order=5}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_4_{grid_mode=False, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_5_{grid_mode=False, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_16_{grid_mode=False, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_17_{grid_mode=False, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_22_{grid_mode=False, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_23_{grid_mode=False, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_46_{grid_mode=False, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_47_{grid_mode=False, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_52_{grid_mode=True, mode='constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_53_{grid_mode=True, mode='constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_64_{grid_mode=True, mode='mirror', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_65_{grid_mode=True, mode='mirror', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_70_{grid_mode=True, mode='wrap', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_71_{grid_mode=True, mode='wrap', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_94_{grid_mode=True, mode='grid-constant', order=4, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/ndimage_tests/test_interpolation.py::TestZoomOutputSize1::test_zoom_output_size1[_param_95_{grid_mode=True, mode='grid-constant', order=5, shape=(5, 5, 2), zoom=(2, 2, 0.5)}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_fftconvolve[_param_12_{mode='full', size1=(3, 4, 10), size2=3}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_fftconvolve[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_convolve_fft[_param_12_{mode='full', size1=(3, 4, 10), size2=3}]
FAILED tests/cupyx_tests/scipy_tests/signal_tests/test_signaltools.py::TestFFTConvolve::test_convolve_fft[_param_44_{mode='valid', size1=(3, 4, 10), size2=3}]
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLOBPCG::test_small_generate_input_for_mikota_pair
FAILED tests/cupyx_tests/scipy_tests/sparse_tests/test_linalg.py::TestLOBPCG::test_maxit_None
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_builtin_vectors
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_complex_struct
FAILED tests/example_tests/test_custom_struct.py::TestCustomStruct::test_packed_matrix
= 106 failed, 84076 passed, 8596 skipped, 661 deselected, 4520 xfailed, 1692 warnings in 28846.43s (8:00:46) =
